/*! For license information please see index.js.LICENSE.txt */
(()=>{var t,e,i={155:(t,e,i)=>{"use strict";i.d(e,{r:()=>n});class n{constructor(t,e){this.__global=!0,this.timestamp=Date.now(),this.name=t.name,this.category=t.category||"[Identity]",this.type=`${this.category} ${t.name}`,Object.assign(this,e)}}},85:(t,e,i)=>{"use strict";i.d(e,{U:()=>k});var n=i(635),r=function(){return r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},r.apply(this,arguments)},o={channelId:"default",host:window,coordinatorHost:window.top},s={connect:"connect",connected:"connected"},a="@wikia/post-quecast";function c(t){return t.channelId&&t.libId===a&&t.action&&function(t){return"string"==typeof t.type&&"number"==typeof t.timestamp}(t.action)}function l(t){return!t.data.private}function u(t,e){return t.data.channelId===e}function d(t){return t.data.action}var h=function(){function t(){}return t.make=function(t){return function(t){var e;return t.host===t.coordinatorHost&&!!(null===(e=t.coordinatorHost[a])||void 0===e?void 0:e.callbackConnector)}(t)?t.coordinatorHost[a].callbackConnector:new p({senderHost:t.coordinatorHost,listenerHost:t.host})},t}(),g=function(){function t(t){this.coordinatorHost=t,this.callbacks=[]}return t.prototype.dispatch=function(t){var e=this;if(!c(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.callbacks.forEach((function(i){return i({data:t,source:e.coordinatorHost})}))},t.prototype.addListener=function(t){this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),p=function(){function t(t){this.options=t,this.map=new Map}return t.prototype.dispatch=function(t){if(!c(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.options.senderHost.postMessage(t,"*")},t.prototype.addListener=function(t){var e=function(e){var i;(i=e)&&i.source&&i.data&&c(i.data)&&t(e)};this.map.set(t,e),this.options.listenerHost.addEventListener("message",e)},t.prototype.removeListener=function(t){var e=this.map.get(t);this.options.listenerHost.removeEventListener("message",e),this.map.delete(t)},t}(),f=function(){function t(t){this.callbacks=[],this.history=[],this.channelId=t.channelId,this.connector=h.make(t),this.setupActions(),this.setupConnection()}return t.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},t.prototype.getHistory=function(){var t=this,e=function(i){if(u(i,t.channelId)&&function(t){return!!t.data.private}(i)){var n=d(i);(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.some((function(e){return t.type===e}))})(n,s.connected)&&(t.connector.removeListener(e),t.handleActions.apply(t,n.history))}};this.connector.addListener(e)},t.prototype.listenEvent=function(){var t=this;this.connector.addListener((function(e){if(u(e,t.channelId)&&l(e)){var i=d(e);t.handleActions(i)}}))},t.prototype.handleActions=function(){for(var t,e=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];(t=this.history).push.apply(t,i),i.forEach((function(t){return e.callbacks.forEach((function(e){return e(t)}))}))},t.prototype.setupConnection=function(){this.connector.dispatch({action:{type:s.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:a})},t.prototype.addListener=function(t){this.history.forEach((function(e){return t(e)})),this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),v=function(){function t(t){void 0===t&&(t={});var e=r(r({},o),t);this.channelId=e.channelId,this.connector=h.make(e)}return t.prototype.dispatch=function(t){this.connector.dispatch({action:r(r({},t),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:a})},t}(),m=function(){function t(t){void 0===t&&(t={});var e=r(r({},o),t);this.transmitter=new v(e),this.receiver=new f(e)}return t.prototype.dispatch=function(t){this.transmitter.dispatch(t)},t.prototype.addListener=function(t){this.receiver.addListener(t)},t.prototype.removeListener=function(t){this.receiver.removeListener(t)},t}(),y=function(){function t(t,e){this.channelId=t,this.connectors=new Map,this.history=[],this.connectors.set(e,e[a].callbackConnector)}return t.prototype.addConnection=function(t){this.ensureConnector(t).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:a})},t.prototype.createConnectedAction=function(){return{type:s.connected,history:this.history,timestamp:Date.now()}},t.prototype.broadcast=function(t){var e=this;this.history.push(t),this.connectors.forEach((function(i){i.dispatch({action:t,channelId:e.channelId,libId:a})}))},t.prototype.ensureConnector=function(t){return this.connectors.has(t)||this.connectors.set(t,new p({senderHost:t,listenerHost:t})),this.connectors.get(t)},t}(),w=function(){function t(t){this.coordinatorHost=t,this.channels=new Map,this.callbackConnector=new g(t),this.postMessageConnector=new p({senderHost:t,listenerHost:t})}return t.prototype.init=function(){var t=this,e=function(e){l(e)||(t.handleConnect(e),t.handleBroadcast(e))};this.callbackConnector.addListener(e),this.postMessageConnector.addListener(e)},t.prototype.handleConnect=function(t){(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.some((function(e){return t.data.action.type===e}))})(t,s.connect)&&this.ensureChannel(t.data.channelId).addConnection(t.source)},t.prototype.handleBroadcast=function(t){(function(t){return!Object.values(s).some((function(e){return t.data.action.type===e}))})(t)&&this.ensureChannel(t.data.channelId).broadcast(t.data.action)},t.prototype.ensureChannel=function(t){return this.channels.has(t)||this.channels.set(t,new y(t,this.coordinatorHost)),this.channels.get(t)},t}();function C(t){if(void 0===t&&(t=window),!t[a]){var e=new w(t);e.init(),t[a]=e}}var b=i(223),S=i(393);let k=class{constructor(t){this.window=t,this.history=new Map;const{channelId:e,coordinatorName:i}=this.getSettings();C(),this.communicator=new m({channelId:e||"default",coordinatorHost:t[i]||top})}emit(t){this.communicator.dispatch(t)}on(t,e){this.communicator.addListener((i=>this.run(i,t,e)))}once(t,e){this.communicator.addListener((i=>this.runOnce(i,t,e)))}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}run(t,e,i){this.ofType(t,e)&&i(t)}runOnce(t,e,i){const n=e.category+" "+e.name;this.ofType(t,e)&&(this.history.has(n)||(this.history.set(n,!0),i(t)))}ofType(t,e){return t.category===e.category&&t.name===e.name||t.type===e.category+" "+e.name}};k=(0,n.Cg)([(0,b.Gr)(),(0,n.Qj)(0,(0,b.WQ)(S.jf))],k)},349:(t,e,i)=>{"use strict";i.d(e,{c:()=>n});const n={CONSENT_READY:{category:"[AdEngine OptIn]",name:"set opt in"},CONSENT_UPDATE:{category:"[AdEngine OptIn]",name:"update opt in"},FANDOM_CONTEXT_SET:{category:"[IdentityEngine]",name:"Fandom context set"},IDENTITY_READY:{category:"[IdentityEngine]",name:"Identity ready"},SEND_ONETRUST_EVENTS:{category:"[IdentityEngine]",name:"Send OneTrust events"},IDENTITY_PARTNER_DATA_OBTAINED:{category:"[AdEngine]",name:"Identity partner data obtained"},AGE_GATE_DATA:{name:"Age gate result",category:"[Identity]"},PAGE_CHANGED:{name:"Page changed",category:"[Platform]"},UPDATE_CONSENT_COOKIE:{category:"[AdEngine]",name:"Update consent cookie"},AUDIGENT_SEGMENT_LIBRARY_LOADED:{name:"Audigent segment library loaded"},AUDIGENT_MATCHES_LIBRARY_LOADED:{name:"Audigent matches library loaded"},AUDIGENT_SEGMENTS_READY:{name:"Audigent segments ready"},EYEOTA_STARTED:{name:"Eyeota started"},EYEOTA_FAILED:{name:"Eyeota loading failed"},LIVE_CONNECT_STARTED:{name:"LiveConnect started"},LIVE_CONNECT_CACHED:{name:"LiveConnect data cached"},LIVE_CONNECT_RESPONDED_UUID:{name:"LiveConnect responded with UUID"}}},841:(t,e,i)=>{"use strict";i.d(e,{X:()=>k});var n=i(635),r=i(223),o=i(144),s=i(858),a=i(439),c=i(710),l=i(610);let u=class{constructor(t,e,i){this.adsContext=t,this.platform=e,this.device=i,this.skinMap={muthead:"turf",futhead:"turf",giantbomb:"giantbomb",gamefaqs:"gamefaqs",gamespot:"gamespot",metacritic:"metacritic","metacritic-neutron":"metacritic_neutron",comicvine:"comicvine",f2:"fandom",tvguide:"tvguide",fandomdesktop:"ucp",fandommobile:"ucp",fanatical:"fanatical"}}get(){var t,e;const i=this.platform.get(),n="desktop"===this.device.getDeviceType()?"desktop":"mobile";return(null===(t=this.adsContext.get())||void 0===t?void 0:t.skin)?`${null!==(e=this.adsContext.get().skin)&&void 0!==e?e:i}_${n}`:this.skinMap[i]?this.skinMap[i]+"_"+n:"unknown"}};u=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.WQ)(l.i)),(0,n.Qj)(1,(0,r.WQ)(a.O)),(0,n.Qj)(2,(0,r.WQ)(c.p))],u);var d=i(167),h=i(695),g=i(546);let p=class{constructor(){this.operatingSystem=null}getOperatingSystem(){if(null!==this.operatingSystem)return this.operatingSystem;const{userAgent:t}=window.navigator;return this.operatingSystem="unknown",-1!==t.indexOf("Win")&&(this.operatingSystem="Windows"),-1!==t.indexOf("Mac")&&(this.operatingSystem="OSX"),-1!==t.indexOf("Linux")&&(this.operatingSystem="Linux"),-1!==t.indexOf("Android")&&(this.operatingSystem="Android"),-1!==t.indexOf("like Mac")&&(this.operatingSystem="iOS"),this.operatingSystem}};p=(0,n.Cg)([(0,r.Gr)()],p);var f=i(712),v=i(393);let m=class{constructor(t,e,i,n,r,o,s,a,c){this.logger=t,this.httpClient=e,this.skin=i,this.optInService=n,this.window=r,this.wikiConfig=o,this.geo=s,this.browser=a,this.operatingSystem=c;const l=new Date;this.startTime=this.getTimeOrigin(),this.tzOffset=l.getTimezoneOffset()}getTimeOrigin(){var t;return null===(t=window.performance)||void 0===t?void 0:t.timeOrigin}getCurrentTimestamp(){return Date.now()}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}getTrackingParams(){var t,e,i,n,r,o,s,a,c,l,u,d,h;return{browser:`${this.operatingSystem.getOperatingSystem()} ${this.browser.getBrowser()}`,browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.sessionId,pv_number:null===(n=null===(i=this.window.fandomContext)||void 0===i?void 0:i.tracking)||void 0===n?void 0:n.pvNumber,pv_number_global:null===(o=null===(r=this.window.fandomContext)||void 0===r?void 0:r.tracking)||void 0===o?void 0:o.pvNumberGlobal,pv_unique_id:null===(a=null===(s=this.window.fandomContext)||void 0===s?void 0:s.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(l=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===l?void 0:l.beaconId,ua:null===(u=this.window.navigator)||void 0===u?void 0:u.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),u:this.optInService.trackingAllowed?this.wikiConfig.get("wgUserId")||0:-1,a:(null===(h=null===(d=this.window.fandomContext)||void 0===d?void 0:d.page)||void 0===h?void 0:h.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(t,e){if(!e)throw this.logger.error("Error building DWH tracking URL"),new Error("Error while building DWH tracking URL - no baseUrl provided");const i=new URLSearchParams(t);return i.sort(),`${e}?${i.toString()}`}sendEvent(t,e){var i;const n=this.buildDataWarehouseUrl(t,e);n&&(null===(i=this.httpClient.get(n,{mode:"cors"},5e3))||void 0===i||i.catch((t=>{this.logger.error("Failed to send data",t)})))}};m=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.MR)(o.V,o.O,"DataWarehouseSender")),(0,n.Qj)(1,(0,r.WQ)(s.Q)),(0,n.Qj)(2,(0,r.WQ)(u)),(0,n.Qj)(3,(0,r.WQ)(f.E)),(0,n.Qj)(4,(0,r.WQ)(v.jf)),(0,n.Qj)(5,(0,r.WQ)(d.j)),(0,n.Qj)(6,(0,r.WQ)(h.u)),(0,n.Qj)(7,(0,r.WQ)(g.P)),(0,n.Qj)(8,(0,r.WQ)(p))],m);let y=class{constructor(t){this.sender=t}send(t){const e=Object.assign(Object.assign(Object.assign({},t),this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(e,"https://beacon.wikia-services.com/__track/special/identityinfo")}};y=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(m))],y);var w=i(489);let C=class{constructor(t){this.sender=t}send(t){const e=Object.assign(Object.assign({event_name:t,load_time:this.sender.getCurrentTimestamp()-this.sender.getStartTime()},this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(e,"https://beacon.wikia-services.com/__track/special/adengloadtimes")}};C=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(m))],C);let b=class{constructor(t){this.sender=t}send(t){const e=Object.assign(Object.assign({event_name:"chrome_label",label:t},this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(e,"https://beacon.wikia-services.com/__track/special/chromelabels")}};b=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(m))],b);let S=class{constructor(t,e,i,n){this.window=t,this.geo=e,this.wikiConfig=i,this.sender=n}send(t){const e=Object.assign(Object.assign({},t),this.getTrackingParams());this.sender.sendEvent(e,"https://beacon.wikia-services.com/__track/special/gdpr_events")}getTrackingParams(){var t,e,i,n;return{lang_code:this.getLanguageCode()||"unknown",detected_geo:(this.geo.getCountryCode()||"").toUpperCase(),detected_region:(this.geo.getRegionCode()||"").toUpperCase(),beacon:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.beaconId,pv_unique_id:null===(n=null===(i=this.window.fandomContext)||void 0===i?void 0:i.tracking)||void 0===n?void 0:n.pvUID}}getLanguageCode(){var t,e,i;return this.wikiConfig.get("wgUserLanguage")||(null===(i=null===(e=null===(t=this.window)||void 0===t?void 0:t.navigator)||void 0===e?void 0:e.language)||void 0===i?void 0:i.toLowerCase().substring(0,2))}};S=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(v.jf)),(0,n.Qj)(1,(0,r.WQ)(h.u)),(0,n.Qj)(2,(0,r.WQ)(d.j)),(0,n.Qj)(3,(0,r.WQ)(m))],S);let k=class{constructor(t,e,i,n,r){this.logger=t,this.identityEventSender=e,this.loadTimeEventSender=i,this.chromeLabelSender=n,this.consentEventSender=r}track(t,e){switch(t){case w.i.identity:this.identityEventSender.send(e);break;case w.i.loadTime:this.loadTimeEventSender.send(e);break;case w.i.chromeLabel:this.chromeLabelSender.send(e);break;case w.i.consents:this.consentEventSender.send(e);break;default:this.logger.info("Invalid event type to track")}}};k=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.MR)(o.V,o.O,"DataWarehouseService")),(0,n.Qj)(1,(0,r.WQ)(y)),(0,n.Qj)(2,(0,r.WQ)(C)),(0,n.Qj)(3,(0,r.WQ)(b)),(0,n.Qj)(4,(0,r.WQ)(S))],k)},489:(t,e,i)=>{"use strict";var n;i.d(e,{i:()=>n}),function(t){t[t.identity=0]="identity",t[t.loadTime=1]="loadTime",t[t.chromeLabel=2]="chromeLabel",t[t.consents=3]="consents"}(n||(n={}))},482:(t,e,i)=>{"use strict";var n;i.d(e,{b:()=>n}),function(t){t.COOKIEBOT="cookiebot",t.KETCH="ketch",t.ONETRUST="onetrust"}(n||(n={}))},905:(t,e,i)=>{"use strict";i.d(e,{q:()=>c});var n,r=i(635),o=i(223),s=i(144),a=i(482);let c=n=class{constructor(t){this.logger=t,this.cmpIdMap={[a.b.COOKIEBOT]:134,[a.b.ONETRUST]:28,[a.b.KETCH]:340}}addLocatorFrame(){const t="____tcfapiLocator";if(window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.body,i=document.createElement("iframe");i.name=t,i.style.display="none",e.appendChild(i)}install(t){var e;const i=void 0!==t&&null!==(e=this.cmpIdMap[t])&&void 0!==e?e:n.FANDOM_CMP_ID;function r(t){try{let e=t.data;const i="string"==typeof e;if(i)try{e=JSON.parse(e)}catch(t){}const n=e.__tcfapiCall;n&&window.__tcfapi(n.command,n.parameter,(function(e,r){const o={__tcfapiReturn:{returnValue:e,success:r,callId:n.callId}};t.source.postMessage(i?JSON.stringify(o):o,"*")}))}catch(t){}}function o(t,e,n){"addEventListener"===t||"getTCData"===t||"ping"===t?n({cmpId:i,eventStatus:"tcloaded",cmpLoaded:!0,cmpStatus:"loaded",cmpVersion:e,displayStatus:"disabled",apiVersion:"2.2",tcfPolicyVersion:5,gdprApplies:!1},!0):n(void 0,!1)}window.__tcfapi?window.__tcfapi("ping",2,(t=>{"stub"===(null==t?void 0:t.cmpStatus)&&(window.__tcfapi=o,window.__tcfapi.msgHandler=r,this.addLocatorFrame(),window.addEventListener("message",r,!1),this.logger.info("__tcfapi installed"))})):(window.__tcfapi=o,window.__tcfapi.msgHandler=r,this.addLocatorFrame(),window.addEventListener("message",r,!1),this.logger.info("__tcfapi installed"))}};c.FANDOM_CMP_ID=141,c=n=(0,r.Cg)([(0,o.Gr)(),(0,r.Qj)(0,(0,o.MR)(s.V,s.O,"TCF"))],c)},517:(t,e,i)=>{"use strict";i.d(e,{h:()=>d,u:()=>n});var n,r=i(635),o=i(349),s=i(85),a=i(223),c=i(393),l=i(874),u=i(144);!function(t){t.yes="Y",t.no="N",t.na="-"}(n||(n={}));let d=class{constructor(t,e,i,r){this.cookiesManager=t,this.window=e,this.logger=i,this.communicationService=r,this.usPrivacyCookie="usprivacy",this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.explicitNotice=n.yes,this.lspaSupport=n.no,this.addChangelistener()}isUspApiAvailable(){return void 0!==this.window.__uspapi}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener(),this.logger.info("__uspapi installed")}getPrivacyStringCookie(){return this.cookiesManager.get(this.usPrivacyCookie)}addChangelistener(){this.communicationService.on(o.c.UPDATE_CONSENT_COOKIE,(({uspValue:t})=>{this.createPrivacyCookie(t)}))}createPrivacyCookie(t=n.na){const e=this.window.location.hostname,i=l.O.extract(e),r=t===n.na?`${this.USP_API_VERSION}${n.na}${n.na}${n.na}`:`${this.USP_API_VERSION}${this.explicitNotice}${t}${this.lspaSupport}`;this.cookiesManager.set(this.usPrivacyCookie,r,{domain:i,expires:365})}consentsUpdated(t){return{gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!t.startsWith(this.CCPA_TRACKING_ALLOWED)}}uspApiMessage(t,e,i){"ping"===t?i({uspapiLoaded:!1},!0):"getUSPData"===t?i({version:this.USP_API_VERSION,uspString:this.getPrivacyStringCookie()},!0):"getQueue"===t?i(this.queue,!0):this.queue.push([t,e,i])}addLocatorFrame(){const t="__uspapi";if(this.window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.createElement("iframe");e.name=t,e.style.display="none",document.body.appendChild(e)}addUspMessageListener(){this.window.addEventListener("message",(t=>{const e=this.convertUspMessageData(t);e&&this.uspMessageHandler(e,t)}),!1)}convertUspMessageData(t){try{return("string"==typeof t.data?JSON.parse(t.data):t.data).__uspapiCall}catch(t){}}uspMessageHandler(t,e){this.window.__uspapi(t.command,t.version,((i,n)=>{const r={__uspapiReturn:{returnValue:i,success:n,callId:t.callId}};e.source.postMessage(r,"*")}))}subscribe(t){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,(e=>{(null==e?void 0:e.uspString)&&t(this.consentsUpdated(e.uspString))}))}};d=(0,r.Cg)([(0,a.Gr)(),(0,r.Qj)(0,(0,a.WQ)(c.AZ)),(0,r.Qj)(1,(0,a.WQ)(c.jf)),(0,r.Qj)(2,(0,a.MR)(u.V,u.O,"USP")),(0,r.Qj)(3,(0,a.WQ)((0,a.cb)((()=>s.U))))],d)},712:(t,e,i)=>{"use strict";i.d(e,{E:()=>m});var n=i(635),r=i(144),o=i(223),s=i(155),a=i(349),c=i(85),l=i(569),u=i(695),d=i(517),h=i(905);let g=class{constructor(t,e,i){this.logger=t,this.uspApi=e,this.tcfApi=i,this.tcfApi.install()}subscribe(t){this.logger.info("__uspapi installed"),this.uspApi.subscribe(t)}};g=(0,n.Cg)([(0,o.Gr)(),(0,n.Qj)(0,(0,o.MR)(r.V,r.O,"OptInService")),(0,n.Qj)(1,(0,o.WQ)(d.h)),(0,n.Qj)(2,(0,o.WQ)(h.q))],g);var p=i(393),f=i(482);let v=class{constructor(t,e,i){this.window=t,this.geo=e,this.logger=i}get(t){if(void 0!==t&&!this.trackingOptInPresent(t)){if(t===f.b.KETCH)return i.e(364).then(i.bind(i,688)).then((({KetchConsentStrategy:t})=>o.kL.resolve(t)));if(t===f.b.ONETRUST)return i.e(832).then(i.bind(i,675)).then((({OneTrustConsentStrategy:t})=>o.kL.resolve(t)));if(t===f.b.COOKIEBOT)return i.e(482).then(i.bind(i,341)).then((({FanaticalConsentStrategy:t})=>o.kL.resolve(t)))}const e=this.geo.getCountryCode();if(e){if("us"===e)return Promise.resolve(o.kL.resolve(g));if(l.e.includes(e))return i.e(224).then(i.bind(i,435)).then((({FandomGdprConsentStrategy:t})=>o.kL.resolve(t)))}return i.e(319).then(i.bind(i,322)).then((({StaticConsentStrategy:t})=>o.kL.resolve(t)))}trackingOptInPresent(t){const e=void 0!==this.window.trackingOptIn&&void 0!==this.window.trackingOptInInstances;return e&&this.logger.warn(`${t} should be loaded, but TrackingOptIn is present. Skipping...`),e}};v=(0,n.Cg)([(0,o.Gr)(),(0,n.Qj)(0,(0,o.WQ)(p.jf)),(0,n.Qj)(1,(0,o.WQ)(u.u)),(0,n.Qj)(2,(0,o.MR)(r.V,r.O,"OptInService"))],v);let m=class{get trackingAllowed(){return this._trackingAllowed}set trackingAllowed(t){this._trackingAllowed=t}constructor(t,e,i){this.communicationService=t,this.logger=e,this.consentProviderFactory=i,this.consentUpdated=!1,this._trackingAllowed=!1}init(t){const e=t.get("icFandom1TEnabled",!1),i=t.get("icPreferredCMP",e?f.b.ONETRUST:void 0);this.consentProviderFactory.get(i).then((t=>t.subscribe((t=>{this.logger.info("Sending consents: ",t,"update?",this.consentUpdated),this.consentUpdated&&this.sendConsentsUpdateToAdEngine(t),this.sendConsentsToAdEngine(t),this.consentUpdated||(this.consentUpdated=!0)}))))}sendConsentsToAdEngine(t){this.communicationService.emit(new s.r(a.c.CONSENT_READY,t))}sendConsentsUpdateToAdEngine(t){this.communicationService.emit(new s.r(a.c.CONSENT_UPDATE,t))}};m=(0,n.Cg)([(0,o.Gr)(),(0,n.Qj)(0,(0,o.WQ)(c.U)),(0,n.Qj)(1,(0,o.MR)(r.V,r.O,"OptInService")),(0,n.Qj)(2,(0,o.WQ)(v))],m)},393:(t,e,i)=>{"use strict";i.d(e,{AZ:()=>n,eF:()=>a,jf:()=>o,kW:()=>r,kk:()=>s});const n=Symbol("COOKIES"),r=Symbol("NAVIGATOR"),o=Symbol("WINDOW"),s=Symbol("UUID"),a=Symbol("SENTRY")},610:(t,e,i)=>{"use strict";i.d(e,{i:()=>s});var n=i(635),r=i(223),o=i(393);let s=class{constructor(t){this.window=t}get(){var t;return null===(t=this.window.ads)||void 0===t?void 0:t.context}};s=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(o.jf))],s)},248:(t,e,i)=>{"use strict";i.d(e,{s:()=>o});var n=i(635),r=i(223);let o=class{constructor(){this.loadedAssets=[]}createScript(t,e="text/javascript",i=!0,n=null,r={},o={}){const s=document.createElement("script");if(s.async=i,s.defer=!i,s.type=e,s.src=t,Object.keys(r).forEach((t=>{s.setAttribute(t,r[t])})),Object.keys(o).forEach((t=>{s.dataset[t]=o[t]})),"string"==typeof n){const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t)}else(n||document.body).append(s);return s}loadScript(t,e="text/javascript",i=!0,n=null,r={},o={}){return new Promise(((s,a)=>{if(this.loadedAssets.includes(t))return s(null);const c=this.createScript(t,e,i,n,r,o);c.onload=s,c.onerror=a})).then((e=>(this.loadedAssets.push(t),e)))}};o=(0,n.Cg)([(0,r._G)()],o)},546:(t,e,i)=>{"use strict";i.d(e,{P:()=>o});var n=i(635),r=i(223);let o=class{recognizeChromiumBuild(t,e){const i=e.match(/\b(OPR|Edg)\/(\d+)/);return null!==i?i.slice(1).join(" ").replace("OPR","Opera").replace("Edg","Edge"):"Chrome "+t}recognizeIEBuild(t){return`IE ${(/\brv[ :]+(\d+)/g.exec(t)||[""])[1]||""}`}getBrowserNameAndVersion(t){const[,e,i]=t.match(/(opera|chrome|safari|firefox|msie|trident|CriOS(?=\/))\/?\s*(\d+)/i)||[];return[e,i]}recognizeDefaultBrowser(t,e,i,n,r){const o=r?[n,r]:[e,i,"-?"],s=t.match(/version\/(\d+)/i);return null!==s&&o.splice(1,1,s[1]),o.join(" ")}getBrowser(){const{appName:t,appVersion:e,userAgent:i}=window.navigator,[n,r]=this.getBrowserNameAndVersion(i);return/trident/i.test(n)?this.recognizeIEBuild(i):"Chrome"===n||"CriOS"===n?this.recognizeChromiumBuild(r,i):this.recognizeDefaultBrowser(i,t,e,n,r)}};o=(0,n.Cg)([(0,r.Gr)()],o)},569:(t,e,i)=>{"use strict";i.d(e,{e:()=>n});const n=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf","ad","br","cn"]},710:(t,e,i)=>{"use strict";i.d(e,{p:()=>a});var n=i(635),r=i(223),o=i(393),s=i(439);let a=class{constructor(t,e){this.platform=e,this.testRegex=/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i,this.userAgent=t.userAgent}getDeviceType(){const t=this.platform.get();return t===s.l.FANDOMDESKTOP?"desktop":t===s.l.FANDOMMOBILE||this.testRegex.test(this.userAgent)?"smartphone":"desktop"}};a=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.WQ)(o.kW)),(0,n.Qj)(1,(0,r.WQ)(s.O))],a)},695:(t,e,i)=>{"use strict";i.d(e,{u:()=>c});var n=i(635),r=i(223),o=i(393),s=i(569);class a extends Error{constructor(t){super(t),this.name="GeoJsonParseException"}}let c=class{constructor(t,e){this.cookiesManager=t,this.window=e}get(){return this.geoData||(this.geoData=this.getGeoData()),this.geoData}set(t){this.geoData=t}getGeoData(){var t;if(void 0!==(null===(t=this.window.ads)||void 0===t?void 0:t.geo))return this.window.ads.geo;const e=this.getGeoDataFromCookie();return Object.keys(e).length?e:this.getGeoDataFromOneTrust()}getGeoDataFromCookie(){const t=this.cookiesManager.get("Geo");if(!t)return{};const e=decodeURIComponent(t);try{return JSON.parse(e)}catch(t){throw new a(`Failed to parse Geo cookie: ${t}`)}}getGeoDataFromOneTrust(){return this.window.OneTrust&&this.window.OneTrust.getGeolocationData()?{country:this.window.OneTrust.getGeolocationData().country}:{}}getCountryCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.country)||void 0===e?void 0:e.toLowerCase()}getRegionCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.region)||void 0===e?void 0:e.toLowerCase()}getContinentCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.continent)||void 0===e?void 0:e.toLowerCase()}isGdprCountry(){return s.e.includes(this.getCountryCode())}};c=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.WQ)(o.AZ)),(0,n.Qj)(1,(0,r.WQ)(o.jf))],c)},858:(t,e,i)=>{"use strict";i.d(e,{Q:()=>a,j:()=>s});var n,r=i(635),o=i(223);class s extends Error{constructor(t){super(t),this.name=this.constructor.name}}let a=n=class{get(t){return(0,r.sH)(this,arguments,void 0,(function*(t,e={mode:"cors"},i=n.DEFAULT_TIMEOUT){return this.fetch(t,"GET",e,i)}))}put(t,e){return(0,r.sH)(this,arguments,void 0,(function*(t,e,i={mode:"cors"}){return this.fetch(t,"PUT",i,0,e)}))}fetch(t,e){return(0,r.sH)(this,arguments,void 0,(function*(t,e,i={mode:"cors"},n=0,r){let o,a;if(n>0){const t=new AbortController;a=setTimeout((()=>t.abort()),n),o=t.signal}try{const n=yield fetch(t,Object.assign({method:e,signal:o,headers:r?{"Content-Type":"application/json"}:void 0,body:r?JSON.stringify(r):void 0},i));if(void 0!==a&&clearTimeout(a),!n.ok)throw new s(`HTTP error ${t}! Status: ${n.status}`);return n}catch(e){if(e instanceof s)throw e;throw new s(`HTTP error ${e} while sending request to ${t}!`)}}))}};a.DEFAULT_TIMEOUT=1e3,a=n=(0,r.Cg)([(0,o._G)()],a)},978:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(38);function r(){return"1"===n.C.get("identity_debug")}},144:(t,e,i)=>{"use strict";i.d(e,{O:()=>c,V:()=>l});var n=i(635),r=i(38),o=i(223),s=i(393),a=i(978);class c{transform(t,e){return t.setLoggerGroup(e)}}let l=class{constructor(t){var e,i;this.logGroup="Global",this.debugGroup=this.getDebugGroup()||"",this.groups=this.debugGroup.split(","),this.initTime=null!==(i=null===(e=null==t?void 0:t.performance)||void 0===e?void 0:e.timeOrigin)&&void 0!==i?i:Date.now()}setLoggerGroup(t){return this.logGroup=t,this}getTimeDelta(){return Date.now()-this.initTime}getDebugGroup(){return r.C.get("identity_debug")}getTimeDeltaFixed(){return(this.getTimeDelta()/1e3).toFixed(4)}info(...t){this.loggingEnabled()&&console.info(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}warn(...t){this.loggingEnabled()&&console.warn(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}error(...t){this.loggingEnabled()&&console.error(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}loggingEnabled(){return(0,a.A)()||-1!==this.groups.indexOf(this.logGroup)}};l=(0,n.Cg)([(0,o._G)(),(0,n.Qj)(0,(0,o.WQ)(s.jf))],l)},439:(t,e,i)=>{"use strict";i.d(e,{O:()=>a,l:()=>n});var n,r=i(635),o=i(223),s=i(610);!function(t){t.F2="f2",t.FUTHEAD="futhead",t.MUTHEAD="muthead",t.GAMESPOT="gamespot",t.COMICVINE="comicvine",t.GAMEFAQS="gamefaqs",t.METACRITIC="metacritic",t.METACRITIC_NEUTRON="metacritic-neutron",t.TVGUIDE="tvguide",t.TVGUIDE_MTC="tvguide-mtc",t.GIANTBOMB="giantbomb",t.FANATICAL="fanatical",t.FANDOMDESKTOP="fandomdesktop",t.FANDOMMOBILE="fandommobile"}(n||(n={}));let a=class{constructor(t){this.adsContext=t}get(){var t;const e=this.adsContext.get();return(null!==(t=null==e?void 0:e.platform)&&void 0!==t?t:null==e?void 0:e.app)||this.detectPlatform()}detectPlatform(){var t,e,i;return void 0!==window.mw&&void 0!==(null===(i=null===(e=null===(t=window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===i?void 0:i.platformName)?window.ads.context.opts.platformName:this.checkHostname()}checkHostname(){const{hostname:t,pathname:e}=window.location;switch(!0){case t.includes("fandom"):return n.F2;case t.includes("futhead"):return n.FUTHEAD;case t.includes("muthead"):return n.MUTHEAD;case t.includes("gamespot"):return t.includes("comicvine")?n.COMICVINE:t.includes("gamefaqs")?n.GAMEFAQS:n.GAMESPOT;case t.includes("metacritic"):return e.includes("news")?n.METACRITIC_NEUTRON:n.METACRITIC;case t.includes("tvguide"):return n.TVGUIDE;case t.includes("giantbomb"):return n.GIANTBOMB;case t.includes("fanatical"):return n.FANATICAL;default:return n.FANDOMDESKTOP}}};a=(0,r.Cg)([(0,o.Gr)(),(0,r.Qj)(0,(0,o.WQ)(s.i))],a)},38:(t,e,i)=>{"use strict";i.d(e,{C:()=>n});class n{static getURLSearchParams(){const t=window.location.search.substring(1);return new URLSearchParams(t)}static get(t){return n.getURLSearchParams().get(t)}static stringify(t){const e=new URLSearchParams(t);return e.sort(),e.toString()}}},874:(t,e,i)=>{"use strict";i.d(e,{O:()=>o});var n=i(635),r=i(223);let o=class{static extract(t){const e=t.split(".");if(e.length<2)return t;let i=`.${e[e.length-2]}.${e[e.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(i)>=0&&(i=`.${e[e.length-3]}${i}`),i}};o=(0,n.Cg)([(0,r._G)()],o)},167:(t,e,i)=>{"use strict";i.d(e,{j:()=>s});var n=i(635),r=i(223),o=i(393);let s=class{constructor(t){this.window=t}get(t,e=null){var i,n,r;return null!==(r=null===(n=null===(i=this.window.mw)||void 0===i?void 0:i.config)||void 0===n?void 0:n.get(t))&&void 0!==r?r:e}};s=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.WQ)(o.jf))],s)},223:(t,e,i)=>{"use strict";var n;i.d(e,{kL:()=>O,cb:()=>g,WQ:()=>j,MR:()=>A,_G:()=>R,Gr:()=>_}),function(t){t[t.Transient=0]="Transient",t[t.Singleton=1]="Singleton",t[t.ResolutionScoped=2]="ResolutionScoped",t[t.ContainerScoped=3]="ContainerScoped"}(n||(n={}));const r=n;var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},o(t,e)};function s(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function u(t){return!!t.useClass}function d(t){return!!t.useFactory}var h=function(){function t(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return t.prototype.createProxy=function(t){var e,i=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(e=t(i.wrap()),n=!0),e})))},t.prototype.createHandler=function(t){var e={};return this.reflectMethods.forEach((function(i){e[i]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e[0]=t(),Reflect[i].apply(void 0,l(e))}})),e},t}();function g(t){if(void 0===t)throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new h(t)}function p(t){return"string"==typeof t||"symbol"==typeof t}function f(t){return"object"==typeof t&&"token"in t&&"transform"in t}function v(t){return!!t.useToken}function m(t){return null!=t.useValue}const y=function(){function t(){this._registryMap=new Map}return t.prototype.entries=function(){return this._registryMap.entries()},t.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},t.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},t.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},t.prototype.setAll=function(t,e){this._registryMap.set(t,e)},t.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},t.prototype.clear=function(){this._registryMap.clear()},t.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},t}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(y),C=function(){this.scopedResolutions=new Map};var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(y),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(y);const k=function(){this.preResolution=new b,this.postResolution=new S};var E=new Map,Q=function(){function t(t){this.parent=t,this._registry=new w,this.interceptors=new k,this.disposed=!1,this.disposables=new Set}return t.prototype.register=function(t,e,i){var n;if(void 0===i&&(i={lifecycle:r.Transient}),this.ensureNotDisposed(),n=function(t){return u(t)||m(t)||v(t)||d(t)}(e)?e:{useClass:e},v(n))for(var o=[t],s=n;null!=s;){var a=s.useToken;if(o.includes(a))throw new Error("Token registration cycle detected! "+l(o,[a]).join(" -> "));o.push(a);var c=this._registry.get(a);s=c&&v(c.provider)?c.provider:null}if((i.lifecycle===r.Singleton||i.lifecycle==r.ContainerScoped||i.lifecycle==r.ResolutionScoped)&&(m(n)||d(n)))throw new Error('Cannot use lifecycle "'+r[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:n,options:i}),this},t.prototype.registerType=function(t,e){return this.ensureNotDisposed(),p(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},t.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},t.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),p(t)){if(p(e))return this.register(t,{useToken:e},{lifecycle:r.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:r.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var i=t;return e&&!p(e)&&(i=e),this.register(t,{useClass:i},{lifecycle:r.Singleton})},t.prototype.resolve=function(t,e){void 0===e&&(e=new C),this.ensureNotDisposed();var i=this.getRegistration(t);if(!i&&p(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"Single"),i){var n=this.resolveRegistration(i,e);return this.executePostResolutionInterceptor(t,n,"Single"),n}if(function(t){return"function"==typeof t||t instanceof h}(t))return n=this.construct(t,e),this.executePostResolutionInterceptor(t,n,"Single"),n;throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},t.prototype.executePreResolutionInterceptor=function(t,e){var i,n;if(this.interceptors.preResolution.has(t)){var r=[];try{for(var o=a(this.interceptors.preResolution.getAll(t)),s=o.next();!s.done;s=o.next()){var c=s.value;"Once"!=c.options.frequency&&r.push(c),c.callback(t,e)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(t,r)}},t.prototype.executePostResolutionInterceptor=function(t,e,i){var n,r;if(this.interceptors.postResolution.has(t)){var o=[];try{for(var s=a(this.interceptors.postResolution.getAll(t)),c=s.next();!c.done;c=s.next()){var l=c.value;"Once"!=l.options.frequency&&o.push(l),l.callback(t,e,i)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(t,o)}},t.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===r.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var i,n=t.options.lifecycle===r.Singleton,o=t.options.lifecycle===r.ContainerScoped,s=n||o;return i=m(t.provider)?t.provider.useValue:v(t.provider)?s?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):u(t.provider)?s?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):d(t.provider)?t.provider.useFactory(this):this.construct(t.provider,e),t.options.lifecycle===r.ResolutionScoped&&e.scopedResolutions.set(t,i),i},t.prototype.resolveAll=function(t,e){var i=this;void 0===e&&(e=new C),this.ensureNotDisposed();var n=this.getAllRegistrations(t);if(!n&&p(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"All"),n){var r=n.map((function(t){return i.resolveRegistration(t,e)}));return this.executePostResolutionInterceptor(t,r,"All"),r}var o=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,o,"All"),o},t.prototype.isRegistered=function(t,e){return void 0===e&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},t.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},t.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var i=a(this._registry.entries()),n=i.next();!n.done;n=i.next()){var r=c(n.value,2),o=r[0],s=r[1];this._registry.setAll(o,s.filter((function(t){return!m(t.provider)})).map((function(t){return t.instance=void 0,t})))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.createChildContainer=function(){var e,i;this.ensureNotDisposed();var n=new t(this);try{for(var o=a(this._registry.entries()),s=o.next();!s.done;s=o.next()){var l=c(s.value,2),u=l[0],d=l[1];d.some((function(t){return t.options.lifecycle===r.ContainerScoped}))&&n._registry.setAll(u,d.map((function(t){return t.options.lifecycle===r.ContainerScoped?{provider:t.provider,options:t.options}:t})))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return n},t.prototype.beforeResolution=function(t,e,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:i})},t.prototype.afterResolution=function(t,e,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:i})},t.prototype.dispose=function(){return t=this,e=void 0,n=function(){var t;return function(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach((function(e){var i=e.dispose();i&&t.push(i)})),[4,Promise.all(t)];case 1:return e.sent(),[2]}}))},new((i=void 0)||(i=Promise))((function(r,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}));var t,e,i,n},t.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},t.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},t.prototype.construct=function(t,e){var i=this;if(t instanceof h)return t.createProxy((function(t){return i.resolve(t,e)}));var n,r=function(){var n=E.get(t);if(!n||0===n.length){if(0===t.length)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var r=n.map(i.resolveParams(e,t));return new(t.bind.apply(t,l([void 0],r)))}();return"function"!=typeof(n=r).dispose||n.dispose.length>0||this.disposables.add(r),r},t.prototype.resolveParams=function(t,e){var i=this;return function(n,r){var o,s,a,u;try{return"object"==typeof(u=n)&&"token"in u&&"multiple"in u?f(n)?n.multiple?(o=i.resolve(n.transform)).transform.apply(o,l([i.resolveAll(n.token)],n.transformArgs)):(s=i.resolve(n.transform)).transform.apply(s,l([i.resolve(n.token,t)],n.transformArgs)):n.multiple?i.resolveAll(n.token):i.resolve(n.token,t):f(n)?(a=i.resolve(n.transform,t)).transform.apply(a,l([i.resolve(n.token,t)],n.transformArgs)):i.resolve(n,t)}catch(t){throw new Error(function(t,e,i){var n,r,o,s,a=c(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1];return n="Cannot inject the dependency "+(s=e,(null===(o=void 0===a?null:a)?"at position #"+s:'"'+o.split(",")[s].trim()+'" at position #'+s)+' of "')+t.name+'" constructor. Reason:',void 0===r&&(r="    "),l([n],i.message.split("\n").map((function(t){return r+t}))).join("\n")}(e,r,t))}}},t.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},t}(),O=new Q,T="injectionTokens";function I(t,e){return function(i,n,r){var o=Reflect.getOwnMetadata(T,i)||{};o[r]=e?{token:t,transform:e.transformToken,transformArgs:e.args||[]}:t,Reflect.defineMetadata(T,o,i)}}const j=function(t){return I(t)},R=function(){return function(t){E.set(t,function(t){var e=Reflect.getMetadata("design:paramtypes",t)||[],i=Reflect.getOwnMetadata(T,t)||{};return Object.keys(i).forEach((function(t){e[+t]=i[t]})),e}(t))}},_=function(){return function(t){R()(t),O.registerSingleton(t)}},A=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return I(t,{transformToken:e,args:i})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.")},698:(t,e,i)=>{var n;!function(t){!function(){var e="object"==typeof globalThis?globalThis:"object"==typeof i.g?i.g:"object"==typeof self?self:"object"==typeof this?this:function(){throw new ReferenceError("globalThis could not be found. Please polyfill globalThis before loading this module.")}(),n=r(t);function r(t,e){return function(i,n){Object.defineProperty(t,i,{configurable:!0,writable:!0,value:n}),e&&e(i,n)}}void 0!==e.Reflect&&(n=r(e.Reflect,n)),function(t,e){var i="function"==typeof Symbol,n=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:P("Symbol.toPrimitive not found."),r=i&&void 0!==Symbol.iterator?Symbol.iterator:P("Symbol.iterator not found."),o=Object.getPrototypeOf(Function),s="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:P("A valid Map constructor could not be found."),a="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:P("A valid Set constructor could not be found."),c="function"==typeof WeakMap?WeakMap:P("A valid WeakMap constructor could not be found."),l=i?Symbol.for("@reflect-metadata:registry"):void 0,u=function(){var t;return!C(l)&&S(e.Reflect)&&Object.isExtensible(e.Reflect)&&(t=e.Reflect[l]),C(t)&&(t=function(){var t,i,n,r;C(l)||void 0===e.Reflect||l in e.Reflect||"function"!=typeof e.Reflect.defineMetadata||(t=function(t){var e=t.defineMetadata,i=t.hasOwnMetadata,n=t.getOwnMetadata,r=t.getOwnMetadataKeys,o=t.deleteMetadata,s=new c;return{isProviderFor:function(t,e){var i=s.get(t);return!(C(i)||!i.has(e))||!!r(t,e).length&&(C(i)&&(i=new a,s.set(t,i)),i.add(e),!0)},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:r,OrdinaryDeleteMetadata:o}}(e.Reflect));var o=new c,u={registerProvider:d,getProvider:g,setProvider:f};return u;function d(e){if(!Object.isExtensible(u))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===e:break;case C(i):i=e;break;case i===e:break;case C(n):n=e;break;case n===e:break;default:void 0===r&&(r=new a),r.add(e)}}function h(e,o){if(!C(i)){if(i.isProviderFor(e,o))return i;if(!C(n)){if(n.isProviderFor(e,o))return i;if(!C(r))for(var s=R(r);;){var a=A(s);if(!a)return;var c=_(a);if(c.isProviderFor(e,o))return M(s),c}}}if(!C(t)&&t.isProviderFor(e,o))return t}function g(t,e){var i,n=o.get(t);return C(n)||(i=n.get(e)),C(i)?(C(i=h(t,e))||(C(n)&&(n=new s,o.set(t,n)),n.set(e,i)),i):i}function p(t){if(C(t))throw new TypeError;return i===t||n===t||!C(r)&&r.has(t)}function f(t,e,i){if(!p(i))throw new Error("Metadata provider not registered.");var n=g(t,e);if(n!==i){if(!C(n))return!1;var r=o.get(t);C(r)&&(r=new s,o.set(t,r)),r.set(e,i)}return!0}}()),!C(l)&&S(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,l,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}(),d=function(t){var e=new c,i={isProviderFor:function(t,i){var n=e.get(t);return!C(n)&&n.has(i)},OrdinaryDefineOwnMetadata:function(t,e,i,r){n(i,r,!0).set(t,e)},OrdinaryHasOwnMetadata:function(t,e,i){var r=n(e,i,!1);return!C(r)&&E(r.has(t))},OrdinaryGetOwnMetadata:function(t,e,i){var r=n(e,i,!1);if(!C(r))return r.get(t)},OrdinaryOwnMetadataKeys:function(t,e){var i=[],r=n(t,e,!1);if(C(r))return i;for(var o=R(r.keys()),s=0;;){var a=A(o);if(!a)return i.length=s,i;var c=_(a);try{i[s]=c}catch(t){try{M(o)}finally{throw t}}s++}},OrdinaryDeleteMetadata:function(t,i,r){var o=n(i,r,!1);if(C(o))return!1;if(!o.delete(t))return!1;if(0===o.size){var s=e.get(i);C(s)||(s.delete(r),0===s.size&&e.delete(s))}return!0}};return u.registerProvider(i),i;function n(n,r,o){var a=e.get(n),c=!1;if(C(a)){if(!o)return;a=new s,e.set(n,a),c=!0}var l=a.get(r);if(C(l)){if(!o)return;if(l=new s,a.set(r,l),!t.setProvider(n,r,i))throw a.delete(r),c&&e.delete(n),new Error("Wrong provider for target.")}return l}}(u);function h(t,e,i){if(g(t,e,i))return!0;var n=D(e);return!b(n)&&h(t,n,i)}function g(t,e,i){var n=x(e,i,!1);return!C(n)&&E(n.OrdinaryHasOwnMetadata(t,e,i))}function p(t,e,i){if(g(t,e,i))return f(t,e,i);var n=D(e);return b(n)?void 0:p(t,n,i)}function f(t,e,i){var n=x(e,i,!1);if(!C(n))return n.OrdinaryGetOwnMetadata(t,e,i)}function v(t,e,i,n){x(i,n,!0).OrdinaryDefineOwnMetadata(t,e,i,n)}function m(t,e){var i=y(t,e),n=D(t);if(null===n)return i;var r=m(n,e);if(r.length<=0)return i;if(i.length<=0)return r;for(var o=new a,s=[],c=0,l=i;c<l.length;c++){var u=l[c];o.has(u)||(o.add(u),s.push(u))}for(var d=0,h=r;d<h.length;d++)u=h[d],o.has(u)||(o.add(u),s.push(u));return s}function y(t,e){var i=x(t,e,!1);return i?i.OrdinaryOwnMetadataKeys(t,e):[]}function w(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function C(t){return void 0===t}function b(t){return null===t}function S(t){return"object"==typeof t?null!==t:"function"==typeof t}function k(t,e){switch(w(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var i=3===e?"string":5===e?"number":"default",r=j(t,n);if(void 0!==r){var o=r.call(t,i);if(S(o))throw new TypeError;return o}return function(t,e){if("string"===e){var i=t.toString;if(T(i)&&!S(r=i.call(t)))return r;if(T(n=t.valueOf)&&!S(r=n.call(t)))return r}else{var n;if(T(n=t.valueOf)&&!S(r=n.call(t)))return r;var r,o=t.toString;if(T(o)&&!S(r=o.call(t)))return r}throw new TypeError}(t,"default"===i?"number":i)}function E(t){return!!t}function Q(t){var e=k(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function O(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function T(t){return"function"==typeof t}function I(t){return"function"==typeof t}function j(t,e){var i=t[e];if(null!=i){if(!T(i))throw new TypeError;return i}}function R(t){var e=j(t,r);if(!T(e))throw new TypeError;var i=e.call(t);if(!S(i))throw new TypeError;return i}function _(t){return t.value}function A(t){var e=t.next();return!e.done&&e}function M(t){var e=t.return;e&&e.call(t)}function D(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===o)return e;if(e!==o)return e;var i=t.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return e;var r=n.constructor;return"function"!=typeof r||r===t?e:r}function P(t){throw t}function x(t,e,i){var n=u.getProvider(t,e);if(!C(n))return n;if(i){if(u.setProvider(t,e,d))return d;throw new Error("Illegal state.")}}t("decorate",(function(t,e,i,n){if(C(i)){if(!O(t))throw new TypeError;if(!I(e))throw new TypeError;return function(t,e){for(var i=t.length-1;i>=0;--i){var n=(0,t[i])(e);if(!C(n)&&!b(n)){if(!I(n))throw new TypeError;e=n}}return e}(t,e)}if(!O(t))throw new TypeError;if(!S(e))throw new TypeError;if(!S(n)&&!C(n)&&!b(n))throw new TypeError;return b(n)&&(n=void 0),function(t,e,i,n){for(var r=t.length-1;r>=0;--r){var o=(0,t[r])(e,i,n);if(!C(o)&&!b(o)){if(!S(o))throw new TypeError;n=o}}return n}(t,e,i=Q(i),n)})),t("metadata",(function(t,e){return function(i,n){if(!S(i))throw new TypeError;if(!C(n)&&!function(t){switch(w(t)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;v(t,e,i,n)}})),t("defineMetadata",(function(t,e,i,n){if(!S(i))throw new TypeError;return C(n)||(n=Q(n)),v(t,e,i,n)})),t("hasMetadata",(function(t,e,i){if(!S(e))throw new TypeError;return C(i)||(i=Q(i)),h(t,e,i)})),t("hasOwnMetadata",(function(t,e,i){if(!S(e))throw new TypeError;return C(i)||(i=Q(i)),g(t,e,i)})),t("getMetadata",(function(t,e,i){if(!S(e))throw new TypeError;return C(i)||(i=Q(i)),p(t,e,i)})),t("getOwnMetadata",(function(t,e,i){if(!S(e))throw new TypeError;return C(i)||(i=Q(i)),f(t,e,i)})),t("getMetadataKeys",(function(t,e){if(!S(t))throw new TypeError;return C(e)||(e=Q(e)),m(t,e)})),t("getOwnMetadataKeys",(function(t,e){if(!S(t))throw new TypeError;return C(e)||(e=Q(e)),y(t,e)})),t("deleteMetadata",(function(t,e,i){if(!S(e))throw new TypeError;C(i)||(i=Q(i));var n=x(e,i,!1);return!C(n)&&n.OrdinaryDeleteMetadata(t,e,i)}))}(n,e),void 0===e.Reflect&&(e.Reflect=t)}()}(n||(n={}))},635:(t,e,i)=>{"use strict";function n(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s}function r(t,e){return function(i,n){e(i,n,t)}}function o(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))}i.d(e,{Cg:()=>n,Qj:()=>r,sH:()=>o}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}},n={};function r(t){var e=n[t];if(void 0!==e)return e.exports;var o=n[t]={exports:{}};return i[t](o,o.exports,r),o.exports}r.m=i,r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce(((e,i)=>(r.f[i](t,e),e)),[])),r.u=t=>({224:"fandom-gdpr-consents",319:"static-consents",364:"ketch-consents",482:"fanatical-consents",832:"one-trust-consents"}[t]+".js"),r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="identity-engine:",r.l=(i,n,o,s)=>{if(t[i])t[i].push(n);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==e+o){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",e+o),a.src=i),t[i]=[n];var h=(e,n)=>{a.onerror=a.onload=null,clearTimeout(g);var r=t[i];if(delete t[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((t=>t(n))),e)return e(n)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=i[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{var t={57:0};r.f.j=(e,i)=>{var n=r.o(t,e)?t[e]:void 0;if(0!==n)if(n)i.push(n[2]);else{var o=new Promise(((i,r)=>n=t[e]=[i,r]));i.push(n[2]=o);var s=r.p+r.u(e),a=new Error;r.l(s,(i=>{if(r.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;a.message="Loading chunk "+e+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,n[1](a)}}),"chunk-"+e,e)}};var e=(e,i)=>{var n,o,[s,a,c]=i,l=0;if(s.some((e=>0!==t[e]))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);c&&c(r)}for(e&&e(i);l<s.length;l++)o=s[l],r.o(t,o)&&t[o]&&t[o][0](),t[o]=0},i=self.webpackChunkidentity_engine=self.webpackChunkidentity_engine||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),(()=>{"use strict";var t=r(635),e=(r(698),r(223));function i(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}var n=function t(e,n){function r(t,r,o){if("undefined"!=typeof document){"number"==typeof(o=i({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in o)o[a]&&(s+="; "+a,!0!==o[a]&&(s+="="+o[a].split(";")[0]));return document.cookie=t+"="+e.write(r,t)+s}}return Object.create({set:r,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var i=document.cookie?document.cookie.split("; "):[],n={},r=0;r<i.length;r++){var o=i[r].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(n[a]=e.read(s,a),t===a)break}catch(t){}}return t?n[t]:n}},remove:function(t,e){r(t,"",i({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,i({},this.attributes,e))},withConverter:function(e){return t(i({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),o=r(144),s=r(858),a=r(393),c=r(695),l=r(610);let u=class{constructor(t){this.adsContext=t}get(){var t;return"dev"===(null===(t=this.adsContext.get())||void 0===t?void 0:t.env)?"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/":"https://services.fandom.com/"}};u=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(l.i))],u);class d extends Error{constructor(t){super(t),this.name="GeoCookieException"}}let h=class{constructor(t,e,i,n,r){this.cookiesManager=t,this.httpClient=e,this.logger=i,this.geo=n,this.serviceBaseUrl=r,this.geoIPUrl=this.serviceBaseUrl.get()+"geoip/location"}setGeoCookieIfNotExist(){return(0,t.sH)(this,void 0,void 0,(function*(){if(this.cookiesManager.get("Geo"))this.logger.info("Geo cookie already exists");else try{const t=yield this.httpClient.get(this.geoIPUrl),{country_code:e,region:i,continent_code:n}=yield t.json(),r={country:e,region:i,continent:n},o=JSON.stringify(r);this.cookiesManager.set("Geo",o,{expires:365}),this.geo.set(r),this.logger.info("Geo cookie set")}catch(t){if(t instanceof s.j)throw new d(`Failed to fetch Geo cookie from pandora: ${t}`);throw new d(`Failed to set Geo cookie: ${t}`)}}))}};h=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(a.AZ)),(0,t.Qj)(1,(0,e.WQ)(s.Q)),(0,t.Qj)(2,(0,e.MR)(o.V,o.O,"GeoCookie")),(0,t.Qj)(3,(0,e.WQ)(c.u)),(0,t.Qj)(4,(0,e.WQ)(u))],h);var g=r(155),p=r(349),f=r(489),v=r(85),m=r(874),y=r(167),w=r(517);let C=class{constructor(t,e,i,n,r,o,s){this.cookiesManager=t,this.window=e,this.wikiConfig=i,this.context=n,this.logger=r,this.geo=o,this.communicationService=s,this.ageGateCookie="ag",this.ageGateExpiryMs=31536e6}init(e){return(0,t.sH)(this,void 0,void 0,(function*(){var t,i;Boolean(null===(i=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===i?void 0:i.directedAtChildren)&&this.wikiConfig.get("wgAgeGateEnabled",!1)?void 0===this.cookiesManager.get(this.ageGateCookie)&&(yield this.waitForAgeGateDataAndSetCookie(e)):this.logger.info("disabled")}))}waitForAgeGateDataAndSetCookie(e){return(0,t.sH)(this,void 0,void 0,(function*(){return new Promise((t=>{e.on(p.c.AGE_GATE_DATA,(({payload:e})=>{this.setAgeGateCookie(e),"us"!==this.geo.getCountryCode()||e.adult||this.setUsPrivacyCookie(w.u.yes),this.updateConsents(!e.adult),t()}))}))}))}setAgeGateCookie(t){var e,i;t||this.logger.warn("Payload data missing, using defaults");const n=null!==(e=null==t?void 0:t.adult)&&void 0!==e&&e,r=null!==(i=null==t?void 0:t.timestamp)&&void 0!==i?i:Date.now();this.cookiesManager.set(this.ageGateCookie,n?"1":"0",{domain:this.getTopLevelDomain(),expires:new Date(r+this.ageGateExpiryMs)})}setUsPrivacyCookie(t){this.communicationService.emit(new g.r(p.c.UPDATE_CONSENT_COOKIE,{uspValue:t}))}getTopLevelDomain(){const t=this.window.location.hostname;return m.O.extract(t)}updateConsents(t){if(t){const e=this.geo.getCountryCode();this.communicationService.emit(new g.r(p.c.CONSENT_UPDATE,{ccpaSignal:t,geoRequiresSignal:"us"===e,gdprConsent:!t,geoRequiresConsent:this.geo.isGdprCountry()}))}}};C=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(a.AZ)),(0,t.Qj)(1,(0,e.WQ)(a.jf)),(0,t.Qj)(2,(0,e.WQ)(y.j)),(0,t.Qj)(3,(0,e.WQ)(l.i)),(0,t.Qj)(4,(0,e.MR)(o.V,o.O,"AgeGate")),(0,t.Qj)(5,(0,e.WQ)(c.u)),(0,t.Qj)(6,(0,e.WQ)(v.U))],C);var b=r(712),S=r(841);let k=class{constructor(t,e,i){this.dataWarehouse=t,this.window=e,this.logger=i}activateTracking(){if(!this.isEnabled())return void this.logger.info("Hem Tracking is disabled");const t=this.extractHEMs();Object.keys(t).forEach((e=>{t[e]&&this.dataWarehouse.track(f.i.identity,{partner_name:"MediaWiki-"+e,partner_identity_id:t[e]})}))}isEnabled(){var t,e,i;return(null===(i=null===(e=null===(t=this.window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===i?void 0:i.userEmailHashes)&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){const[t,e,i]=this.window.ads.context.opts.userEmailHashes;return{md5:t,sha1:e,sha256:i}}};var E;k=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(S.X)),(0,t.Qj)(1,(0,e.WQ)(a.jf)),(0,t.Qj)(2,(0,e.MR)(o.V,o.O,"HemTracking"))],k),function(t){t.tracking="tracking",t.page="page",t.site="site",t.partners="partners",t.targeting="targeting"}(E||(E={}));let Q=class{constructor(t){this.window=t}get(t,e){return this.window.fandomContext[t][e]}set(t,e,i){this.window.fandomContext&&this.window.fandomContext[t]||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{[t]:{}})),this.window.fandomContext[t][e]=i.value}remove(t,e){try{delete this.window.fandomContext[t][e]}catch(t){}}};Q=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(a.jf))],Q);let O=class{constructor(t){this.cookiesManager=t}get(t){return this.cookiesManager.get(t)}set(t,e){const{value:i,domain:n,expiresMS:r}=e,o=new Date((new Date).getTime()+r);this.cookiesManager.set(t,i.toString(),{domain:n,expires:o})}remove(t){this.cookiesManager.remove(t)}};O=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(a.AZ))],O);let T=class{generate(){let t="";for(;t.length<10;)t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-"[64*Math.random()|0];return t}generateV2(){return`${this.generate()}.${Date.now()}`}};T=(0,t.Cg)([(0,e._G)()],T);let I=class{constructor(t){this.cookiesManager=t}getNextNumberFromCookie(t){const e=parseInt(this.cookiesManager.get(t));return Number.isNaN(e)?1:e+1}};I=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(a.AZ))],I);const j=18e5,R=15552e6;let _=class{constructor(t,e,i,n,r,o,s,a){this.contextRepository=t,this.cookieRepository=e,this.uuid=i,this.beaconGenerator=n,this.pageViewNumberGenerator=r,this.window=o,this.wikiConfig=s,this.communicationService=a,this.communicationService.on(p.c.PAGE_CHANGED,(()=>{this.updatePageViewData()}))}set(t,e){this.contextRepository.set(E.tracking,t,e),this.cookieRepository.set(t,e)}remove(t){this.contextRepository.remove(E.tracking,t),this.cookieRepository.remove(t)}updatePageViewData(){const t=this.window.location.hostname,e=m.O.extract(t);this.contextRepository.set(E.tracking,"pvUID",{domain:t,expiresMS:j,value:this.wikiConfig.get("pvUID")||this.window.pvUID||this.uuid()}),this.set("pvNumber",{domain:t,expiresMS:j,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:e,expiresMS:j,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}updateUserTrackingData(){const t=this.window.location.hostname,e=m.O.extract(t),i=this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId"),n={domain:e,expiresMS:R,value:i||this.beaconGenerator.generate()};this.contextRepository.set(E.tracking,"beaconId",n),this.cookieRepository.set("wikia_beacon_id",n);const r={domain:e,expiresMS:63072e6,value:this.cookieRepository.get("_b2")||this.beaconGenerator.generateV2()};this.cookieRepository.set("_b2",r);const o=this.wikiConfig.get("sessionId",this.window.sessionId)||this.cookieRepository.get("sessionId"),s={domain:e,expiresMS:j,value:o||this.uuid()};this.set("sessionId",s);const a=this.cookieRepository.get("wikia_session_id");this.cookieRepository.set("wikia_session_id",{domain:e,expiresMS:R,value:a||this.beaconGenerator.generate()})}setup(){this.updateUserTrackingData(),this.updatePageViewData(),this.communicationService.emit(new g.r(p.c.FANDOM_CONTEXT_SET))}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};_=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(Q)),(0,t.Qj)(1,(0,e.WQ)(O)),(0,t.Qj)(2,(0,e.WQ)(a.kk)),(0,t.Qj)(3,(0,e.WQ)(T)),(0,t.Qj)(4,(0,e.WQ)(I)),(0,t.Qj)(5,(0,e.WQ)(a.jf)),(0,t.Qj)(6,(0,e.WQ)(y.j)),(0,t.Qj)(7,(0,e.WQ)(v.U))],_);let A=class{constructor(t){this.sentry=t}resolve(t,e,i){var n;t.geoRequiresConsent&&t.gdprConsent||t.geoRequiresSignal&&!t.ccpaSignal||!t.geoRequiresSignal&&!t.geoRequiresConsent?(this.consentGiven=!0,null===(n=e())||void 0===n||n.catch((t=>this.sentry.captureException(t)))):(t.geoRequiresSignal&&t.ccpaSignal||t.geoRequiresConsent&&!t.gdprConsent)&&(this.consentGiven=!1,i())}getConsents(){return this.consentGiven}};function M(t,e){return Object.keys(e).forEach((function(i){"default"===i||"__esModule"===i||t.hasOwnProperty(i)||Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[i]}})})),t}function D(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,enumerable:!0,configurable:!0})}A=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(a.eF))],A);var P={},x={};function N(t){return new Promise((e=>setTimeout((()=>e()),t)))}D(x,"delay",(()=>N));var W={};function L(){const t=new URLSearchParams(window.location.search.substring(1));return Boolean(t.get("adengine_debug"))?t.get("adengine_debug"):t.get("identity_debug")}D(W,"getDebugGroup",(()=>L));var G={};D(G,"localStorageHelper",(()=>U));class U{constructor(t,e=6e4){this.key=t,this.ttlInMilliseconds=e;let i=!1;try{i=void 0!==window.localStorage&&null!==window.localStorage,i&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(t){i=!1}const n=t=>window?.instantConfigCache?.[t]??null,r=(t,e)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[t]=e};this.storageAdapter={getItem:t=>{try{return i?window.localStorage.getItem(t)??n(t):n(t)}catch(e){return n(t)}},setItem:(t,e)=>{try{if(i)return localStorage.setItem(t,e);r(t,e)}catch(i){r(t,e)}}}}set(t){const e=this.getObjectToStore(t);this.storageAdapter.setItem(this.key,JSON.stringify(e))}get(){const t=this.storageAdapter.getItem(this.key);return t?this.parseStoredValue(JSON.parse(t)):null}expired(t){return!t||t<Date.now()}getObjectToStore(t){return{data:t,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(t){return this.expired(t?.ttl)?null:t.data}}var V={};D(V,"lock",(()=>H)),D(V,"release",(()=>B));const F=new U("instant-config-lock",1e3);function H(){return"lock"===F.get()||(F.set("lock"),!1)}function B(){F.set(null)}var $={};D($,"getTimeDelta",(()=>Y)),D($,"logger",(()=>J)),D($,"warner",(()=>X));const q=L()||"",K=q.split(","),z=Date.now();function Y(){return((Date.now()-(window.performance?.timeOrigin??z))/1e3).toFixed(4)}function J(t,...e){""!==q&&("1"!==q&&-1===K.indexOf(t)||window.console.info(`${Y()}s\t\t ${t}`,e))}function X(t,...e){""!==q&&("1"!==q&&-1===K.indexOf(t)||window.console.warn(t,e))}M(P,x),M(P,W),M(P,G),M(P,V),M(P,$);var Z={},tt={};D(tt,"InstantConfigInterpreter",(()=>Tt));var et={},it={};function nt(t){return Array.isArray(t)&&t.length>0&&"object"==typeof t[0]}function rt(t){const e=t.sampling??t.s;return"number"==typeof e&&e>0&&e<100}D(it,"shouldBeListOfConfigGroups",(()=>nt)),D(it,"hasSampling",(()=>rt));var ot={};D(ot,"negativePrefix",(()=>st)),D(ot,"cacheSuffix",(()=>at)),D(ot,"samplingSeparator",(()=>ct)),D(ot,"worldWide",(()=>lt)),D(ot,"precision",(()=>ut)),D(ot,"experimentBucketSettingKey",(()=>dt));const st="non-",at="-cached",ct="/",lt="XX",ut=10**6,dt="eb";M(et,it),M(et,{}),M(et,{}),M(et,{}),M(et,{}),M(et,{}),M(et,{}),M(et,ot);class ht{constructor(t,e,i){this.container=e,this.settingsRepository=i,"number"==typeof t?this.experimentBucket=this.manageSampling(t):!0===t?this.experimentBucket=this.manageSampling(0):!1===t&&this.clean()}build(){return()=>this.experimentBucket??ht.getRandomBucket()}static getRandomBucket(){return Math.round(100*Math.random())}manageSampling(t){const e=this.readFromLoaderVariable()??this.readFromSettings()??ht.getRandomBucket();return this.storeInLoaderVariable(e),this.storeInSettings(e,t),e}readFromLoaderVariable(){return this.container.fandomContext?.experimentBucket}readFromSettings(){const t=this.settingsRepository&&this.settingsRepository.get(dt);return t&&Number(t)}storeInSettings(t,e){this.settingsRepository&&this.settingsRepository.set(dt,t.toString(),e)}storeInLoaderVariable(t){this.container.fandomContext=this.container.fandomContext||{},this.container.fandomContext.experimentBucket=t}clean(){this.settingsRepository&&this.settingsRepository.remove(dt)}}class gt{activeKeyValues=[];activeLabradorKeyValues=[];constructor(t){Array.isArray(t)?this.keyValueNamesMap=t.map((t=>t&&t.toString().split(":"))).filter((t=>t&&t.length>=2)).reduce(((t,e)=>(t[e[0]]=e[1],t)),{}):this.keyValueNamesMap={}}getActiveKeyValues(){return this.activeKeyValues}getActiveLabradorKeyValues(){return this.activeLabradorKeyValues}mark(t,e,i){const n=`${t}_${i?"B":"A"}_${i?e:100-e}`,r=this.keyValueNamesMap[n]??n;this.activeKeyValues.includes(n)||this.activeKeyValues.push(n),this.activeLabradorKeyValues.includes(r)||this.activeLabradorKeyValues.push(r)}}var pt={},ft={};D(ft,"BrowserMatcher",(()=>yt));var vt={};function mt(t){return t.startsWith(st)?{value:t.replace(st,""),negated:!0}:{value:t,negated:!1}}D(vt,"extractNegation",(()=>mt));class yt{constructor(t){this.currentBrowser=t?.toLowerCase()}isValid(t){const e=t.b??t.browsers??[],i=e.map((t=>t.toLowerCase())).map((t=>mt(t)));return 0===e.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,i)&&i.some((t=>this.currentBrowser.includes(t.value)!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var wt={};D(wt,"DeviceMatcher",(()=>Ct));class Ct{constructor(t){this.currentDevice=t}isValid(t){const e=(t.d??t.devices??[]).map((t=>t.toLowerCase())).map((t=>mt(t)));return 0===e.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,e)&&e.some((t=>t.value===this.currentDevice!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var bt={};D(bt,"DomainMatcher",(()=>St));class St{isValid(t){const e=t.o??t.domains??[];return 0===e.length||e.some((t=>window.location.hostname.includes(t)))}}var kt={};D(kt,"RegionMatcher",(()=>Et));class Et{constructor(t){this.geo=t}isValid(t,e){const i=t.r??t.regions??[],n=this.filterOutInvalidRegions(i);return e?e(n):this.isProperGeo(n)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(t=[]){return!(!t||!t.indexOf||this.isGeoExcluded(t)||!(this.isProperContinent(t)||this.isProperCountry(t)||this.isProperRegion(t)))}filterOutInvalidRegions(t){return t.filter((t=>!t.includes(ct))).filter((t=>!t.includes(at)))}isProperCountry(t){return!!(t&&t.indexOf&&(t.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(t,this.getCountryCode())))}isProperRegion(t){const e=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(t&&t.indexOf&&(t.indexOf(e)>-1||this.isSampledForGeo(t,e)))}containsContinent(t){const e=`${lt}-${this.getContinentCode()}`;return t.indexOf(e)>-1||this.isSampledForGeo(t,e)}containsWorldWide(t){return t.indexOf(lt)>-1||this.isSampledForGeo(t,lt)}isProperContinent(t){return!(!t||!t.indexOf||!this.containsWorldWide(t)&&!this.containsContinent(t))}isGeoExcluded(t){return!!(t.indexOf(`${st}${this.getCountryCode()}`)>-1||t.indexOf(`${st}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||t.indexOf(`${st}${lt}-${this.getContinentCode()}`)>-1)}hasSampling(t){return e=>0!==e.indexOf(st)&&e.indexOf(t+ct)>-1}getSamplingLimits(t){let[,e]=t.split(ct);return e=e.replace(at,""),Math.round(parseFloat(e)*ut)||0}isSampledForGeo(t,e){const i=t.filter(this.hasSampling(e));if(0===i.length)return!1;const n=Math.round(Math.random()*(100*ut))||0;return i.map((t=>this.getSamplingLimits(t))).some((t=>n<t))}}var Qt={};D(Qt,"SamplingMatcher",(()=>Ot));class Ot{constructor(t){this.samplingProvider=t,this.precision=10**6}isValid(t){return Math.round(this.samplingProvider()*this.precision)<Math.round(t*this.precision)}}M(pt,ft),M(pt,wt),M(pt,bt),M(pt,vt),M(pt,kt),M(pt,Qt);class Tt{constructor(t=new yt,e=new Ct,i=new St,n=new Et,r){this.browserMatcher=t,this.deviceMatcher=e,this.domainMatcher=i,this.regionMatcher=n,this.settingsRepository=r,this.logGroup="instant-config-interpreter",this.configResponse={}}init(t,e={},i,n=window){return this.configResponse={...e,...t},this.regionValidationPredicate=i,this.labradorKeyValuesMapper=new gt(this.getValue("icLABradorGamKeyValues")),this.samplingMatcher=new Ot(new ht(this.getValue("icExperimentBucket"),n,this.settingsRepository).build()),this}getValues(){return P.logger(this.logGroup,"get values called with",this.configResponse),void 0===this.values&&(this.values=Object.keys(this.configResponse).reduce(((t,e)=>(t[e]=this.getValue(e),t)),{})),this.values}getValue(t){const e=this.configResponse[t];if(nt(e)){const i=e.find(this.predicate(t));return i?.v??i?.value}return e}getActiveKeyValues(){return this.labradorKeyValuesMapper.getActiveKeyValues()}getActiveLabradorKeyValues(){return this.labradorKeyValuesMapper.getActiveLabradorKeyValues()}predicate(t){return e=>{const i=this.browserMatcher.isValid(e)&&this.deviceMatcher.isValid(e)&&this.domainMatcher.isValid(e)&&this.regionMatcher.isValid(e,this.regionValidationPredicate);if(!rt(e)||!1===i)return i;const n=e?.s??e?.sampling,r=this.samplingMatcher.isValid(n);return this.labradorKeyValuesMapper.mark(t,n,r),r}}}var It={};async function jt(t,e=2e3){const i=new AbortController,n=setTimeout((()=>i.abort()),e),r=await fetch(t,{signal:i.signal});return clearTimeout(n),r}D(It,"InstantConfigLoader",(()=>_t));const Rt="instant-config-loader";class _t{constructor(t,e=window){this.params=t,this.container=e,this.storage=new P.localStorageHelper(`instant-config-${t.appName}`,6e4),this.container.icbm=this.container.icbm||{},this.instantConfig=this.container.instantConfig,this.lockDelay="number"==typeof t.lockDelay?t.lockDelay:500}async getConfig(){if(this.instantConfig)return this.instantConfig;let t;return this.lockDelay>0?t=this.fetchInstantConfigThroughCache():(this.container.icbm.fetch||(this.container.icbm.fetch=this.fetchInstantConfig()),t=this.container.icbm.fetch),t.then((t=>t??this.fetchFallbackConfig()))}async fetchInstantConfigThroughCache(t=!1){if(P.lock()&&!t)return P.logger(Rt,"locked, awaiting",this.lockDelay),await N(this.lockDelay),this.fetchInstantConfigThroughCache(!0);try{const t=this.storage.get();if(t)return P.logger(Rt,"instant config pulled from local storage",t),JSON.parse(t);const e=await this.fetchInstantConfig();return e&&this.storage.set(JSON.stringify(e)),P.release(),e}catch(t){P.warner(Rt,"could not get instant config via cache",t),P.release()}}async fetchInstantConfig(){const t=this.params.instantConfigEndpoint??"https://services.fandom.com",e=this.params.instantConfigVariant??"icbm",{appName:i,compact:n}=this.params,r=new URLSearchParams({app:i});n&&r.set("compact","true");const o=`${t}/${e}/api/config?${r.toString()}`;try{const t=await jt(o,this.params.requestTimeout);if(!t.ok)return;const e=await t.json();return P.logger(Rt,"instant config fetched",e),e}catch(t){return void P.warner(Rt,"could not fetch instant config",t)}}async fetchFallbackConfig(){P.logger(Rt,"Fetching fallback config");const t=this.params.instantConfigFallbackEndpoint;if(void 0===t)return{};try{P.logger(Rt,t);const e=await jt(t,this.params.requestTimeout);if(!e.ok)return{};const i=await e.json();return P.logger(Rt,"fallback config fetched",i),i}catch(t){return P.warner(Rt,"could not fetch fallback config",t),{}}}}var At={};D(At,"InstantConfigOverrider",(()=>Dt));const Mt=["InstantGlobals","icbm"];class Dt{override(t,e){return[...t.keys()].filter((t=>{return e=t,Mt.some((t=>e.startsWith(`${t}.`)||e.startsWith(`${t}__`)));var e})).map((t=>{const[,e]=t.split(".").map((t=>t.split("__"))).flat();return{paramKey:t,key:e}})).map((({paramKey:e,key:i})=>({key:i,value:this.parseValue(t.get(e))}))).reduce(((t,{key:e,value:i})=>({...t,[e]:i})),e)}parseValue(t){if("true"===t||"false"===t)return"true"===t;const e=parseInt(t,10);if(t===`${e}`)return e;try{return JSON.parse(t)}catch(e){return t||null}}}M(Z,tt),M(Z,It),M(Z,At),M(Z,pt);var Pt=r(38),xt=r(710),Nt=r(546),Wt=r(439);class Lt{constructor(t,e,i){this.cookiesManager=t,this.communicationService=e,this.topLevelDomain=m.O.extract(i.location.hostname)}get(t){return this.cookiesManager.get(t)}remove(t){this.cookiesManager.remove(t,{domain:this.topLevelDomain})}set(t,e,i){this.communicationService.on(p.c.CONSENT_READY,(n=>{if((!n.geoRequiresSignal||!n.ccpaSignal)&&(!n.geoRequiresConsent||n.gdprConsent)){const n={domain:this.topLevelDomain};i&&(n.expires=i),this.cookiesManager.set(t,e,n)}}))}}let Gt=class{constructor(t,e,i,n,r,o,s,a,c){this.adsContext=t,this.device=e,this.browser=i,this.platform=n,this.geo=r,this.serviceBaseUrl=o,this.window=s,this.cookiesManager=a,this.logger=c,this.repository={}}init(e){return(0,t.sH)(this,arguments,void 0,(function*(t,e={}){var i;const n=null===(i=this.adsContext.get())||void 0===i?void 0:i.env,r=this.serviceBaseUrl.get().slice(0,-1),o=this.platform.get(),s=this.geo.get(),a=new _t({appName:o,instantConfigEndpoint:r,instantConfigFallbackEndpoint:`https://script.wikia.nocookie.net/fandom-ae-assets/icbm/${null!=n?n:"prod"}/icbm_state_${o}.json`,compact:!0}),c=new Lt(this.cookiesManager,t,this.window),l=new Tt(new yt(this.browser.getBrowser()),new Ct(this.device.getDeviceType()),new St,new Et(s),c);let u=yield a.getConfig();u=(new Dt).override(Pt.C.getURLSearchParams(),u);const d=l.init(u,e);return this.repository=d.getValues(),this.logger.info("instantiated with",this.repository),this}))}get(t,e){var i,n;return null!==(n=null===(i=this.repository)||void 0===i?void 0:i[t])&&void 0!==n?n:e}};var Ut;Gt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(l.i)),(0,t.Qj)(1,(0,e.WQ)(xt.p)),(0,t.Qj)(2,(0,e.WQ)(Nt.P)),(0,t.Qj)(3,(0,e.WQ)(Wt.O)),(0,t.Qj)(4,(0,e.WQ)(c.u)),(0,t.Qj)(5,(0,e.WQ)(u)),(0,t.Qj)(6,(0,e.WQ)(a.jf)),(0,t.Qj)(7,(0,e.WQ)(a.AZ)),(0,t.Qj)(8,(0,e.MR)(o.V,o.O,"InstantConfig"))],Gt),function(t){t.LOCAL="local",t.IDENTITY_STORAGE="identity_storage"}(Ut||(Ut={}));class Vt{constructor(t){this.storage=t}getItem(t){const e=this.storage.getItem(t);try{return null!==e?JSON.parse(e):null}catch(t){return e}}setItem(t,e){const i=e instanceof Object?JSON.stringify(e):e;this.storage.setItem(t,i)}removeItem(t){return this.storage.removeItem(t)}}let Ft=class{constructor(t){this.storageAdapter=new Vt(t.localStorage)}getItem(t){return this.storageAdapter.getItem(t)}setItem(t,e){try{this.storageAdapter.setItem(t,e)}catch(t){}}removeItem(t){return this.storageAdapter.removeItem(t)}};Ft=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(a.jf))],Ft);let Ht=class{constructor(t,e,i,n,r){this.logger=t,this.uuid=e,this.storage=i,this.serviceBaseUrl=n,this.httpClient=r,this.logGroup="identity-storage",this.IdentityStorageKey="identity",this.identityServiceUrl=this.serviceBaseUrl.get()+"identity-storage/"}fetchData(){return(0,t.sH)(this,void 0,void 0,(function*(){try{const t=yield this.httpClient.get(this.identityServiceUrl,{mode:"cors",credentials:"include"});return 200===t.status||202===t.status?t.json():this.createFallbackResponse()}catch(t){return this.logger.info(this.logGroup,"Loading Identity LocalStorage data failed",t),this.createFallbackResponse()}}))}postData(e){return(0,t.sH)(this,void 0,void 0,(function*(){const t={ppid:e.ppid},i=this.identityServiceUrl+"identity";return(yield this.httpClient.put(i,t,{mode:"cors",credentials:"include"})).json()}))}getLocalData(){return this.storage.getItem(this.IdentityStorageKey)}setLocalData(t){this.storage.setItem(this.IdentityStorageKey,t)}createFallbackResponse(){return{timestamp:Date.now(),over18:!1,synced:!1,ppid:this.uuid()}}};Ht=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(o.V,o.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(a.kk)),(0,t.Qj)(2,(0,e.WQ)(Ft)),(0,t.Qj)(3,(0,e.WQ)(u)),(0,t.Qj)(4,(0,e.WQ)(s.Q))],Ht);let Bt=class{constructor(t,e,i,n,r){this.logger=t,this.windowContextRepository=e,this.instantConfigService=i,this.identityStorageClient=n,this.sentry=r}get(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.getLocalData();return t&&!t.synced&&this.setRemote(t),!t||this.isDeprecated(t)?this.getRemote():(this.setIdentityContextVariables(t),t)}))}setRemote(e){return(0,t.sH)(this,void 0,void 0,(function*(){try{yield this.identityStorageClient.postData(e);const t=Object.assign(Object.assign({},this.identityStorageClient.getLocalData()),{synced:!0});return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}catch(t){this.sentry.captureException(t),this.logger.error("Updating Identity LocalStorage data failed")}}))}isDeprecated(t){const e=this.instantConfigService.get("icIdentityTtl",6048e5),i=Date.now()-e;return!t.timestamp||t.timestamp-i<0}getLocalData(){return(0,t.sH)(this,void 0,void 0,(function*(){return this.identityStorageClient.getLocalData()}))}getRemote(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.identityStorageClient.fetchData();return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}))}setIdentityContextVariables(t){t.over18&&this.windowContextRepository.set(E.tracking,"over_18",{value:"1"})}};Bt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(o.V,o.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(Q)),(0,t.Qj)(2,(0,e.WQ)(Gt)),(0,t.Qj)(3,(0,e.WQ)(Ht)),(0,t.Qj)(4,(0,e.WQ)(a.eF))],Bt);let $t=class{constructor(t,e){this.logger=t,this.identityStorageService=e}get(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.identityStorageService.get();return this.logger.info(t),t.ppid}))}};$t=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(o.V,o.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(Bt))],$t);let qt=class{constructor(t,e,i){this.logger=t,this.uuid=e,this.storage=i}get(){return Promise.resolve(this.storage.getItem("ppid")||this.generatePPID())}generatePPID(){this.logger.info("did not found a PPID in LocalStorage");const t=this.uuid();return this.storage.setItem("ppid",t),t}};qt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(o.V,o.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(a.kk)),(0,t.Qj)(2,(0,e.WQ)(Ft))],qt);let Kt=class{constructor(t,e,i,n,r,o,s){this.dataWarehouse=t,this.logger=e,this.windowContextRepository=i,this.instantConfigService=n,this.identityStorageRepository=r,this.localStorageRepository=o,this.communicationService=s}getPPID(t){switch(this.logger.info("active strategy: ",t),t){case Ut.IDENTITY_STORAGE:return this.identityStorageRepository;case Ut.LOCAL:default:return this.localStorageRepository}}generatePPID(){return(0,t.sH)(this,void 0,void 0,(function*(){try{const t=this.instantConfigService.get("icPpidRepository",Ut.LOCAL),e=yield this.getPPID(t).get();this.dataWarehouse.track(f.i.identity,{partner_name:"Google",partner_identity_id:e}),this.communicationService.emit(new g.r(p.c.IDENTITY_PARTNER_DATA_OBTAINED,{payload:{partnerName:"Google",partnerIdentityId:e}})),this.windowContextRepository.set(E.tracking,"ppid",{value:e}),this.logger.info("Passed PPID to page-level targeting")}catch(t){this.logger.error("Setting up PPID has failed!",t)}}))}setPpid(){return(0,t.sH)(this,void 0,void 0,(function*(){this.instantConfigService.get("icPpid",!1)?(this.logger.info("enabled - awaiting setup"),yield this.generatePPID()):this.logger.info("disabled")}))}};Kt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(S.X)),(0,t.Qj)(1,(0,e.MR)(o.V,o.O,"UserIdentity")),(0,t.Qj)(2,(0,e.WQ)(Q)),(0,t.Qj)(3,(0,e.WQ)(Gt)),(0,t.Qj)(4,(0,e.WQ)($t)),(0,t.Qj)(5,(0,e.WQ)(qt)),(0,t.Qj)(6,(0,e.WQ)(v.U))],Kt);let zt=class{constructor(t,e,i,n){this.window=t,this.logger=e,this.context=i,this.cookieRepository=n,this.createPartnersContext()}createPartnersContext(){this.window.fandomContext&&this.window.fandomContext.partners||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{partners:{}}))}setIsCoppaSubjectInContext(t){this.coppaSubject=t,this.window.fandomContext.partners.directedAtChildren=t,this.window.fandomContext.partners.blockthrough={directedAtChildren:t}}isCoppaSubject(){return void 0===this.coppaSubject?this.resolveCoppaStatus():this.coppaSubject}resolveCoppaStatus(){var t,e;if(!Boolean(null===(e=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===e?void 0:e.directedAtChildren))return this.setIsCoppaSubjectInContext(!1),!1;try{const t="1"!==this.cookieRepository.get("ag");return this.setIsCoppaSubjectInContext(t),t}catch(t){this.logger.error("Error while reading age gate cookie")}}};zt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(a.jf)),(0,t.Qj)(1,(0,e.MR)(o.V,o.O,"CoppaSubject")),(0,t.Qj)(2,(0,e.WQ)(l.i)),(0,t.Qj)(3,(0,e.WQ)(O))],zt);var Yt=r(978);let Jt=class{constructor(t,e,i,n,r){this.platform=e,this.window=i,this.httpClient=n,this.logger=r,this.enabled=!1,this.endpoint=`${t.get()}adeng/api/identity/metrics`}isReportingEnabled(t){const e=t.get("icMonitorTrafficThreshold",{identity:0});return!!(0,Yt.A)()||"object"==typeof(i=e)&&!Array.isArray(i)&&null!==i&&(null==e?void 0:e.identity)>0&&e.identity>=100*Math.random();var i}init(t){var e;this.enabled=this.isReportingEnabled(t),this.logger.info(`Metric reporter enabled: ${this.enabled}`),this.enabled&&("complete"===this.window.document.readyState?this.sendPerformanceMetrics():null===(e=this.window)||void 0===e||e.addEventListener("load",(()=>this.sendPerformanceMetrics())))}sendIdentityEngineState(t){this.enabled&&this.send(t)}sendConsentEvent(t){this.enabled&&this.send("opt"+(t?"in":"out"))}sendPerformanceMetrics(){const t=this.window.performance.getEntriesByType("navigation");if(t.length>0){const e=t[0].domContentLoadedEventEnd,i=t[0].loadEventEnd;this.send("document_content_loaded",Math.round(e>0?e:this.logger.getTimeDelta())),this.send("document_load_time",Math.round(i>0?i:this.logger.getTimeDelta()))}}send(t,e){if(!this.enabled)return;const i=new URL(this.endpoint);i.searchParams.set("app",this.platform.get()),i.searchParams.set("action",t),i.searchParams.set("duration",e?e.toString():Math.round(this.logger.getTimeDelta()).toString()),this.httpClient.get(i.toString(),{mode:"cors"},2e3).catch((()=>{this.logger.error("Failed to send data")}))}};Jt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(u)),(0,t.Qj)(1,(0,e.WQ)(Wt.O)),(0,t.Qj)(2,(0,e.WQ)(a.jf)),(0,t.Qj)(3,(0,e.WQ)(s.Q)),(0,t.Qj)(4,(0,e.MR)(o.V,o.O,"MetricReporterService"))],Jt);let Xt=class{constructor(t){this.storageAdapter=new Vt(t.sessionStorage)}getItem(t){return this.storageAdapter.getItem(t)}setItem(t,e){try{this.storageAdapter.setItem(t,e)}catch(t){}}removeItem(t){return this.storageAdapter.removeItem(t)}};Xt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(a.jf))],Xt);var Zt=r(248);let te=class{constructor(t,e,i,n,r,o,s){this.assetLoader=t,this.consentResolver=e,this.instantConfigService=i,this.coppaSubject=n,this.dataWarehouse=r,this.logger=o,this.metricReporter=s,this.partnerName="liveConnect",this.liveConnectScriptUrl="https://b-code.liadm.com/a-07ev.min.js",this.fallbackQf="0.3",this.live_connect_tracking_events={LIVE_CONNECT_STARTED:"live_connect_started",LIVE_CONNECT_CACHED:"live_connect_cached",LIVE_CONNECT_RESPONDED_UUID:"live_connect_responded_uuid"},this.idConfigMapping=[{id:"unifiedId",name:`${this.partnerName}-unifiedId`},{id:"sha2",name:this.partnerName,params:{qf:"0.3",resolve:"sha2"}},{id:"md5",name:`${this.partnerName}-md5`,params:{qf:"0.3",resolve:"md5"}},{id:"sha1",name:`${this.partnerName}-sha1`,params:{qf:"0.3",resolve:"sha1"}}]}isEnabled(){return this.consentResolver.getConsents()&&this.instantConfigService.get("icLiveConnect")&&this.instantConfigService.get("icLiveConnectCachingStrategy")&&this.instantConfigService.get("icIdentityPartners")&&!this.coppaSubject.isCoppaSubject()}init(){return(0,t.sH)(this,void 0,void 0,(function*(){this.isEnabled()?(this.setupStorage(),this.shouldLoadScript()?(this.logger.info("loading"),this.dataWarehouse.track(f.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_STARTED),this.assetLoader.loadScript(this.liveConnectScriptUrl,"text/javascript",!1).then((()=>{this.logger.info("loaded"),this.resolveAndTrackIds(),this.logEvent("live-connect-requested")}))):(this.dataWarehouse.track(f.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_CACHED),this.logger.info(`already loaded and available in ${this.storageConfig.type}Storage`))):this.logger.info("disabled")}))}resolveAndTrackIds(){var t;if(!window.liQ)return void this.logger.warn("window.liQ not available for tracking");const e=null===(t=this.instantConfigService.get("icLiveConnectQf"))||void 0===t?void 0:t.toString();window.liQ.resolve((t=>{this.trackIds(t)}),(t=>{console.error(t)}),{qf:e||this.fallbackQf,resolve:this.idConfigMapping.map((t=>t.id))})}trackIds(t){this.logger.info("resolve response:",t),Object.keys(t).forEach((e=>{if(!t[e])return;const i=this.getTrackingKeyName(e);if(this.isAvailableInStorage(i))return;"unifiedId"===e&&this.dataWarehouse.track(f.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_RESPONDED_UUID);const n=t[e];this.logger.info(`${e}: ${n}`),n&&(this.storage.setItem(i,n,this.storageConfig.ttl),this.dataWarehouse.track(f.i.identity,{partner_name:i,partner_identity_id:n}))}))}getTrackingKeyName(t){var e;return null===(e=this.idConfigMapping.find((e=>e.id===t)))||void 0===e?void 0:e.name}setupStorage(){this.storageConfig=this.instantConfigService.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=e.kL.resolve(Ft):this.storage=e.kL.resolve(Xt)}shouldLoadScript(){var t;if(!this.storageConfig)return!0;let e=!1;for(const i of this.storageConfig.mandatoryParams){const n=null===(t=this.idConfigMapping.find((t=>t.id===i)))||void 0===t?void 0:t.name;if(!this.isAvailableInStorage(n)){e=!0;break}}return e}isAvailableInStorage(t){return!!this.storage.getItem(t)}logEvent(t){this.metricReporter.send(t)}};te=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(Zt.s)),(0,t.Qj)(1,(0,e.WQ)((0,e.cb)((()=>A)))),(0,t.Qj)(2,(0,e.WQ)((0,e.cb)((()=>Gt)))),(0,t.Qj)(3,(0,e.WQ)(zt)),(0,t.Qj)(4,(0,e.WQ)(S.X)),(0,t.Qj)(5,(0,e.MR)(o.V,o.O,"liveConnect")),(0,t.Qj)(6,(0,e.WQ)(Jt))],te);let ee=class{constructor(t,e,i){this.logger=t,this.contextRepository=e,this.liveConnect=i}createPartnersContext(){this.contextRepository.set(E.partners,"anyclip",{value:{ppid:this.contextRepository.get(E.tracking,"ppid")}})}initializeTargetingPartners(){return(0,t.sH)(this,void 0,void 0,(function*(){}))}initializeTrackingPartners(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Initializing partners"),yield Promise.all([this.liveConnect.init()])}))}};ee=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(o.V,o.O,"Partners")),(0,t.Qj)(1,(0,e.WQ)(Q)),(0,t.Qj)(2,(0,e.WQ)(te))],ee);let ie=class{constructor(t,e,i,n){this.logger=t,this.windowContextRepository=e,this.dataWarehouse=i,this.navigator=n}init(){return(0,t.sH)(this,void 0,void 0,(function*(){var t;if(this.logger.info("FacilitatedTesting init"),null===(t=this.navigator.cookieDeprecationLabel)||void 0===t?void 0:t.getValue){const t=yield this.navigator.cookieDeprecationLabel.getValue();t?(this.logger.info(`Received cookieDeprecationLabel: ${t}`),this.windowContextRepository.set(E.tracking,"chromeLabel",{value:t}),this.dataWarehouse.track(f.i.chromeLabel,t)):this.logger.info("Received empty cookieDeprecationLabel")}else this.logger.info("cookieDeprecationLabel not available")}))}};ie=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(o.V,o.O,"GooglePrivacySandbox:FacilitatedTesting")),(0,t.Qj)(1,(0,e.WQ)(Q)),(0,t.Qj)(2,(0,e.WQ)(S.X)),(0,t.Qj)(3,(0,e.WQ)(a.kW))],ie);let ne=class{constructor(t,e){this.logger=t,this.facilitatedTesting=e}init(){this.logger.info("GooglePrivacySandbox init"),this.facilitatedTesting.init()}};ne=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(o.V,o.O,"GooglePrivacySandbox")),(0,t.Qj)(1,(0,e.WQ)(ie))],ne);let re=class{constructor(t,e,i,n){this.contextRepository=t,this.browser=e,this.coppaSubject=i,this.consentResolver=n}init(){return(0,t.sH)(this,void 0,void 0,(function*(){!this.coppaSubject.isCoppaSubject()&&this.consentResolver.getConsents()&&(this.setAdTargetingGroup(),this.setBrowser())}))}setBrowser(){this.contextRepository.set(E.targeting,"browser",{value:this.browser.getBrowser().split(" ")[0]})}getRandomGroup(){return 5*Math.ceil(Math.random()%20*20)}setAdTargetingGroup(){const t=this.getRandomGroup(),e=Array.from({length:21},((t,e)=>100-5*e)).filter((e=>e>=t&&e>0));this.contextRepository.set(E.targeting,"adGroup",{value:e.toString()})}};re=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(Q)),(0,t.Qj)(1,(0,e.WQ)(Nt.P)),(0,t.Qj)(2,(0,e.WQ)(zt)),(0,t.Qj)(3,(0,e.WQ)(A))],re);let oe=class{constructor(t,e,i){this.partnersService=t,this.adTargetingGroups=e,this.logger=i}initializeTargeting(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up targeting"),yield this.partnersService.initializeTargetingPartners(),yield this.adTargetingGroups.init()}))}};oe=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(ee)),(0,t.Qj)(1,(0,e.WQ)(re)),(0,t.Qj)(2,(0,e.MR)(o.V,o.O,"TargetingService"))],oe);let se=class{constructor(t,e,i,n,r){var o,s,a;this.sentry=t,this.browser=e,this.device=i,this.platform=n,this.geo=r,this.sentry.setTags({browser:this.browser.getBrowser(),device:this.device.getDeviceType(),platform:this.platform.get(),geo_country:null!==(o=this.geo.getCountryCode())&&void 0!==o?o:"",geo_continent:null!==(s=this.geo.getContinentCode())&&void 0!==s?s:"",geo_region:null!==(a=this.geo.getRegionCode())&&void 0!==a?a:""})}};se=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(a.eF)),(0,t.Qj)(1,(0,e.WQ)(Nt.P)),(0,t.Qj)(2,(0,e.WQ)(xt.p)),(0,t.Qj)(3,(0,e.WQ)(Wt.O)),(0,t.Qj)(4,(0,e.WQ)(c.u))],se);class ae{constructor(t){this.options=t,this.tags={},this.errorQueue=[]}get inserted(){return Array.from(document.getElementsByTagName("script")).some((t=>t.src===ae.SENTRY_SCRIPT_CDN_URL))}get shouldLoad(){return Math.random()<this.options.sampleRate&&void 0!==ae.ALLOWED_URLS.find((t=>window.location.hostname.includes(t)))}get loaded(){return void 0!==window.Sentry}get initialized(){return void 0!==this.scope}setTags(t){this.tags=t}captureException(t){var e;if(console.error(`[IE] (${this.options.release} ${this.options.environment}) Error captured:`,t),"development"!==this.options.environment&&this.shouldLoad){if(!this.inserted)return this.errorQueue.push(t),void this.loadSentry();if(!this.loaded)return this.errorQueue.push(t),void this.loadSentry();this.initialized||this.createSentryInstance(),null===(e=this.scope)||void 0===e||e.captureException(t)}}loadSentry(){return void 0===this.loadPromise&&(this.loadPromise=new Promise((t=>{var e;const i=document.createElement("script");i.defer=!0,i.src=ae.SENTRY_SCRIPT_CDN_URL,i.crossOrigin="anonymous",i.integrity=ae.SENTRY_SCRIPT_INTEGRITY,i.onload=()=>{this.createSentryInstance(),this.flushErrorQueue(),t()};const n=document.getElementsByTagName("script")[0];null===(e=null==n?void 0:n.parentNode)||void 0===e||e.append(i)}))),this.loadPromise}createSentryInstance(){if(void 0===window.Sentry)return void console.error("[IE] Sentry failed to load");const{breadcrumbsIntegration:t,BrowserClient:e,dedupeIntegration:i,defaultStackParser:n,httpContextIntegration:r,linkedErrorsIntegration:o,makeFetchTransport:s,Scope:a}=window.Sentry,c=new e(Object.assign(Object.assign({},this.options),{sampleRate:1,transport:s,stackParser:n,integrations:[t(),i(),r(),o()],beforeSend(t,e){const i=e.originalException;return i instanceof Error&&i.message.includes("Cannot inject the dependency")?null:t}}));this.scope=new a,this.scope.setClient(c),this.scope.setTags(Object.assign({url:window.location.href,userAgent:window.navigator.userAgent},this.tags))}flushErrorQueue(){this.errorQueue.forEach((t=>{var e;return null===(e=this.scope)||void 0===e?void 0:e.captureException(t)})),this.errorQueue.length=0}}ae.ALLOWED_URLS=["fandom.com","fanatical.com","futhead.com","gamespot.com","giantbomb.com","metacritic.com","muthead.com","tvguide.com"],ae.SENTRY_SCRIPT_CDN_URL="browser.sentry-cdn.com/8.34.0/bundle.min.js",ae.SENTRY_SCRIPT_INTEGRITY="sha384-gpuLt53EKve0n0F+7BnRYO7f0kud8EOsyUCB24QEF7QYVelpALkhqI5u4Db4ve0o";let ce=class{constructor(t,e){this.window=t,this.logger=e,this.queue=[]}install(){this.logger.info("installing consent queue");const t=this;return this.window.consentCallbackQueue=this,this.window.consentCallback=(e,i,n)=>t.push(e,i,n),this}push(t,e,i){this.logger.warn("dialog not resolved, enqueued:",t),this.queue.push({name:t,callback:e,category:i})}};ce=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(a.jf)),(0,t.Qj)(1,(0,e.MR)(o.V,o.O,"ConsentCallbackQueue"))],ce);var le=r(569);const ue={C0001:"necessary",C0002:"performance",C0003:"functional",C0004:"targeting",C0005:"social"};class de{constructor(t,e){this.container=t;const i=t.OptanonWrapper;t.OptanonWrapper=()=>{e.resolve(),null==i||i()}}available(){return void 0!==this.container.OneTrust}ready(){var t,e;const i=this.container.OneTrust;return void 0!==this.container.OnetrustActiveGroups&&("opt-in"!==(null===(e=null===(t=i.GetDomainData())||void 0===t?void 0:t.ConsentModel)||void 0===e?void 0:e.Name)||i.IsAlertBoxClosed())}resolve(){var t;return null===(t=this.container.OnetrustActiveGroups)||void 0===t?void 0:t.split(",").map((t=>ue[t])).filter((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:!0})),{})}}class he{constructor(t,e){this.optIn=t,this.cookiesManager=e}available(){return void 0!==this.cookiesManager.get("OptanonConsent")}ready(){return!this.optIn||void 0!==this.cookiesManager.get("OptanonAlertBoxClosed")}resolve(){var t;const e=null===(t=decodeURIComponent(this.cookiesManager.get("OptanonConsent")))||void 0===t?void 0:t.match(/groups=([^&]+)/);return e&&e[1]?e[1].toUpperCase().split(",").map((t=>{const e=t.split(":");return"1"===e[1]?ue[e[0]]:void 0})).filter((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:!0})),{}):{}}}const ge={necessary:!0},pe={necessary:!0,performance:!0,functional:!0,targeting:!0,social:!0};let fe=class{constructor(t,e,i,n){this.container=t,this.logger=e,this.geo=i,this.cookiesManager=n,this.queue=t.consentCallbackQueue,this.optIn=!!i&&le.e.includes(this.geo.getCountryCode()),void 0!==this.queue&&this.init()}resolve(){return!!this.wasResolved()||(this.ifAvailableThenResolveIfReady(this.apiConsentResolver)?(this.logger.info("API available, resolved?:",this.categories),this.wasResolved()):!!this.ifAvailableThenResolveIfReady(this.cookieConsentResolver)&&(this.logger.info("Cookies available, resolved?:",this.categories),this.wasResolved()))}wasResolved(){return void 0!==this.categories}init(){this.logger.info("Setting up with opt-in status:",this.optIn),this.apiConsentResolver=new de(this.container,this),this.cookieConsentResolver=new he(this.optIn,this.cookiesManager),this.resolve()||setTimeout((()=>this.resolveWithFallback()),5e3)}resolveWithFallback(){this.resolve()||(this.apiConsentResolver.available()||this.cookieConsentResolver.available()?(this.logger.info("Still waiting for consent resolve with available api:",this.apiConsentResolver.available(),"or cookie:",this.cookieConsentResolver.available()),setTimeout((()=>this.resolveWithFallback),5e3)):(this.categories=this.fallback(),this.logger.info("Unable to resolve consent, fallback to:",this.categories),this.resolveQueue()))}ifAvailableThenResolveIfReady(t){const e=t.available();return e&&t.ready()&&(this.categories=t.resolve(),this.resolveQueue()),e}checkAndRun(t,e,i){return this.logger.info("About to callback:",t,"for:",i,"with:",this.categories),!(void 0!==i&&!this.categories[i]||(e(this.categories),0))}resolveQueue(){this.flushQueue(),this.queue.push=(t,e,i)=>this.checkAndRun(t,e,i),this.container.consentCallback=(t,e,i)=>this.checkAndRun(t,e,i)}flushQueue(){const t=this.queue.queue;this.logger.info("Consent resolved, flushing queue of size:",t.length);for(let e=t.length-1;e>=0;e--){const i=t[e];this.checkAndRun(i.name,i.callback,i.category)&&t.splice(e,1)}}fallback(){return this.optIn?ge:pe}};function ve(t){var e,i;return null===(i=null===(e=null==t?void 0:t.replace("/identity-service/",""))||void 0===e?void 0:e.replace("/index.js",""))||void 0===i?void 0:i.replace(/^v/,"")}fe=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(a.jf)),(0,t.Qj)(1,(0,e.MR)(o.V,o.O,"ConsentCallbackQueueHandler")),(0,t.Qj)(3,(0,e.WQ)(a.AZ))],fe),e.kL.register(a.AZ,{useValue:n}),e.kL.register(a.kk,{useValue:function(){return"randomUUID"in crypto||(crypto.randomUUID=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))),crypto.randomUUID()}}),e.kL.register(a.kW,{useValue:navigator}),e.kL.register(a.jf,{useValue:window}),e.kL.register(a.kW,{useValue:navigator});let me=class{constructor(t,e,i,n,r,o,s,a,c,l,u,d,h,g,p,f,v,m,y){this.geoCookie=t,this.ageGateHandler=e,this.communicationService=i,this.optInService=n,this.hemTrackingService=r,this.trackingContextSetupService=o,this.consentResolver=s,this.instantConfigService=a,this.window=c,this.logger=l,this.ppidProvider=u,this.coppaSubject=d,this.metricReporterService=h,this.partnersService=g,this.googlePrivacySandbox=p,this.targetingService=f,this.dataWarehouse=y}initializeAgeGateHandler(){return(0,t.sH)(this,void 0,void 0,(function*(){return this.ageGateHandler.init(this.communicationService)}))}updateGTMConsent(t){void 0===this.window.dataLayer&&(this.window.dataLayer=[]),this.window.dataLayer.push({event:"user-consent",consent:t.toString()})}initializeTracking(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up tracking"),this.optInService.trackingAllowed=!0,this.hemTrackingService.activateTracking(),yield this.ppidProvider.setPpid(),yield this.partnersService.initializeTrackingPartners(),this.partnersService.createPartnersContext(),this.communicationService.emit(new g.r(p.c.IDENTITY_READY)),this.dataWarehouse.track(f.i.loadTime,"identity_ready"),this.metricReporterService.sendIdentityEngineState("ready"),this.googlePrivacySandbox.init()}))}initializeTargeting(){return(0,t.sH)(this,void 0,void 0,(function*(){yield this.targetingService.initializeTargeting()}))}init(){return(0,t.sH)(this,void 0,void 0,(function*(){yield this.geoCookie.setGeoCookieIfNotExist(),yield this.instantConfigService.init(this.communicationService),this.optInService.init(this.instantConfigService),this.metricReporterService.init(this.instantConfigService),this.metricReporterService.sendIdentityEngineState("init")}))}run(){var e,i;this.logger.info("Starting identity engine",`version: ${ve(null===(i=null===(e=this.window.ads)||void 0===e?void 0:e.version)||void 0===i?void 0:i.identity)}`),this.communicationService.once(p.c.CONSENT_READY,(e=>{this.trackingContextSetupService.setup(),this.dataWarehouse.track(f.i.loadTime,"consent_ready"),this.consentResolver.resolve(e,(()=>(0,t.sH)(this,void 0,void 0,(function*(){this.metricReporterService.sendConsentEvent(!0),this.updateGTMConsent(!0),yield this.initializeAgeGateHandler(),this.coppaSubject.resolveCoppaStatus(),this.initializeTargeting(),yield this.initializeTracking()}))),(()=>{this.metricReporterService.sendConsentEvent(!1),this.updateGTMConsent(!1),this.initializeTargeting(),this.coppaSubject.resolveCoppaStatus(),this.optInService.trackingAllowed=!1,this.loadPhoenixThirdPartyDisabledMode(),this.communicationService.emit(new g.r(p.c.IDENTITY_READY)),this.dataWarehouse.track(f.i.loadTime,"identity_ready"),this.metricReporterService.sendIdentityEngineState("ready"),this.logger.info("Tracking rejected")}))}))}loadPhoenixThirdPartyDisabledMode(){var t;(null===(t=null===window||void 0===window?void 0:window.PhoenixLoader)||void 0===t?void 0:t.triggerEvent)?(this.logger.info("Load third party in disabled mode"),window.PhoenixLoader.triggerEvent("loadThirdPartyDisabled")):this.logger.info("No PhoenixLoader.triggerEvent defined")}};me=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(h)),(0,t.Qj)(1,(0,e.WQ)(C)),(0,t.Qj)(2,(0,e.WQ)(v.U)),(0,t.Qj)(3,(0,e.WQ)(b.E)),(0,t.Qj)(4,(0,e.WQ)(k)),(0,t.Qj)(5,(0,e.WQ)(_)),(0,t.Qj)(6,(0,e.WQ)(A)),(0,t.Qj)(7,(0,e.WQ)(Gt)),(0,t.Qj)(8,(0,e.WQ)(a.jf)),(0,t.Qj)(9,(0,e.MR)(o.V,o.O,"IdentityEngine")),(0,t.Qj)(10,(0,e.WQ)(Kt)),(0,t.Qj)(11,(0,e.WQ)(zt)),(0,t.Qj)(12,(0,e.WQ)(Jt)),(0,t.Qj)(13,(0,e.WQ)(ee)),(0,t.Qj)(14,(0,e.WQ)(ne)),(0,t.Qj)(15,(0,e.WQ)(oe)),(0,t.Qj)(16,(0,e.WQ)(ce)),(0,t.Qj)(17,(0,e.WQ)(fe)),(0,t.Qj)(18,(0,e.WQ)(S.X))],me),function(){(0,t.sH)(this,void 0,void 0,(function*(){var t,i;const n=function(){try{return"US"===e.kL.resolve(c.u).get().country?.01:.1}catch(t){return.01}}(),r=ve(null===(i=null===(t=window.ads)||void 0===t?void 0:t.version)||void 0===i?void 0:i.identity),o=new ae({dsn:"https://3e92e20316cf4539a579d82f4294be77@o4504176096247808.ingest.sentry.io/4505432026447872",release:r,environment:"production",sampleRate:n});try{e.kL.register(a.eF,{useValue:o}),e.kL.resolve(se);const t=e.kL.resolve(me);yield t.init(),t.run()}catch(t){o.captureException(t)}}))}()})()})();
//# sourceMappingURL=index.js.map