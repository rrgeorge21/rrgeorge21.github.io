function quickmod(func,url,in_post,topic_id){var func_allow=['lock','unlock','resync','delete_topic','move','split','merge_topics','fork','make_normal','make_sticky','make_announce','make_global','topic_logs','restore_topic'];var isset=false;var topic_id_list=[];var refresh=false;if($.inArray(func,func_allow)<0){hs_popup('illegal action');return;}
if(in_post){$("input:checkbox[name='topic_id_list[]']:checked").each(function(){topic_id_list.push($(this).val());isset=true;});}else{}
if(func=='topic_logs'){if(topic_id_list.length>1){hs_pop_wrong('please choose just one topic to view log or empty your choice to view forum log');return;}
if(topic_id_list.length==1){url=url+'&t='+topic_id_list[0]+'&quickmod=1&action=topic_logs';}else{url=url+'&i=mcp_logs&mode=forum_logs';}
window.location.href=url;return;}
if(!isset){hs_popup('You must select at least one topic to perform this action.');return;}
if(func=='merge_topics'){$.each(topic_id_list,function(index,value){url+='&topic_id_list['+index+']='+value;});window.location.href=url;return;}
$.ajax({type:"POST",url:url,data:{topic_id_list:topic_id_list},dataType:'json',success:function(msg){switch(func){case 'lock':case 'unlock':case 'resync':case 'restore_topic':if(msg.MESSAGE_TEXT&&msg.REFRESH_DATA){hs_popup({message:msg.MESSAGE_TEXT,refresh:msg.REFRESH_DATA.time,type:'success',});}else{hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}
break;case 'delete_topic':delete_topic_func(msg,topic_id_list);break;case 'move':move_topic_func(msg,topic_id_list);break;case 'fork':fork_topic_func(msg,topic_id_list);break;case 'make_normal':case 'make_sticky':case 'make_announce':case 'make_global':change_topic_type_func(msg,topic_id_list);break;}},error:function(){hs_popup({message:'something wrong with server',refresh:false,type:'error',});},});}
function m_quickmod_post(func,url,in_post,post_id){var isset=false;var p='';var refresh=false;if(in_post){$("input:checkbox[name='post_id_list[]']:checked").each(function(){p=$(this).val();});}
if(post_id){p=post_id;}
$.ajax({type:"POST",url:url,data:{action:func},success:function(msg){switch(func){case 'lock_post':case 'unlock_post':if(msg.MESSAGE_TEXT&&msg.REFRESH_DATA){hs_popup({message:msg.MESSAGE_TEXT,refresh:msg.REFRESH_DATA.time,type:'success',});}else{hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}
break;case 'make_global':return;break;}},error:function(){hs_popup({message:'something wrong with server',refresh:false,type:'error',});},});}
function delete_topic_func(msg,topic_id_list){reset_global_confirm();if(msg.S_USER_WARNING==true){hs_popup(msg.MESSAGE_TEXT);return;}
var global_confirm=$('#global_confirm');global_confirm.find('.notice-message').addClass('notice-message2');var addhtml='<div name="disapprove-div" class="disapprove-div l-h2">\n';if(msg.extra_info){if(!msg.extra_info.S_SHADOW_TOPICS){if(!msg.extra_info.S_SOFTDELETED&&msg.extra_info.S_ALLOWED_DELETE&&msg.extra_info.S_ALLOWED_SOFTDELETE){addhtml+='\t\t\t\t<div class="label-l"><label class="">'+L_DELETE_PERMANENTLY+L_COLON+'</label></div>\n'+
'\t\t\t\t<div class="label-r" style="text-align: left;"><input id="delete_permanent" name="delete_permanent" type="checkbox" style="margin-right: 10px;"/>'+msg.extra_info.DELETE_TOPIC_PERMANENTLY_EXPLAIN+'</div>\n'}}}
addhtml+='\t\t\t\t<div class="label-l"><label class="l-h2" for="delete_reason">'+L_DELETE_REASON+L_COLON+'</label></div>\n'+
'\t\t\t\t<div class="label-r"><textarea class="inputbox" name="delete_reason" id="delete_reason" rows="2" cols="40"></textarea></div>\n'+
'\t\t\t\t<div class="label-l m-t0"><label></label></div>\n'+
'\t\t\t\t<div class="label-r m-t0"  style="text-align: left;"><label>'+L_DELETE_REASON_EXPLAIN+'</label></div>\n'+
'\t\t<div class="padding"></div></div>';global_confirm.find('.add_content').append(addhtml);$.each(msg,function(key,val){if(key=='u_action'){global_confirm.find('.hide').append('<input type="text" name="'+key+'" value="'+val+'">');}});hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var delete_permanent=global_confirm.find('#delete_permanent').is(':checked');var delete_reason=$("textarea[name='delete_reason']").val();if(delete_permanent==true){delete_permanent=1;}else{delete_permanent=0;}
if(msg.extra_info.S_SOFTDELETED){msg.extra_info.S_SOFTDELETED=1;}else{msg.extra_info.S_SOFTDELETED=0}
$.ajax({type:"POST",url:u_action,data:{topic_id_list:topic_id_list,confirm:'Yes',delete_permanent:delete_permanent,delete_reason:delete_reason,softdeleted:msg.extra_info.S_SOFTDELETED,},dataType:'json',success:function(msg){if(msg.REFRESH_DATA.time){hs_popup({message:msg.MESSAGE_TEXT,refresh:msg.REFRESH_DATA.time,type:'success',});}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}
function restore_topic_func(msg,topic_id_list){hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var delete_permanent=global_confirm.find('#delete_permanent').is(':checked');var delete_reason=$("textarea[name='delete_reason']").val();if(delete_permanent==true){delete_permanent=1;}else{delete_permanent=0;}
if(msg.extra_info.S_SOFTDELETED){msg.extra_info.S_SOFTDELETED=1;}else{msg.extra_info.S_SOFTDELETED=0}
$.ajax({type:"POST",url:u_action,data:{topic_id_list:topic_id_list,confirm:'Yes',delete_permanent:delete_permanent,delete_reason:delete_reason,softdeleted:msg.extra_info.S_SOFTDELETED,},dataType:'json',success:function(msg){if(msg.REFRESH_DATA.time){hs_popup({message:msg.MESSAGE_TEXT,refresh:msg.REFRESH_DATA.time,type:'success',});}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}
function move_topic_func(msg,topic_id_list){reset_global_confirm();var global_confirm=$('#global_confirm');global_confirm.find('.notice-message').addClass('notice-message3');if(msg.extra_info){var addhtml='<div class="flex fw-w mt-9 mb-13" >\t\t\t\t<div class="md w-30p ta-r gray-4 dark-gray-7">'+L_SELECT_DESTINATION_FORUM+L_COLON+'</div>\n'+
'\t\t\t\t<div class="w-60p ta-l pl-20"><select name="to_forum_id" class="w-90p lg lh-36 pl-0">'+msg.extra_info.S_FORUM_SELECT+'</select>';if(msg.extra_info.S_CAN_LEAVE_SHADOW)
addhtml+='<div class="md gray-4 dark-gray-7 mt-9 w-90p"> <input type="checkbox" class="mr-10 mb-2" name="move_leave_shadow" id="move_leave_shadow" /><span>'+L_LEAVE_SHADOW+'</span></div>';if(msg.extra_info.S_CAN_LOCK_TOPIC)
addhtml+='<div class="md gray-4 dark-gray-7 w-90p mt-1"> <input type="checkbox" class="mr-10 mb-2" name="move_lock_topics" id="move_lock_topics" /><span>'+L_LOCK_TOPIC+'</span></div>';addhtml+='</div></div>';}else{hs_pop_wrong();}
global_confirm.find('.add_content').append(addhtml);$.each(msg,function(key,val){if(key=='u_action'){global_confirm.find('.hide').append('<input type="text" name="'+key+'" value="'+val+'">');}});hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var move_leave_shadow=global_confirm.find('#move_leave_shadow').is(':checked');var move_lock_topics=global_confirm.find('#move_lock_topics').is(':checked');var to_forum_id=$("select[name='to_forum_id']").val();if(move_leave_shadow==true){move_leave_shadow=1;}else{move_leave_shadow=0}
if(move_lock_topics==true){move_lock_topics=1;}else{move_lock_topics=0}
$.ajax({type:"POST",url:u_action,data:{topic_id_list:topic_id_list,confirm:'Yes',move_leave_shadow:move_leave_shadow,move_lock_topics:move_lock_topics,to_forum_id:to_forum_id,},dataType:'json',success:function(msg){if(msg.REFRESH_DATA.time){hs_popup({message:msg.MESSAGE_TEXT,refresh:msg.REFRESH_DATA.time,type:'success',});}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}
function fork_topic_func(msg,topic_id_list){reset_global_confirm();var global_confirm=$('#global_confirm');global_confirm.find('.notice-message').addClass('notice-message3');if(msg.extra_info){var addhtml='<div class="disapprove-div" style="display:unset">'+
'<div class="flex fw-w">\t\t\t\t<div class="md w-30p ta-r gray-4" >'+L_SELECT_DESTINATION_FORUM+L_COLON+'</div>\n'+
'\t\t\t\t<div class="w-60p ta-l pl-20"><select name="to_forum_id"  class="mr-10 w-90p">'+msg.extra_info.S_FORUM_SELECT+'</select></div>\n'+
'</div></div>';}else{hs_pop_wrong();}
global_confirm.find('.add_content').append(addhtml);$.each(msg,function(key,val){if(key=='u_action'){global_confirm.find('.hide').append('<input type="text" name="'+key+'" value="'+val+'">');}});hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var move_leave_shadow=global_confirm.find('#move_leave_shadow').is(':checked');var move_lock_topics=global_confirm.find('#move_lock_topics').is(':checked');var to_forum_id=$("select[name='to_forum_id']").val();$.ajax({type:"POST",url:u_action,data:{topic_id_list:topic_id_list,confirm:'Yes',move_leave_shadow:move_leave_shadow,move_lock_topics:move_lock_topics,to_forum_id:to_forum_id,},dataType:'json',success:function(msg){if(msg.REFRESH_DATA.time){hs_popup({message:msg.MESSAGE_TEXT,refresh:msg.REFRESH_DATA.time,type:'success',});}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}
function change_topic_type_func(msg,topic_id_list){reset_global_confirm();var global_confirm=$('#global_confirm');$.each(msg,function(key,val){if(key=='u_action'){global_confirm.find('.hide').append('<input type="text" name="'+key+'" value="'+val+'">');}});hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();console.log(u_action);$.ajax({type:"POST",url:u_action,data:{topic_id_list:topic_id_list,confirm:'Yes',},dataType:'json',success:function(msg){if(msg.REFRESH_DATA.time){hs_popup({message:msg.MESSAGE_TEXT,refresh:msg.REFRESH_DATA.time,type:'success',});}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}
function doOpenPostWin(url,args,topic_id_list,name,windowParam){var _form=$("<form></form>",{'id':'mcp','method':'post','action':url,'target':name,}).appendTo($("body"));for(var i in args){_form.append($("<input>",{'type':'hidden','name':args[i].name,'value':args[i].value}));}
for(var i in topic_id_list){_form.append('<input type="text" name="topic_id_list[]" value="'+topic_id_list[i]+'">');}
_form.bind('submit',function(){window.open("about:blank",name,windowParam);});_form.trigger("submit");_form.remove();}
function delete_post_func(msg,post_id_list){reset_global_confirm();var global_confirm=$('#global_confirm');global_confirm.find('.notice-message').addClass('notice-message2');var addhtml='<div name="disapprove-div" class="disapprove-div l-h2">\n';if(msg.extra_info){if(!msg.extra_info.S_SHADOW_TOPICS){if(!msg.extra_info.S_SOFTDELETED&&msg.extra_info.S_ALLOWED_DELETE&&msg.extra_info.S_ALLOWED_SOFTDELETE){addhtml+='\t\t\t\t<div class="label-l"><label class="">'+L_DELETE_PERMANENTLY+L_COLON+'</label></div>\n'+
'\t\t\t\t<div class="label-r" style="text-align: left;"><input id="delete_permanent" name="delete_permanent" type="checkbox" style="margin-right: 10px;"/>'+msg.extra_info.DELETE_POST_PERMANENTLY_EXPLAIN+'</div>\n'}}}
addhtml+='\t\t\t\t<div class="label-l"><label class="l-h2" for="delete_reason">'+L_DELETE_REASON+L_COLON+'</label></div>\n'+
'\t\t\t\t<div class="label-r"><textarea class="inputbox" name="delete_reason" id="delete_reason" rows="2" cols="40"></textarea></div>\n'+
'\t\t\t\t<div class="label-l m-t0"><label></label></div>\n'+
'\t\t\t\t<div class="label-r m-t0"  style="text-align: left;"><label>'+L_DELETE_REASON_EXPLAIN+'</label></div>\n'+
'\t\t<div class="padding"></div></div>';global_confirm.find('.add_content').append(addhtml);$.each(msg,function(key,val){if(key=='u_action'){global_confirm.find('.hide').append('<input type="text" name="'+key+'" value="'+val+'">');}});hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var delete_permanent=global_confirm.find('#delete_permanent').is(':checked');var delete_reason=$("textarea[name='delete_reason']").val();if(delete_permanent==true){delete_permanent=1;}else{delete_permanent=0;}
if(msg.extra_info.S_SOFTDELETED){msg.extra_info.S_SOFTDELETED=1;}else{msg.extra_info.S_SOFTDELETED=0}
$.ajax({type:"POST",url:u_action,data:{post_id_list:post_id_list,confirm:'Yes',delete_permanent:delete_permanent,delete_reason:delete_reason,softdeleted:msg.extra_info.S_SOFTDELETED,},dataType:'json',success:function(msg){if(msg.REFRESH_DATA.time){hs_popup({message:msg.MESSAGE_TEXT,refresh:msg.REFRESH_DATA.time,type:'success',});}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}
$(document).ready(function(){SetupAllModerationActions();});function SetupAllModerationActions(){SetupActionApprove();SetupActionDelete();SetupActionDeletePost();SetupActionReport();}
function SetupActionDeletePost(){$('.actiondeletepost').unbind('click');$('.actiondeletepost').on('click',function(e){reset_global_confirm();var isset=false;var post_id_list=[];if($(this).hasClass('in_post')){post_id_list.push($(this).parent().find("input[name='post_id_list[]']").val());isset=true;}else{$("input:checkbox[name='post_id_list[]']:checked").each(function(e){post_id_list.push($(this).val());isset=true;});}
if(isset==false){hs_popup('You must select at least one post to perform this action.');return;}else{var action=$(this).attr("name").toLowerCase();$.ajax({type:"POST",url:BOARD_URL+"mcpout.php?action=delete_post",data:{post_id_list:post_id_list,action:action},dataType:'json',success:function(msg){if(msg.S_USER_WARNING==true){hs_popup(msg.MESSAGE_TEXT);return;}
delete_post_func(msg,post_id_list)},error:function(){hs_popup({message:'something wrong with server',refresh:false,type:'error',});},});}});}
function SetupActionApprove(){var global_confirm=$('#global_confirm');$('.actionapprove').unbind('click');$('.actionapprove').on('click',function(e){reset_global_confirm();var isset=false;var post_id_list=[];if($(this).hasClass('in_post')){post_id_list.push($(this).parent().find("input[name='post_id_list[]']").val());isset=true;}else{$("input:checkbox[name='post_id_list[]']:checked").each(function(e){post_id_list.push($(this).val());isset=true;});}
if(isset==false){hs_popup('You must select at least one post to perform this action.');return;}else{var action=$(this).attr("name").toLowerCase();if(action=='approve'){$.ajax({type:"POST",url:BOARD_URL+"mcpout.php?i=mcp_queue&action="+action+"&custom=custom",data:{post_id_list:post_id_list},dataType:'json',success:function(msg){if(msg.MESSAGE_TEXT){$.each(msg,function(key,val){if(key=='post_id_list'){$.each(val,function(k,v){global_confirm.find('.hide').append('<input type="text" name="post_id_list[]" value="'+
v+'">');});}else{global_confirm.find('.hide').append('<input type="text" name="'+key+
'" value="'+val+'">');}});var addhtml='<input type="checkbox" name="notify_poster" checked="checked">Notify poster about approval?';global_confirm.find('.notify_box').append(addhtml);hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var notify_poster=global_confirm.find('input[name="notify_poster"]').is(':checked');$.ajax({type:"POST",url:u_action,data:{post_id_list:post_id_list,confirm:'Yes',notify_poster:notify_poster,},dataType:'json',success:function(msg){if(!msg.S_USER_NOTICE&&!msg.S_USER_WARNING){hs_popup({message:msg.MESSAGE_TEXT,refresh:true,type:'success',});}else{if(msg.S_USER_NOTICE){var type='notice';}
if(msg.S_USER_WARNING){var type='waring';}
hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:type,});}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}else{hs_popup({message:'something wrong with server',refresh:false,type:'error',});}},error:function(){hs_popup({message:'something wrong with server',refresh:false,type:'error',});},});}else{global_confirm.find('.notice-message').addClass('notice-message2');$.ajax({type:"POST",url:BOARD_URL+"mcp.php?i=mcp_queue&action="+action+"&custom=custom",data:{post_id_list:post_id_list},dataType:'json',success:function(msg){if(msg.MESSAGE_TEXT){$.each(msg,function(key,val){if(key=='post_id_list'){$.each(val,function(k,v){global_confirm.find('.hide').append('<input type="text" name="post_id_list[]" value="'+
v+'">');});}else{global_confirm.find('.hide').append('<input type="text" name="'+key+
'" value="'+val+'">');}});global_confirm.find('.hide').append('<input type="text" name="reason_id" value="1">');var addhtml='<div name="disapprove-div" class="disapprove-div l-h2">\n'+
'\t\t\t\t<div class="label-l"><label class="">Reason for disapproval:</label></div>\n'+
'\t\t\t\t<div  class="select-box label-r" onclick="selectoption()">\n'+
'       <div class="select-tab"  ><span class="select " >The message contains links to illegal or pirated software.</span> <i class="icon fa-sort-down fa-fw "></i> '+
'<div class="select-option" " >'+
'<div name="select1" onclick="selectedoption(\'1\')" >The message contains links to illegal or pirated software.</div>'+
'<div name="select2" onclick="selectedoption(\'2\')" >The reported message has the only purpose to advertise for a website or another product.</div>'+
'<div name="select3" onclick="selectedoption(\'3\')" >The reported message is off topic.</div>'+
'<div name="select4" onclick="selectedoption(\'4\')" >The reported message does not fit into any other category, please use the further information field.</div>'+
'</div>'+
'\t\t\t\t</div></div>\n'+
'\t\t\t\t<div class="label-l"><label class="l-h2" for="reason">Further information:</label></div>\n'+
'\t\t\t\t<div class="label-r"><textarea class="inputbox" name="reason" id="reason" rows="2" cols="40"></textarea></div>\n'+
'\t\t\n'+
'\t\t\t\t<div class="label-l m-t0"><label></label></div>\n'+
'\t\t'+
'<div class="padding"></div>'+
'</div>';var notify='<input type="checkbox" name="notify_poster" checked="checked"> Notify poster about disapproval?';global_confirm.find('.add_content').append(addhtml);global_confirm.find('.notify_box').append(notify);global_confirm.find('.bottom').addClass('mt-10');hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var notify_poster=global_confirm.find('.notify_poster').is(':checked');var reason_id=global_confirm.find('.hide').find("input[name='reason_id']").val();var reason=$("textarea[name='reason']").val();if(reason_id<1||reason_id>4){hs_popup({message:msg.MESSAGE_TEXT,refresh:true,type:'error',});}
$.ajax({type:"POST",url:u_action,data:{post_id_list:post_id_list,confirm:'Yes',notify_poster:notify_poster,reason_id:reason_id,reason:reason,},dataType:'json',success:function(msg){if(!msg.S_USER_NOTICE&&!msg.S_USER_WARNING){hs_popup({message:msg.MESSAGE_TEXT,refresh:true,type:'success',});}else{if(msg.S_USER_NOTICE){var type='notice';}
if(msg.S_USER_WARNING){var type='waring';}
hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:type,});}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}else{hs_popup({message:'something wrong with server',refresh:false,type:'error',});}},error:function(){hs_popup({message:'something wrong with server',refresh:false,type:'error',});},});}}});}
function SetupActionDelete(){var global_confirm=$('#global_confirm');var S_MCPOUT_DELETED_ACTION=BOARD_URL+"discussion/deleted";$('.actiondelete').unbind('click');$('.actiondelete').on('click',function(e){reset_global_confirm();var isset=false;var post_id_list=[];var topic_id_list=[];if($(this).hasClass('in_post')){post_id_list.push($(this).parent().find("input[name='post_id_list[]']").val());isset=true;}else{$("input:checkbox[name='post_id_list[]']:checked").each(function(e){post_id_list.push($(this).val());isset=true;});$("input:checkbox[name='topic_id_list[]']:checked").each(function(e){topic_id_list.push($(this).val());isset=true;});}
if($(this).hasClass('is_post')){S_MCPOUT_DELETED_ACTION+='?mode=deleted_posts';}
if(isset==false){hs_popup('You must select at least one post to perform this action.');return;}else{var action=$(this).attr("name").toLowerCase();$.ajax({type:"POST",url:S_MCPOUT_DELETED_ACTION,data:{post_id_list:post_id_list,topic_id_list:topic_id_list,action:action},dataType:'json',success:function(msg){if(action=='restore'){if(msg.S_USER_NOTICE){var type='notice';}
if(msg.S_USER_WARNING){var type='waring';}
var refresh=false;if(msg.REFRESH_DATA!=null){refresh=msg.REFRESH_DATA.time}
hs_popup({message:msg.MESSAGE_TEXT,refresh:3,type:type,});return;}
if(msg.MESSAGE_TEXT){$.each(msg,function(key,val){if(key=='post_id_list'||key=='topic_id_list'){}else{global_confirm.find('.hide').append('<input type="text" name="'+key+
'" value="'+val+'">');}});global_confirm.find('.notice-message').addClass('notice-message3');var addhtml='<label for="delete_reason">Reason for deletion:</label><br/><textarea class="inputbox" style="width:90%" name="delete_reason" id="delete_reason" rows="2" cols="40"></textarea><br><span>The specified reason for deletion will be visible to moderators.</span>';global_confirm.find('.add_content').append(addhtml);hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var delete_reason=global_confirm.find('input[name="delete_reason"]').val();console.log(post_id_list);$.ajax({type:"POST",url:u_action,data:{post_id_list:post_id_list,topic_id_list:topic_id_list,delete_reason:delete_reason,action:action,confirm:'Yes',},dataType:'json',success:function(msg){if(msg.S_USER_NOTICE){var type='notice';}
if(msg.S_USER_WARNING){var type='waring';}
var refresh=false;if(msg.REFRESH_DATA!=null){refresh=msg.REFRESH_DATA.time}
hs_popup({message:msg.MESSAGE_TEXT,refresh:refresh,type:type,});},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}else{hs_popup({message:'something wrong with server',refresh:false,type:'error',});}},error:function(){hs_popup({message:'something wrong with server',refresh:false,type:'error',});},});}});}
function SetupActionReport(){var action=false;var in_post=false;var return_mcp=false;$('.actionreport').unbind('click');$('.actionreport').on('click',function(e){reset_global_confirm();var isset=false;var report_id_list=[];var U_MCPOUT_AJAX_URL=BOARD_URL;in_post=$(this).hasClass('in_post');return_mcp=$(this).hasClass('return_mcp');if(in_post){report_id_list.push($(this).parent().find("input[name='report_id_list[]']").val());isset=true;}else{$("input:checkbox[name='report_id_list[]']:checked").each(function(e){report_id_list.push($(this).val());isset=true;});}
if(isset==false){hs_popup('You must select at least one post to perform this action.');return;}else{action=$(this).hasClass('button2');if($(this).hasClass('is_pm_report')){U_MCPOUT_AJAX_URL+='messages/reports';}else{U_MCPOUT_AJAX_URL+='mcpout.php?i=mcp_reports&mode=reports';}
var actionreport;if(action){actionreport='delete'}else{actionreport='close'}
$.ajax({type:"POST",url:U_MCPOUT_AJAX_URL,data:{report_id_list:report_id_list,action:actionreport,},dataType:'json',success:function(msg){if(msg.CODE==1){if(return_mcp){history.go(-1);return;}
if(in_post){$('#report_'+report_id_list[0]).css('display','none');return;}
window.location.reload(true);return;}
var message='Something wrong with server';if(msg.MESSAGE_TEXT){message=msg.MESSAGE_TEXT}
hs_popup({message:'',refresh:false,type:'error',});},error:function(msg){var message='Something wrong with server';if(msg.responseText){message=JSON.parse(msg.responseText).MESSAGE_TEXT}
hs_popup({message:message,refresh:false,type:'error',});},});}});};function selectoption(){var options=$("div[name='disapprove-div']").find('.select-option');if(options.css('display')=='none'){options.css('display','block');}else{options.css('display','none');}}
function selectedoption(name){var id=name;var name='select'+id;var option=$("div[name='disapprove-div']").find('[name='+name+']');var options=$("div[name='disapprove-div']").find('.select-tab').find('span');options.html(option.html());var reason_id=$('#global_confirm').find('.hide').find("input[name='reason_id']");reason_id.val(id);}
function change_checkbox_status(target,split,merge){var status=($(target).find('input').is(':checked'))?true:false;var show_moderate=false;var html='';if(status==true){$(target).find('span').html('Select Post to Moderate');$(target).find('input').attr("checked",false);$(target).find('input').removeClass("addmoderate");}else{$(target).find('span').html('Unselect');$(target).find('input').prop("checked",true);$(target).find('input').addClass("addmoderate");}
change_color($(target).find('input'),false);$(target).parents('.dropdown').css('display','none').parents('.dropdown-container').removeClass('dropdown-visible').removeClass('visible');$("input:checkbox[name='post_id_list[]']:checked").each(function(){show_moderate=true;});if(show_moderate&&($('li.trigger-select-post-moderate').length<=0)){if(merge!=''){html+='<li class="trigger-select-post-moderate changecolor" ><a href="javascript:void(0)" onclick="quickmod_post(\'merge\',\''+merge+'\',true)">Move Selected Posts</a></li>';}
if(split!=''){html+='<li class="trigger-select-post-moderate changecolor"><a href="javascript:void(0)" onclick="quickmod_post(\'split_all\',\''+split+'\',true)">Split Selected Posts</a></li>';html+='<li class="trigger-select-post-moderate changecolor"><a href="javascript:void(0)" onclick="quickmod_post(\'split_beyond\',\''+split+'\',true)">Split topic from selected post onwards</a></li>';}
html+='<li class="trigger-select-post-moderate changecolor"><a href="javascript:void(0)" onclick="unselect_post()">Unselect All</a></li>'
$("ul.moderate-tool").append(html);}
if(!show_moderate&&($('li.trigger-select-post-moderate').length>0)){$("li").remove('.trigger-select-post-moderate');}}
function unselect_post(){$("li").remove('.trigger-select-post-moderate');var trigger=$('.trigger-select-post');trigger.find('span').html('Select Post to Moderate');trigger.find('input').attr("checked",false);trigger.find('input').removeClass("addmoderate");$('.change_color').removeClass('changecolor');}
function quickmod_post(action,url){var post_id_list=[];var isset=false;$("input:checkbox[name='post_id_list[]']:checked").each(function(e){post_id_list.push($(this).val());isset=true;});if(isset==false){hs_popup('You must select at least one post to perform this action.');return;}else{if(action!='merge'){split_posts(url,post_id_list,action);}else{merge_posts(url,post_id_list,action);}}}
function split_posts(url,post_id_list,action){reset_global_confirm();$.ajax({type:"POST",url:url,data:{split:action},dataType:'json',success:function(msg){var global_confirm=$('#global_confirm');global_confirm.find('.notice-message').addClass('notice-message3');if(msg.S_FORUM_SELECT&&!msg.S_USER_WARNING){var addhtml='<div class="flex fw-w mt-9 mb-13 lh-36" >'+
'   <div class="md w-30p ta-r gray-4 dark-gray-7">Split To'+L_COLON+'</div>\n'+
'   <div class="w-60p ta-l pl-20"><select name="to_forum_id" class="w-90p lg lh-36 pl-0">'+msg.S_FORUM_SELECT+'</select></div>';addhtml+='   <div class="md w-30p ta-r gray-4 dark-gray-7 mt-10">'+msg.L_SPLIT_SUBJECT+L_COLON+'</div>\n'+
'   <div class="w-60p ta-l pl-20 mt-10"><input type="text" class=" lg lh-36 pl-0 dark-gray-0" name="subject" style="padding-left:15px;width: 84%;" id="subject" size="40" maxlength="120" tabindex="2" value="'+msg.SPLIT_SUBJECT+'" title=""  /></div>'+
'</div>';global_confirm.find('.add_content').append(addhtml);hs_confirm({message:msg.MESSAGE_TEXT,callback:function(){var u_action=global_confirm.find('input[name="u_action"]').val();var to_forum_id=$("select[name='to_forum_id']").val();var subject=$("input[name='subject']").val();$.ajax({type:"POST",url:url,data:{post_id_list:post_id_list,confirm:'Yes',subject:subject,to_forum_id:to_forum_id,action:action,},dataType:'json',success:function(msg){if(msg.REFRESH_DATA.time){hs_popup({message:msg.MESSAGE_TEXT,type:'success',});if(msg.REDIRECT){setTimeout(function()
{window.location.href=msg.REDIRECT;},3000);}}},error:function(msg){hs_popup({message:msg.MESSAGE_TEXT,refresh:false,type:'error',});}});}});}else{hs_pop_wrong();}},error:function(){hs_popup({message:'something wrong with server',refresh:false,type:'error',});},});}
function merge_posts(url,post_id_list,action){$.each(post_id_list,function(index,value){url+='&post_id_list['+index+']='+value;});window.location.href=url;}
function m_chgposter(url){reset_global_confirm();$('#global_confirm').find('.icon_pop.notice').remove();hs_confirm({message:'<div>Change Poster to...</div><div style="margin-top:10px; position: relative; display: inline-block; width: 264px;"><input style="width: 264px;" id="chgposter_name" name="username" class="inputbox" type="text" onpaste="chgposter_name()" onchange="chgposter_name()" onkeyup="chgposter_name()" onclick="set_chg_return_flag()" value=""  autocomplete="off" placeholder="Enter username" "/>   '+
'<div class="chgposter_name_append" style="position: absolute;  z-index: 100; background-color: white; font-size: 17px; line-height: 28px; box-shadow: #b4b4b4 0px 1px 3px;" > '+
'</div></div>',title:'Change poster',yes:'Change',no:'Cancel',callback:function(){var username=$('#chgposter_name').val();$.ajax({type:"POST",url:url,data:{username:username,action:'chgposter',},dataType:'json',success:function(msg){if(msg.STATUS){hs_popup({message:msg.MESSAGE_TEXT,type:'success',});setTimeout(function()
{window.location.reload(true);},3000);}else{if(msg.MESSAGE_TEXT){hs_pop_wrong(msg.MESSAGE_TEXT);}else{hs_pop_wrong();}}},error:function(msg){if(msg.responseText!=null){hs_pop_wrong(jQuery.parseJSON(msg.responseText).MESSAGE_TEXT);}else{hs_pop_wrong();}}});}});}
var m_anim=0;var counter=0;var chg_return_flag=true;function chgposter_name(){if(chg_return_flag){$(".chgposter_name_append").show();}
var val=$("#chgposter_name").val();var chgposter_name_id=$("#chgposter_name");var chgposter_name_append=$(".chgposter_name_append");counter=0;if(m_anim)
{cancelAnimationFrame(m_anim);}
(function timer(){m_anim=requestAnimFrame(timer);counter+=1;if(counter>60)
{counter=0;cancelAnimationFrame(m_anim);$.ajax({url:UA_AJAX_MENTION_URL,type:'POST',dataType:"json",data:{q:val},beforeSend:function(){chgposter_name_append.empty();}}).done(function(data){if(!data.length)
{return;}
for(var i=0;i<data.length;i++){chgposter_name_append.append('<div style="max-width:100%;padding: 10px;overflow: hidden; white-space: nowrap;text-overflow: ellipsis" >'+
'<div style="display:flex;cursor:pointer;" onclick="fill_in_chgposter_name(this)"><i class="avatar-bg"  style="height: 28px; width: 28px;background-image:url('+data[i].avatar+')" alt=""></i><div class="chgposter_name_block" style="margin-left: 10px;margin-right:20px" data-cleanname="'+data[i].clean+'">'+data[i].name+'</div></div></div>');}}).fail(function(error){console.log(error);}).always(function(){});}})();};function fill_in_chgposter_name(t){;chg_return_flag=true;console.log('fill_in_chgposter_name****');console.log(chg_return_flag);$('#chgposter_name').val($(t).find('.chgposter_name_block').html());$(".chgposter_name_append").empty();$(".chgposter_name_append").hide();}
function set_chg_return_flag(){chg_return_flag=false;}
function m_post_info(url){reset_global_confirm();$.ajax({type:"POST",url:url,data:{m_info:'1',},dataType:'json',success:function(msg){if(msg.STATUS){$('#global_confirm .notice-m-t24').empty();$('#global_confirm .yes.close.button.vip_ads_specialbotton').remove();$('#global_confirm .close.button.vip_ads_specialbotton').html('Ok');if(msg.IP_INFO!=false){$('#global_confirm .notice-title .notice-title-content').html(msg.IP_INFO)}
$('#global_confirm .notice-m-t24').attr('font-size','17px');var html='';if(msg.INFO.length>0){html+='<div style="padding:20px;font-size:18px" ><div class="display-flex" style="display:flex; justify-content: space-between;" ><div>'+msg.OTHER_USERS+'</div><div style="min-width:10%;max-width: 10%; text-align: left;" >'+L_POSTS+'</div></div>';$.each(msg.INFO,function(index,value){html+='<div class="display-flex" style="display:flex; justify-content: space-between;margin-top:5px;font-size:14px;" > <div><a href="'+value.U_PROFILE+'">'+value.USERNAME+'</a></div><div  style="min-width:10%;max-width: 10%; text-align: left;">'+value.NUM_POSTS+'</div> </div>';});html+='</div>';}else{html+='<div>No Other users posting from this IP</div>';}
$('#global_confirm .notice-m-t24').append(html);hs_confirm({callback:function(){}});}else{hs_pop_wrong();}},error:function(msg){hs_pop_wrong();}});}