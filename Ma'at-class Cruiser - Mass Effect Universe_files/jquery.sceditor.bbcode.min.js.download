!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){var o;void 0===(o=function(e){"use strict";var t=n(1),o=n(2),r=n(3),i=n(6),l=n(7);t.sceditor=o,o.commands=n(9),o.defaultOptions=n(10),o.RangeHelper=n(4),o.dom=n(5),o.ie=i.ie,o.ios=i.ios,o.isWysiwygSupported=i.isWysiwygSupported,o.regexEscape=l.regex,o.escapeEntities=l.entities,o.escapeUriScheme=l.uriScheme,o.PluginManager=r,o.plugins=r.plugins,t.fn.sceditor=function(e){var n,r,l=[];if((e=e||{}).runWithoutWysiwygSupport||i.isWysiwygSupported)return this.each(function(){n=this.jquery?this:t(this),r=n.data("sceditor"),n.parents(".sceditor-container").length>0||("state"===e?l.push(!!r):"instance"===e?l.push(r):r||new o(this,e))}),l.length?1===l.length?l[0]:t(l):this}}.call(t,n,t,e))||(e.exports=o)},function(e,t){e.exports=jQuery},function(e,t,n){var o;void 0===(o=function(e){"use strict";var t=n(1),o=n(3),r=n(4),i=n(5),l=n(7),a=n(6),s=n(8),c=window,u=document,d=t(c),f=t(u),p=a.ie,h=p&&p<11,m=function(e,n){var g,v,b,y,x,w,C,k,S,E,T,D,M,R,H,B,I,N,z,O,A,L,_,W,P,F,q,j,V,$,Q,U,Y,K,X,G,J,Z,ee,te,ne,oe,re,ie,le,ae,se,ce,ue,de,fe,pe,he,me,ge,ve,be,ye,xe=this,we=e.get?e.get(0):e,Ce=t(we),ke=[],Se=[],Ee=[],Te={},De=[],Me={};xe.commands=t.extend(!0,{},n.commands||m.commands),xe.opts=n=t.extend({},m.defaultOptions,n),A=function(){Ce.data("sceditor",xe),t.each(n,function(e,o){t.isPlainObject(o)&&(n[e]=t.extend(!0,{},o))}),n.locale&&"en"!==n.locale&&q(),g=t('<div class="sceditor-container" />').insertAfter(Ce).css("z-index",n.zIndex),p&&g.addClass("ie ie"+p),N=!!Ce.attr("required"),Ce.removeAttr("required"),F(),Y(),j(),P(!!n.startInSourceMode),Q(),V(),$(),a.isWysiwygSupported||xe.toggleSourceMode(),ae();var e=function(){d.off("load",e),n.autofocus&&fe(),n.autoExpand&&xe.expandToContent(),ie(),M.call("ready")};d.on("load",e),u.readyState&&"complete"===u.readyState&&e()},F=function(){var e=n.plugins;e=e?e.toString().split(","):[],M=new o(xe),t.each(e,function(e,n){M.register(t.trim(n))})},q=function(){var e;(T=m.locale[n.locale])||(e=n.locale.split("-"),T=m.locale[e[0]]),T&&T.dateFormat&&(n.dateFormat=T.dateFormat)},P=function(e){var o,i;C=t("<textarea></textarea>"),b=t('<iframe id="editor" frameborder="0" allowfullscreen="true"></iframe>'),e?(g.addClass("sourceMode"),b.hide()):(g.addClass("wysiwygMode"),C.hide()),n.spellcheck||C.attr("spellcheck","false"),"https:"===c.location.protocol&&b.attr("src","javascript:false"),g.append(b).append(C),y=b[0],k=C[0],xe.dimensions(n.width||Ce.width(),n.height||Ce.height()),(o=K()).open(),o.write(s("html",{attrs:p?' class="ie ie'+p+'"':"",spellcheck:n.spellcheck?"":'spellcheck="false"',charset:n.charset,style:n.style})),o.close(),w=t(o),x=t(o.body),xe.readOnly(!!n.readOnly),(a.ios||p)&&(x.height("100%"),p||x.on("touchend",xe.focus)),i=Ce.attr("tabindex"),C.attr("tabindex",i),b.attr("tabindex",i),D=new r(y.contentWindow),xe.val(Ce.hide().val())},V=function(){n.autoUpdate&&(x.on("blur",ye),C.on("blur",ye)),null===n.rtl&&(n.rtl="rtl"===C.css("direction")),xe.rtl(!!n.rtl),n.autoExpand&&w.on("keyup",xe.expandToContent),n.resizeEnabled&&U(),g.attr("id",n.id),xe.emoticons(n.emoticonsEnabled)},$=function(){var e=p?"selectionchange":"keyup focus blur contextmenu mouseup touchend click",o="keydown keyup keypress focus blur contextmenu";f.click(re),t(we.form).on("reset",te).submit(xe.updateOriginal),d.on("resize orientationChanged",ie),x.keypress(ee).keydown(J).keydown(Z).keyup(ce).blur(ve).keyup(be).on("paste",X).on(e,ue).on(o,oe),n.emoticonsCompat&&c.getSelection&&x.keyup(he),C.blur(ve).keyup(be).keydown(J).on(o,oe),w.mousedown(ne).blur(ve).on(e,ue).on("beforedeactivate keyup mouseup",W).keyup(ce).focus(function(){E=null}),g.on("selectionchanged",de).on("selectionchanged",ae).on("selectionchanged valuechanged nodechanged",oe)},j=function(){var e,o=xe.commands,r=(n.toolbarExclude||"").split(","),i=n.toolbar.split("|");v=t('<div class="sceditor-toolbar" unselectable="on" />'),t.each(i,function(n,i){e=t('<div class="sceditor-group" />'),t.each(i.split(","),function(n,i){var l,a,c=o[i];!c||t.inArray(i,r)>-1||(a=c.shortcut,(l=s("toolbarButton",{name:i,dispName:xe._(c.name||c.tooltip||i)},!0)).data("sceditor-txtmode",!!c.txtExec).data("sceditor-wysiwygmode",!!c.exec).toggleClass("disabled",!c.exec).mousedown(function(){(!p||p<9)&&(O=!0)}).click(function(){var e=t(this);return e.hasClass("disabled")||_(e,c),ae(),!1}),c.tooltip&&l.attr("title",xe._(c.tooltip)+(a?" ("+a+")":"")),a&&xe.addShortcut(a,i),c.state?Ee.push({name:i,state:c.state}):"string"==typeof c.exec&&Ee.push({name:i,state:c.exec}),e.append(l),Me[i]=l)}),e[0].firstChild&&v.append(e)}),t(n.toolbarContainer||g).append(v)},Q=function(){t.each(xe.commands,function(e,n){n.forceNewLineAfter&&t.isArray(n.forceNewLineAfter)&&(Se=t.merge(Se,n.forceNewLineAfter))}),ce()},U=function(){var e,o,r,i,l,a,s=t('<div class="sceditor-grip" />'),u=t('<div class="sceditor-resize-cover" />'),d="touchmove mousemove",h="touchcancel touchend mouseup",m=0,v=0,b=0,y=0,x=0,w=0,C=g.width(),k=g.height(),S=!1,E=xe.rtl();e=n.resizeMinHeight||k/1.5,o=n.resizeMaxHeight||2.5*k,r=n.resizeMinWidth||C/1.25,i=n.resizeMaxWidth||1.25*C,l=function(t){"touchmove"===t.type?(t=c.event,b=t.changedTouches[0].pageX,y=t.changedTouches[0].pageY):(b=t.pageX,y=t.pageY);var l=w+(y-v),a=E?x-(b-m):x+(b-m);i>0&&a>i&&(a=i),r>0&&a<r&&(a=r),n.resizeWidth||(a=!1),o>0&&l>o&&(l=o),e>0&&l<e&&(l=e),n.resizeHeight||(l=!1),(a||l)&&(xe.dimensions(a,l),p<7&&g.height(l)),t.preventDefault()},a=function(e){S&&(S=!1,u.hide(),g.removeClass("resizing").height("auto"),f.off(d,l),f.off(h,a),e.preventDefault())},g.append(s),g.append(u.hide()),s.on("touchstart mousedown",function(e){"touchstart"===e.type?(e=c.event,m=e.touches[0].pageX,v=e.touches[0].pageY):(m=e.pageX,v=e.pageY),x=g.width(),w=g.height(),S=!0,g.addClass("resizing"),u.show(),f.on(d,l),f.on(h,a),p<7&&g.height(w),e.preventDefault()})},Y=function(){var e,o=n.emoticons,r=n.emoticonsRoot;t.isPlainObject(o)&&n.emoticonsEnabled&&(void 0!==n.closePreLoadEmoticon&&n.closePreLoadEmoticon||t.each(o,function(n,i){t.each(i,function(t,i){r&&(i={url:r+(i.url||i),tooltip:i.tooltip||t},o[n][t]=i),(e=u.createElement("img")).src=i.url||i,ke.push(e)})}))},fe=function(){var e,o,r=w[0],l=x[0],a=l.firstChild,s=!!n.autofocusEnd;if(g.is(":visible")){if(xe.sourceMode())return o=s?k.value.length:0,void(k.setSelectionRange?k.setSelectionRange(o,o):((e=k.createTextRange()).moveEnd("character",o),e.collapse(!1),e.select()));if(i.removeWhiteSpace(l),s)for((a=l.lastChild)||(a=r.createElement("p"),x.append(a));a.lastChild;)a=a.lastChild,!h&&t(a).is("br")&&a.previousSibling&&(a=a.previousSibling);r.createRange?(e=r.createRange(),i.canHaveChildren(a)?e.selectNodeContents(a):(e.setStartBefore(a),s&&e.setStartAfter(a))):(e=l.createTextRange()).moveToElementText(3!==a.nodeType?a:a.parentNode),e.collapse(!s),D.selectRange(e),B=e,s&&(w.scrollTop(l.scrollHeight),x.scrollTop(l.scrollHeight)),xe.focus()}},xe.readOnly=function(e){return"boolean"!=typeof e?"readonly"===C.attr("readonly"):(x[0].contentEditable=!e,e?C.attr("readonly","readonly"):C.removeAttr("readonly"),le(e),xe)},xe.rtl=function(e){var t=e?"rtl":"ltr";return"boolean"!=typeof e?"rtl"===C.attr("dir"):(x.attr("dir",t),C.attr("dir",t),g.removeClass("rtl").removeClass("ltr").addClass(t),xe)},le=function(e){var n=xe.inSourceMode()?"txtmode":"wysiwygmode";t.each(Me,function(t,o){!0!==e&&o.data("sceditor-"+n)?o.removeClass("disabled"):o.addClass("disabled")})},xe.width=function(e,t){return e||0===e?(xe.dimensions(e,null,t),xe):g.width()},xe.dimensions=function(e,t,o){var r=p<8||u.documentMode<8?2:0;return e=!(!e&&0!==e)&&e,t=!(!t&&0!==t)&&t,!1===e&&!1===t?{width:xe.width(),height:xe.height()}:(void 0===b.data("outerWidthOffset")&&xe.updateStyleCache(),!1!==e&&(!1!==o&&(n.width=e),!1===t&&(t=g.height(),o=!1),g.width(e),e&&e.toString().indexOf("%")>-1&&(e=g.width()),b.width(e-b.data("outerWidthOffset")),C.width(e-C.data("outerWidthOffset")),a.ios&&x&&x.width(e-b.data("outerWidthOffset")-(x.outerWidth(!0)-x.width()))),!1!==t&&(!1!==o&&(n.height=t),t&&t.toString().indexOf("%")>-1?(t=g.height(t).height(),g.height("auto")):t&&t.toString().indexOf("px")>-1&&(t=g.height(t).height(),g.height("auto")),t-=n.toolbarContainer?0:v.outerHeight(!0),b.height(t-b.data("outerHeightOffset")),C.height(t-r-C.data("outerHeightOffset"))),xe)},xe.editorIframe=function(){return b},xe.getToolBar=function(){return v},xe.updateStyleCache=function(){b.data("outerWidthOffset",b.outerWidth(!0)-b.width()),C.data("outerWidthOffset",C.outerWidth(!0)-C.width()),b.data("outerHeightOffset",b.outerHeight(!0)-b.height()),C.data("outerHeightOffset",C.outerHeight(!0)-C.height())},xe.height=function(e,t){return e||0===e?(xe.dimensions(null,e,t),xe):g.height()},xe.maximize=function(e){return void 0===e?g.is(".sceditor-maximize"):(e=!!e,p<7&&t("html, body").toggleClass("sceditor-maximize",e),g.toggleClass("sceditor-maximize",e),xe.width(e?"100%":n.width,!1),xe.height(e?"100%":n.height,!1),xe)},xe.expandToContent=function(e){var t=g.height(),o=t-b.height(),r=x[0].scrollHeight||w[0].documentElement.scrollHeight,i=n.resizeMaxHeight||2*(n.height||Ce.height());r+=o,(!0===e||r<=i)&&r>t&&xe.height(r)},xe.destroy=function(){M&&(M.destroy(),D=null,E=null,M=null,S&&S.off().remove(),f.off("click",re),d.off("resize orientationChanged",ie),t(we.form).off("reset",te).off("submit",xe.updateOriginal),x.off(),w.off().find("*").remove(),C.off().remove(),v.remove(),g.off().find("*").off().remove(),g.remove(),Ce.removeData("sceditor").removeData("sceditorbbcode").show(),N&&Ce.attr("required","required"))},xe.createDropDown=function(e,o,r,i){var l,a="sceditor-"+o,s=S&&S.is("."+a);if(xe.closeDropDown(!0),!s){if(!1!==i&&t(r).find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"),l={top:e.offset().top,left:e.offset().left,marginTop:e.outerHeight()},t.extend(l,n.dropDownCss),S=t('<div class="sceditor-dropdown '+a+'" />').css(l).append(r).appendTo(t("body")).on("click focusin",function(e){e.stopPropagation()}),"insertlink"===o){var c=window.frames.editor.contentWindow.getSelection().toString();c?t(".sceditor-insertlink").find("input#des").val(c):window.frames.editor.contentWindow.getSelection().collapseToEnd()}setTimeout(function(){S&&S.find("input,textarea").first().focus()})}},re=function(e){3!==e.which&&S&&(ye(),xe.closeDropDown())},X=function(e){var t,o,r,i=x[0],l=w[0],a=0,s=u.createElement("div"),c=l.createDocumentFragment(),d=!!e&&e.clipboardData;if(n.disablePasting)return!1;if(n.enablePasteFiltering){if(D.saveRange(),u.body.appendChild(s),d&&d.getData&&((t=d.getData("text/html"))||(t=d.getData("text/plain"))))return s.innerHTML=t,G(i,s),!1;for(r=x.scrollTop()||w.scrollTop();i.firstChild;)c.appendChild(i.firstChild);return(o=function(e,t){if(e.childNodes.length>0||a>25){for(;e.firstChild;)t.appendChild(e.firstChild);for(;c.firstChild;)e.appendChild(c.firstChild);x.scrollTop(r),w.scrollTop(r),t.childNodes.length>0?G(e,t):D.restoreRange()}else a++,setTimeout(function(){o(e,t)},20)})(i,s),xe.focus(),!0}},G=function(e,n){i.fixNesting(n);var o=n.innerHTML;o=(o=(o=o.replace(/<style[^>]+>[^>]+>/g,"")).replace(/<script[^>]+>[^>]+>/g,"")).replace(/<[^>]+>/g,function(e){var t=e.toLowerCase().match(/^<\/?(\w+)\ ?/),n="",o="";return t&&2==t.length&&(n=t[1].toLowerCase(),o=t[0]+">"),new Array("div","br","p","dl","dd","dt","pre","img","h1","h2","h3","h4","ul","li","ol","sup","sub","b","i","u","table","tbody","th","tr","td","thead","blockquote","cite").indexOf(n)>-1?"img"==n?e:o:""}),t(n).html(o),M.hasHandler("toSource")&&(o=M.callOnlyFirst("toSource",o,t(n))),n.parentNode.removeChild(n),M.hasHandler("toWysiwyg")&&(o=M.callOnlyFirst("toWysiwyg",o,!0)),D.restoreRange(),xe.wysiwygEditorInsertHtml(o,null,!0)},xe.closeDropDown=function(e){S&&(S.off().remove(),S=null),!0===e&&xe.focus()},K=function(){return y.contentDocument?y.contentDocument:y.contentWindow&&y.contentWindow.document?y.contentWindow.document:y.document},xe.wysiwygEditorInsertHtml=function(e,n,o){var r,l,a,s=b.height();xe.focus(),(o||!t(H).is("code")&&0===t(H).parents("code").length)&&(D.insertHTML(e,n),D.saveRange(),L(x[0]),r=x.find("#sceditor-end-marker").show(),l=x.scrollTop()||w.scrollTop(),a=i.getOffset(r[0]).top+1.5*r.outerHeight(!0)-s,r.hide(),(a>l||a+s<l)&&(x.scrollTop(a),w.scrollTop(a)),ge(!1),D.restoreRange(),ce())},xe.wysiwygEditorInsertText=function(e,t){xe.wysiwygEditorInsertHtml(l.entities(e),l.entities(t))},xe.insertText=function(e,t){return xe.inSourceMode()?xe.sourceEditorInsertText(e,t):xe.wysiwygEditorInsertText(e,t),xe},xe.sourceEditorInsertText=function(e,t){var n,o,r,i=k.selectionStart,l=k.selectionEnd;o=k.scrollTop,k.focus(),void 0!==i?(r=k.value,t&&(e+=r.substring(i,l)+t),k.value=r.substring(0,i)+e+r.substring(l,r.length),k.selectionStart=i+e.length-(t?t.length:0),k.selectionEnd=k.selectionStart):(n=u.selection.createRange(),t&&(e+=n.text+t),n.text=e,t&&n.moveEnd("character",0-t.length),n.moveStart("character",n.End-n.Start),n.select()),k.scrollTop=o,k.focus(),ge()},xe.getRangeHelper=function(){return D},xe.sourceEditorCaret=function(e){var t,n={};return k.focus(),void 0!==k.selectionStart?e?(k.selectionStart=e.start,k.selectionEnd=e.end):(n.start=k.selectionStart,n.end=k.selectionEnd):(t=u.selection.createRange(),e?(t.moveEnd("character",e.end),t.moveStart("character",e.start),t.select()):(n.start=t.Start,n.end=t.End)),e?this:n},xe.val=function(e,t){return"string"!=typeof e?xe.inSourceMode()?xe.getSourceEditorValue(!1):xe.getWysiwygEditorValue(t):(xe.inSourceMode()?xe.setSourceEditorValue(e):(!1!==t&&M.hasHandler("toWysiwyg")&&(e=M.callOnlyFirst("toWysiwyg",e)),xe.setWysiwygEditorValue(e)),xe)},xe.insert=function(e,n,o,r,i){if(xe.inSourceMode())return xe.sourceEditorInsertText(e,n),xe;if(n){var l=D.selectedHtml(),a=t("<div>").appendTo(t("body")).hide().html(l);!1!==o&&M.hasHandler("toSource")&&(l=M.callOnlyFirst("toSource",l,a)),a.remove(),e+=l+n}return!1!==o&&M.hasHandler("toWysiwyg")&&(e=M.callOnlyFirst("toWysiwyg",e,!0)),!1!==o&&!0===i&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),xe.wysiwygEditorInsertHtml(e),xe},xe.getWysiwygEditorValue=function(e){var n,o=t("<div>").appendTo(document.body).append(t(x[0].childNodes).clone());return i.fixNesting(o[0]),n=o.html(),!1!==e&&M.hasHandler("toSource")&&(n=M.callOnlyFirst("toSource",n,o)),o.remove(),n},xe.getBody=function(){return x},xe.getContentAreaContainer=function(){return b},xe.getSourceEditorValue=function(e){var t=C.val();return!1!==e&&M.hasHandler("toWysiwyg")&&(t=M.callOnlyFirst("toWysiwyg",t)),t},xe.setWysiwygEditorValue=function(e){e||(e="<p>"+(p?"":"<br />")+"</p>"),x[0].innerHTML=e,L(x[0]),ce(),ge()},xe.setSourceEditorValue=function(e){C.val(e),ge()},xe.updateOriginal=function(){Ce.val(xe.val())},L=function(e){if(n.emoticonsEnabled&&!t(e).parents("code").length){var o=e.ownerDocument,r="\\s| | | | |&nbsp;",a=[],c=[],u=t.extend({},n.emoticons.more,n.emoticons.dropdown,n.emoticons.hidden);t.each(u,function(e){n.emoticonsCompat&&(c[e]=new RegExp("(>|^|"+r+")"+l.regex(e)+"($|<|"+r+")")),a.push(e)});var d=function(e){for(e=e.firstChild;e;){var r,l,f,p,h,m,g,v=e.parentNode,b=e.nodeValue;if(3!==e.nodeType)t(e).is("code")||d(e);else if(b)for(h=a.length;h--;)l=a[h],(g=n.emoticonsCompat?b.search(c[l]):b.indexOf(l))>-1&&(m=e.nextSibling,f=u[l],r=b.substr(g).split(l),b=b.substr(0,g)+r.shift(),e.nodeValue=b,p=i.parseHTML(s("emoticon",{key:l,url:f.url||f,tooltip:f.tooltip||l}),o),v.insertBefore(p[0],m),v.insertBefore(o.createTextNode(r.join(l)),m));e=e.nextSibling}};d(e),n.emoticonsCompat&&(De=x.find("img[data-sceditor-emoticon]"))}},xe.inSourceMode=function(){return g.hasClass("sourceMode")},xe.sourceMode=function(e){var t=xe.inSourceMode();return"boolean"!=typeof e?t:((t&&!e||!t&&e)&&xe.toggleSourceMode(),xe)},xe.toggleSourceMode=function(){var e=xe.inSourceMode();!a.isWysiwygSupported&&e||(e||(D.saveRange(),D.clear()),xe.blur(),e?xe.setWysiwygEditorValue(xe.getSourceEditorValue()):xe.setSourceEditorValue(xe.getWysiwygEditorValue()),E=null,C.toggle(),b.toggle(),g.toggleClass("wysiwygMode",e).toggleClass("sourceMode",!e),le(),ae())},se=function(){return k.focus(),void 0!==k.selectionStart?k.value.substring(k.selectionStart,k.selectionEnd):u.selection.createRange().text},_=function(e,n){xe.inSourceMode()?n.txtExec&&(t.isArray(n.txtExec)?xe.sourceEditorInsertText.apply(xe,n.txtExec):n.txtExec.call(xe,e,se())):n.exec&&(t.isFunction(n.exec)?n.exec.call(xe,e):xe.execCommand(n.exec,n.hasOwnProperty("execParam")?n.execParam:null))},W=function(){p&&(E=D.selectedRange())},xe.execCommand=function(e,n){var o=!1,r=xe.commands[e],i=t(D.parentNode());if(xe.focus(),!i.is("code")&&0===i.parents("code").length){try{if(o=w[0].execCommand(e,!1,n),0===e.indexOf("justify")&&R&&R.firstChild&&i[0]&&"div"==i[0].nodeName.toLowerCase()){var l=e.substr(7);i.attr("align",l)}}catch(e){}!o&&r&&r.errorMessage&&alert(xe._(r.errorMessage)),ae()}},ue=function(){function e(){D&&!D.compare(B)&&(B=D.cloneSelected(),g.trigger(t.Event("selectionchanged"))),I=!1}I||(I=!0,p?e():setTimeout(e,100))},de=function(){var e,n=D.parentNode();R!==n&&(e=R,R=n,H=D.getFirstBlockParent(n),g.trigger(t.Event("nodechanged",{oldNode:e,newNode:R})))},xe.currentNode=function(){return R},xe.currentBlockNode=function(){return H},ae=function(e){var t,n,o="active",r=w[0],i=xe.sourceMode();if(xe.readOnly())v.find(o).removeClass(o);else{i||(n=e?e.newNode:D.parentNode(),t=D.getFirstBlockParent(n));for(var l=0;l<Ee.length;l++){var a=0,s=Me[Ee[l].name],c=Ee[l].state,u=i&&!s.data("sceditor-txtmode")||!i&&!s.data("sceditor-wysiwygmode");if("string"==typeof c){if(!i)try{(a=r.queryCommandEnabled(c)?0:-1)>-1&&(a=r.queryCommandState(c)?1:0)}catch(e){}}else u||(a=c.call(xe,n,t));s.toggleClass("disabled",u||a<0).toggleClass(o,a>0)}}},ee=function(e){var n,o,r,l,a="li,ul,ol";if(!e.originalEvent.defaultPrevented)return xe.closeDropDown(),n=t(H).closest("code,blockquote,pre,spoiler,"+a).first(),13===e.which&&n.length&&!n.is(a)?(E=null,o=w[0].createElement("br"),D.insertNode(o),h||((l=(r=o.parentNode).lastChild)&&3===l.nodeType&&""===l.nodeValue&&(r.removeChild(l),l=r.lastChild),!i.isInline(r,!0)&&l===o&&i.isInline(o.previousSibling)&&D.insertHTML("<br>")),!1):void 0},ce=function(){var e,n,o,r=x[0];i.rTraverse(r,function(l){if("p"==(e=l.nodeName.toLowerCase())&&t(l).hasClass("sceditor-nlf")&&null!==l.previousSibling&&t(l.previousSibling).hasClass("sceditor-nlf")&&t(l).removeClass("sceditor-nlf"),t.inArray(e,Se)>-1&&(n=!0),3===l.nodeType&&!/^\s*$/.test(l.nodeValue)||"br"===e||h&&!l.firstChild&&!i.isInline(l,!1))return n&&((o=w[0].createElement("p")).className="sceditor-nlf",o.innerHTML=h?"":"<br />",r.appendChild(o)),!1})},te=function(){xe.val(Ce.val())},ne=function(){xe.closeDropDown(),E=null},ie=function(){var e=n.height,t=n.width;xe.maximize()?xe.dimensions("100%","100%",!1):(e&&e.toString().indexOf("%")>-1||t&&t.toString().indexOf("%")>-1)&&xe.dimensions(t,e)},xe._=function(){var e=arguments;return T&&T[e[0]]&&(e[0]=T[e[0]]),e[0].replace(/\{(\d+)\}/g,function(t,n){return void 0!==e[n-0+1]?e[n-0+1]:"{"+n+"}"})},oe=function(e){M.call(e.type+"Event",e,xe);var n=e.target===k?"scesrc":"scewys",o=t.Event(e);o.type=n+e.type,g.trigger(o,xe)},xe.bind=function(e,n,o,r){for(var i=(e=e.split(" ")).length;i--;)t.isFunction(n)&&(o||g.on("scewys"+e[i],n),r||g.on("scesrc"+e[i],n),"valuechanged"===e[i]&&(ge.hasHandler=!0));return xe},xe.unbind=function(e,n,o,r){for(var i=(e=e.split(" ")).length;i--;)t.isFunction(n)&&(o||g.off("scewys"+e[i],n),r||g.off("scesrc"+e[i],n));return xe},xe.blur=function(e,n,o){return t.isFunction(e)?xe.bind("blur",e,n,o):xe.sourceMode()?C.blur():x.blur(),xe},xe.focus=function(e,n,o){if(t.isFunction(e))xe.bind("focus",e,n,o);else if(xe.inSourceMode())k.focus();else{var r,i=D.selectedRange();B||D.hasSelection()||fe(),!h&&i&&1===i.endOffset&&i.collapsed&&(r=i.endContainer)&&1===r.childNodes.length&&t(r.firstChild).is("br")&&(i.setStartBefore(r.firstChild),i.collapse(!0),D.selectRange(i)),y.contentWindow.focus(),x[0].focus(),E&&(D.selectRange(E),E=null)}return ae(),xe},xe.keyDown=function(e,t,n){return xe.bind("keydown",e,t,n)},xe.keyPress=function(e,t,n){return xe.bind("keypress",e,t,n)},xe.keyUp=function(e,t,n){return xe.bind("keyup",e,t,n)},xe.nodeChanged=function(e){return xe.bind("nodechanged",e,!1,!0)},xe.selectionChanged=function(e){return xe.bind("selectionchanged",e,!1,!0)},xe.valueChanged=function(e,t,n){return xe.bind("valuechanged",e,t,n)},pe=function(e){var o,r=0,i=xe.emoticonsCache,l=String.fromCharCode(e.which);if(!t(H).is("code")&&!t(H).parents("code").length)return i||(i=[],t.each(t.extend({},n.emoticons.more,n.emoticons.dropdown,n.emoticons.hidden),function(e,t){i[r++]=[e,s("emoticon",{key:e,url:t.url||t,tooltip:t.tooltip||e})]}),i.sort(function(e,t){return e[0].length-t[0].length}),xe.emoticonsCache=i,xe.longestEmoticonCode=i[i.length-1][0].length),(o=D.replaceKeyword(xe.emoticonsCache,!0,!0,xe.longestEmoticonCode,n.emoticonsCompat,l))&&n.emoticonsCompat?(De=x.find("img[data-sceditor-emoticon]"),/^\s$/.test(l)):!o},he=function(){if(De.length){var e,n,o,r,i,l,a=xe.currentBlockNode(),s=!1,c=/[^\s\xA0\u2002\u2003\u2009\u00a0]+/;De=t.map(De,function(u){return u&&u.parentNode?t.contains(a,u)?(e=u.previousSibling,n=u.nextSibling,null===(i=e.nodeValue)&&(i=e.innerText||""),e&&c.test(e.nodeValue.slice(-1))||n&&c.test((n.nodeValue||"")[0])?(o=u.parentNode,r=D.cloneSelected(),l=r.startContainer,i+=t(u).data("sceditor-emoticon"),l===n?s=i.length+r.startOffset:l===a&&a.childNodes[r.startOffset]===n?s=i.length:l===e&&(s=r.startOffset),n&&3===n.nodeType||(n=o.insertBefore(o.ownerDocument.createTextNode(""),n)),n.insertData(0,i),o.removeChild(e),o.removeChild(u),!1!==s&&(r.setStart(n,s),r.collapse(!0),D.selectRange(r)),null):u):u:null})}},xe.emoticons=function(e){return e||!1===e?(n.emoticonsEnabled=e,e?(x.keypress(pe),xe.sourceMode()||(D.saveRange(),L(x[0]),De=x.find("img[data-sceditor-emoticon]"),ge(!1),D.restoreRange())):(x.find("img[data-sceditor-emoticon]").replaceWith(function(){return t(this).data("sceditor-emoticon")}),De=[],x.off("keypress",pe),ge()),xe):n.emoticonsEnabled},xe.css=function(e){return z||(z=t('<style id="#inline" />',w[0]).appendTo(w.find("head"))[0]),"string"!=typeof e?z.styleSheet?z.styleSheet.cssText:z.innerHTML:(z.styleSheet?z.styleSheet.cssText=e:z.innerHTML=e,xe)},J=function(e){var t=[],n={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|","[":"{","]":"}"},o={109:"-",110:"del",111:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},r=e.which,i={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"win",92:"win",93:"select",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[r]||String.fromCharCode(r).toLowerCase();if((e.ctrlKey||e.metaKey)&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&(t.push("shift"),o[r]?i=o[r]:n[i]&&(i=n[i])),i&&(r<16||r>18)&&t.push(i),t=t.join("+"),Te[t])return Te[t].call(xe)},xe.addShortcut=function(e,t){return e=e.toLowerCase(),Te[e]="string"==typeof t?function(){return _(Me[t],xe.commands[t]),!1}:t,xe},xe.removeShortcut=function(e){return delete Te[e.toLowerCase()],xe},Z=function(e){var o,r,i,l,a;if(!n.disableBlockRemove&&8===e.which&&(l=D.selectedRange())&&(c.getSelection?(o=l.startContainer,r=l.startOffset):(o=l.parentElement(),(i=w[0].selection.createRange()).moveToElementText(o),i.setEndPoint("EndToStart",l),r=i.text.length),0===r&&(a=me()))){for(;o!==a;){for(;o.previousSibling;)if(3!==(o=o.previousSibling).nodeType||o.nodeValue)return;if(!(o=o.parentNode))return}if(a&&!t(a).is("body"))return xe.clearBlockFormatting(a),!1}},me=function(){for(var e=H;!i.hasStyling(e)||i.isInline(e,!0);)if(!(e=e.parentNode)||t(e).is("body"))return;return e},xe.clearBlockFormatting=function(e){return!(e=e||me())||t(e).is("body")?xe:(D.saveRange(),e.className="",E=null,t(e).attr("style",""),t(e).is("p,div,td")||i.convertElement(e,"p"),D.restoreRange(),xe)},ge=function(e){if(M&&(M.hasHandler("valuechangedEvent")||ge.hasHandler)){var n,o=xe.sourceMode(),r=!o&&D.hasSelection();e=!1!==e&&!w[0].getElementById("sceditor-start-marker"),be.timer&&(clearTimeout(be.timer),be.timer=!1),r&&e&&D.saveRange(),(n=o?C.val():x.html())!==ge.lastHtmlValue&&(ge.lastHtmlValue=n,g.trigger(t.Event("valuechanged",{rawValue:o?xe.val():n}))),r&&e&&D.removeMarkers()}},ve=function(){be.timer&&ge()},be=function(e){var t=e.which,n=be.lastChar,o=13===n||32===n,r=8===n||46===n;be.lastChar=t,13===t||32===t?o?be.triggerNextChar=!0:ge():8===t||46===t?r?be.triggerNextChar=!0:ge():be.triggerNextChar&&(ge(),be.triggerNextChar=!1),be.timer&&clearTimeout(be.timer),be.timer=setTimeout(function(){ge()},1500)},ye=function(){O||xe.updateOriginal(),O=!1},A()};return m.locale={},m.command={get:function(e){return m.commands[e]||null},set:function(e,n){return!(!e||!n)&&((n=t.extend(m.commands[e]||{},n)).remove=function(){m.command.remove(e)},m.commands[e]=n,this)},remove:function(e){return m.commands[e]&&delete m.commands[e],this}},m}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){"use strict";var e={},t=function(t){var n=this,o=[],r=function(e){return"signal"+e.charAt(0).toUpperCase()+e.slice(1)},i=function(e,n){e=[].slice.call(e);var i,l,a=r(e.shift());for(i=0;i<o.length;i++)if(a in o[i]&&(l=o[i][a].apply(t,e),n))return l};n.call=function(){i(arguments,!1)},n.callOnlyFirst=function(){return i(arguments,!0)},n.hasHandler=function(e){var t=o.length;for(e=r(e);t--;)if(e in o[t])return!0;return!1},n.exists=function(t){return t in e&&("function"==typeof(t=e[t])&&"object"==typeof t.prototype)},n.isRegistered=function(t){if(n.exists(t))for(var r=o.length;r--;)if(o[r]instanceof e[t])return!0;return!1},n.register=function(r){return!(!n.exists(r)||n.isRegistered(r))&&(r=new e[r],o.push(r),"init"in r&&r.init.call(t),!0)},n.deregister=function(r){var i,l=o.length,a=!1;if(!n.isRegistered(r))return a;for(;l--;)o[l]instanceof e[r]&&(a=!0,"destroy"in(i=o.splice(l,1)[0])&&i.destroy.call(t));return a},n.destroy=function(){for(var e=o.length;e--;)"destroy"in o[e]&&o[e].destroy.call(t);o=[],t=null}};return t.plugins=e,t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var t=n(1),o=n(5),r=n(7),i=n(6).ie,l=i&&i<11,a=function(e){return t("<p>",e.ownerDocument).append(e).html()},s=function(e,t,n){var o,r,i,l,a,s="",c=e.startContainer,u=e.startOffset;for(c&&3!==c.nodeType&&(c=c.childNodes[u],u=0),i=l=u;n>s.length&&c&&3===c.nodeType;)o=c.nodeValue,r=n-s.length,a&&(l=o.length,i=0),a=c,t?(u=i=Math.max(l-r,0),s=o.substr(i,l-i)+s,c=a.previousSibling):(u=i+(l=Math.min(r,o.length)),s+=o.substr(i,l),c=a.nextSibling);return{node:a||c,offset:u,text:s}};return function(e,n){var c,u,d,f=n||e.contentDocument||e.document,p=e,h=!!e.getSelection,m="sceditor-start-marker",g="sceditor-end-marker",v="character",b=this;b.insertHTML=function(e,t){var n,o,r=b.selectedRange();if(!r)return!1;if(h){for(t&&(e+=b.selectedHtml()+t),o=f.createElement("p"),n=f.createDocumentFragment(),o.innerHTML=e;o.firstChild;)n.appendChild(o.firstChild);b.insertNode(n)}else r.pasteHTML(d(e,t,!0)),b.restoreRange()},d=function(e,n,r){var l,a,s=f.createElement("div"),u=t(s);if("string"==typeof e?(n&&(e+=b.selectedHtml()+n),u.html(e)):(u.append(e),n&&u.append(b.selectedRange().extractContents()).append(n)),l=s.lastChild){for(;!o.isInline(l.lastChild,!0);)l=l.lastChild;return o.canHaveChildren(l)&&(a=t(l),l.lastChild||a.append("​")),i&&i<9&&t(l).is("img")&&u.append("​"),b.removeMarkers(),(a||u).append(c(m)).append(c(g)),r?u.html():t(f.createDocumentFragment()).append(u.contents())[0]}},b.insertNode=function(e,t){if(h){var n=d(e,t),r=b.selectedRange(),i=r.commonAncestorContainer;if(!n)return!1;r.deleteContents(),i&&3!==i.nodeType&&!o.canHaveChildren(i)?i.parentNode.insertBefore(n,i):r.insertNode(n),b.restoreRange()}else b.insertHTML(a(e),t?a(t):null)},b.cloneSelected=function(){var e=b.selectedRange();if(e)return h?e.cloneRange():e.duplicate()},b.selectedRange=function(){var e,t,n=h?p.getSelection():f.selection;if(n){if(n.getRangeAt&&n.rangeCount<=0){for(t=f.body;t.firstChild;)t=t.firstChild;(e=f.createRange()).setStartBefore(t),n.addRange(e)}return h&&n.rangeCount>0&&(e=n.getRangeAt(0)),h||"Control"===n.type||(e=n.createRange()),u(e)?e:null}},u=function(e){var t;return e&&!h&&(t=e.parentElement()),!t||t.ownerDocument===f},b.hasSelection=function(){var e=h?p.getSelection():f.selection;return h||!e?e&&e.rangeCount>0:"None"!==e.type&&u(e.createRange())},b.selectedHtml=function(){var e,t=b.selectedRange();if(t){if(h)return(e=f.createElement("p")).appendChild(t.cloneContents()),e.innerHTML;if(""!==t.text&&t.htmlText)return t.htmlText}return""},b.parentNode=function(){var e=b.selectedRange();if(e)return e.parentElement?e.parentElement():e.commonAncestorContainer},b.getFirstBlockParent=function(e){var t=function(e){return o.isInline(e,!0)&&(e=e?e.parentNode:null)?t(e):e};return t(e||b.parentNode())},b.insertNodeAt=function(e,t){var n=b.selectedRange(),o=b.cloneSelected();if(!o)return!1;o.collapse(e),h?o.insertNode(t):o.pasteHTML(a(t)),b.selectRange(n)},c=function(e){b.removeMarker(e);var t=f.createElement("span");return t.id=e,t.style.lineHeight="0",t.style.display="none",t.className="sceditor-selection sceditor-ignore",t.innerHTML=" ",t},b.insertMarkers=function(){b.insertNodeAt(!0,c(m)),b.insertNodeAt(!1,c(g))},b.getMarker=function(e){return f.getElementById(e)},b.removeMarker=function(e){var t=b.getMarker(e);t&&t.parentNode.removeChild(t)},b.removeMarkers=function(){b.removeMarker(m),b.removeMarker(g)},b.saveRange=function(){b.insertMarkers()},b.selectRange=function(e){if(h){var n,r=p.getSelection(),i=e.endContainer;if(!l&&e.collapsed&&i&&!o.isInline(i,!0)){for(n=i.lastChild;n&&t(n).is(".sceditor-ignore");)n=n.previousSibling;if(t(n).is("br")){var a=f.createRange();a.setEndAfter(n),a.collapse(!1),b.compare(e,a)&&(e.setStartBefore(n),e.collapse(!0))}}r&&(b.clear(),r.addRange(e))}else e.select()},b.restoreRange=function(){var e,n,r,i=b.selectedRange(),l=b.getMarker(m),a=b.getMarker(g);if(!l||!a||!i)return!1;n=l.nextSibling===a,h?((i=f.createRange()).setStartBefore(l),i.setEndAfter(a)):(i=f.body.createTextRange(),e=f.body.createTextRange(),r=l.previousSibling,l.nextSibling!==a||r&&o.isInline(r,!0)&&!t(r).is("br")||t(l).before("​"),e.moveToElementText(l),i.setEndPoint("StartToStart",e),i.moveStart(v,0),e.moveToElementText(a),i.setEndPoint("EndToStart",e),i.moveEnd(v,0)),n&&i.collapse(!0),b.selectRange(i),b.removeMarkers()},b.selectOuterText=function(e,t){var n,o,r=b.cloneSelected();if(!r)return!1;r.collapse(!1),h?(n=s(r,!0,e),o=s(r,!1,t),r.setStart(n.node,n.offset),r.setEnd(o.node,o.offset)):(r.moveStart(v,0-e),r.moveEnd(v,t)),b.selectRange(r)},b.getOuterText=function(e,t){var n=b.cloneSelected();return n?(n.collapse(!e),h?s(n,e,t).text:(e?n.moveStart(v,0-t):n.moveEnd(v,t),n.text)):""},b.replaceKeyword=function(e,t,n,o,i,l){n||e.sort(function(e,t){return e[0].length-t[0].length});var a,s,c,u,d,f,p,m="[\\s    ]",g=e.length,v=i?1:0,y=o||e[g-1][0].length;if(i){if(!h)return!1;y++}for(l=l||"",u=(a=b.getOuterText(!0,y)).length,a+=l,t&&(a+=b.getOuterText(!1,y));g--;)if(p=(f=e[g][0]).length,c=Math.max(0,u-p-v),(s=i?a.substr(c).search(new RegExp("(?:"+m+")"+r.regex(f)+"(?="+m+")")):a.indexOf(f,c))>-1&&(i&&(s+=c+1),s<=u&&s+p+v>=u))return d=u-s,b.selectOuterText(d,p-d-(/^\S/.test(l)?1:0)),b.insertHTML(e[g][1]),!0;return!1},b.compare=function(e,t){var n=h?Range.END_TO_END:"EndToEnd",o=h?Range.START_TO_START:"StartToStart",r=h?"compareBoundaryPoints":"compareEndPoints";return t||(t=b.selectedRange()),e&&t?u(e)&&u(t)&&0===e[r](n,t)&&0===e[r](o,t):!e&&!t},b.clear=function(){var e=h?p.getSelection():f.selection;e&&(e.removeAllRanges?e.removeAllRanges():e.empty&&e.empty())}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var t=n(1),o=n(6),r={},i={traverse:function(e,t,n,o,r){if(e)for(e=r?e.lastChild:e.firstChild;e;){var l=r?e.previousSibling:e.nextSibling;if(!n&&!1===t(e)||!o&&!1===i.traverse(e,t,n,o,r)||n&&!1===t(e))return!1;e=l}},rTraverse:function(e,t,n,o){this.traverse(e,t,n,o,!0)},parseHTML:function(e,n){var o=[],r=(n||document).createElement("div");return r.innerHTML=e,t.merge(o,r.childNodes),o},hasStyling:function(e){var n=t(e);return e&&(!n.is("p,div")||e.className||n.attr("style")||!t.isEmptyObject(n.data()))},convertElement:function(e,t){for(var n,r,l=e.attributes,a=l.length,s=e.ownerDocument.createElement(t);a--;)if(r=l[a],!o.ie||r.specified)if(o.ie<8&&/style/i.test(r.name))i.copyCSS(e,s);else try{s.setAttribute(r.name,r.value)}catch(e){}for(;n=e.firstChild;)s.appendChild(n);return e.parentNode.replaceChild(s,e),s},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|spoiler|center|",canHaveChildren:function(e){return!!/11?|9/.test(e.nodeType)&&"|iframe|area|base|basefont|br|col|frame|hr|img|input|wbr|isindex|link|meta|param|command|embed|keygen|source|track|object|".indexOf("|"+e.nodeName.toLowerCase()+"|")<0},isInline:function(e,t){var n,o=(e||{}).nodeType||3;return 1!==o?3===o:"code"===(n=e.tagName.toLowerCase())?!t:i.blockLevelList.indexOf("|"+n+"|")<0},copyCSS:function(e,t){t.style.cssText=e.style.cssText+t.style.cssText},fixNesting:function(e){i.traverse(e,function(e){if(1===e.nodeType&&!i.isInline(e,!0)&&i.isInline(e.parentNode,!0)){var t=function(e){for(;i.isInline(e.parentNode,!0);)e=e.parentNode;return e}(e),n=t.parentNode,o=i.extractContents(t,e),r=e;i.copyCSS(t,r),n.insertBefore(o,t),n.insertBefore(r,t)}})},findCommonAncestor:function(e,n){return t(e).parents().has(t(n)).first()},getSibling:function(e,t){return e?(t?e.previousSibling:e.nextSibling)||i.getSibling(e.parentNode,t):null},removeWhiteSpace:function(e,n){for(var o,r,l,a,s,c,u,d,f=i.getSibling,p=i.isInline,h=e.firstChild;h;){if(u=h.nextSibling,o=h.nodeValue,1===(r=h.nodeType)&&h.firstChild&&(c=t(h).css("whiteSpace"),/pre(\-wrap)?$/i.test(c)||i.removeWhiteSpace(h,/line$/i.test(c))),3===r&&o){for(l=f(h),a=f(h,!0),d=!1;t(a).hasClass("sceditor-ignore");)a=f(a,!0);if(p(h)&&a){for(s=a;s.lastChild;)s=s.lastChild;d=3===s.nodeType?/[\t\n\r ]$/.test(s.nodeValue):!p(s)}o=o.replace(/\u200B/g,""),a&&p(a)&&!d||(o=o.replace(n?/^[\t ]+/:/^[\t\n\r ]+/,"")),l&&p(l)||(o=o.replace(n?/[\t ]+$/:/[\t\n\r ]+$/,"")),o.length?h.nodeValue=o.replace(n?/[\t ]+/g:/[\t\n\r ]+/g," "):e.removeChild(h)}h=u}},extractContents:function(e,n){var o,r=i.findCommonAncestor(e,n).get(0),l=!1,a=!1;return(o=function(r){var s,c=e.ownerDocument.createDocumentFragment();return i.traverse(r,function(r){if(a||r===n)return a=!0,!1;r===e&&(l=!0),t.contains(r,e)||l&&t.contains(r,n)?((s=r.cloneNode(!1)).appendChild(o(r)),c.appendChild(s)):l&&!t.contains(c,r)&&c.appendChild(r)},!1),c})(r)},getOffset:function(e){for(var t=0,n=0;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}},getStyle:function(e,n){var o,i,l,a=e.style;if(!a)return"";if(r[n]||(r[n]=t.camelCase(n)),l=a[n=r[n]],"textAlign"===n){if(o=t(e),i=a.direction,l=l||o.css(n),o.parent().css(n)===l||"block"!==o.css("display")||o.is("hr")||o.is("th"))return"";if(/right/i.test(l)&&"rtl"===i||/left/i.test(l)&&"ltr"===i)return""}return l},hasStyle:function(e,n,o){var r=i.getStyle(e,n);return!!r&&(!o||r===o||t.isArray(o)&&t.inArray(r,o)>-1)}};return i}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";var o,r,i,l=n(1),a=navigator.userAgent;t.ie=function(){var e=3,t=document,n=t.createElement("div"),o=n.getElementsByTagName("i");do{n.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e"}while(o[0]);return t.documentMode&&t.all&&window.atob&&(e=10),4===e&&t.documentMode&&(e=11),e>4?e:void 0}(),t.ios=/iPhone|iPod|iPad| wosbrowser\//i.test(a),t.isWysiwygSupported=void 0!==(i=l('<p contenteditable="true">')[0].contentEditable)&&"inherit"!==i&&(r=/Opera Mobi|Opera Mini/i.test(a),/Android/i.test(a)&&(r=!0,/Safari/.test(a)&&(r=!(o=/Safari\/(\d+)/.exec(a))||!o[1]||o[1]<534)),/ Silk\//i.test(a)&&(r=!(o=/AppleWebKit\/(\d+)/.exec(a))||!o[1]||o[1]<534),t.ios&&(r=/OS [0-4](_\d)+ like Mac/i.test(a)),/Firefox/i.test(a)&&(r=!1),/OneBrowser/i.test(a)&&(r=!1),"UCWEB"===navigator.vendor&&(r=!1),!r)}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";var n=/^(?:https?|s?ftp|mailto|spotify|skype|ssh|teamspeak|tel):|(?:\/\/)/i;t.regex=function(e){return e.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},t.entities=function(e,t){if(!e)return e;var n={"&":"&amp;","<":"&lt;",">":"&gt;","  ":" &nbsp;","\r\n":"\n","\r":"\n","\n":"<br />"};return!1!==t&&(n['"']="&#34;",n["'"]="&#39;",n["`"]="&#96;"),e=e.replace(/ {2}|\r\n|[&<>\r\n'"`]/g,function(e){return n[e]||e})},t.uriScheme=function(e){var t,o=window.location;return e&&/^[^\/]*:/i.test(e)&&!n.test(e)?((t=o.pathname.split("/")).pop(),o.protocol+"//"+o.host+t.join("/")+"/"+e):e}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){"use strict";var e={html:'<!DOCTYPE html><html{attrs}><head><style>.ie * {min-height: auto !important} .ie table td {height:15px} @supports (-ms-ime-align:auto) { * { min-height: auto !important; } }</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true" {spellcheck}><p></p></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="link">{url}</label> <input type="text" id="image" placeholder="http://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" placeholder="http://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" placeholder="https://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" src="https://www.youtube.com/embed/{id}?wmode=opaque" data-youtube-id="{id}" frameborder="0" allowfullscreen></iframe>'};return function(t,n,o){var r=e[t];return $.each(n,function(e,t){r=r.replace(new RegExp("\\{"+e+"\\}","g"),t)}),o&&(r=$(r)),r}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var t=n(1),o=n(6).ie,r=n(8),i=o&&o<11,l={bold:{exec:"bold",tooltip:"Bold",shortcut:"Ctrl+B"},italic:{exec:"italic",tooltip:"Italic",shortcut:"Ctrl+I"},underline:{exec:"underline",tooltip:"Underline",shortcut:"Ctrl+U"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(e,n,o){for(var i=0,l=e.opts.fonts.split(","),a=t("<div />"),s=function(){return o(t(this).data("font")),e.closeDropDown(!0),!1};i<l.length;i++)a.append(r("fontOpt",{font:l[i]},!0).click(s));e.createDropDown(n,"font-picker",a)},exec:function(e){var t=this;l.font._dropDown(t,e,function(e){t.execCommand("fontname",e)})},tooltip:"Font Name"},size:{_dropDown:function(e,n,o){for(var i=t("<div />"),l=function(n){o(t(this).data("size")),e.closeDropDown(!0),n.preventDefault()},a=1;a<=7;a++)i.append(r("sizeOpt",{size:a},!0).click(l));e.createDropDown(n,"fontsize-picker",i)},exec:function(e){var t=this;l.size._dropDown(t,e,function(e){t.execCommand("fontsize",e)})},tooltip:"Font Size"},color:{_dropDown:function(e,n,o){var r,i,a,s,c={r:255,g:255,b:255},u=t("<div />"),d=e.opts.colors?e.opts.colors.split("|"):new Array(21),f=[],p=l.color;if(!p._htmlCache){for(r=0;r<d.length;++r){for(s=d[r]?d[r].split(","):new Array(21),f.push('<div class="sceditor-color-column">'),i=0;i<s.length;++i)a=s[i]||"#"+c.r.toString(16)+c.g.toString(16)+c.b.toString(16),f.push('<a href="#" class="sceditor-color-option" style="background-color: '+a+'" data-color="'+a+'"></a>'),i%5==0?(c.g-=51,c.b=255):c.b-=51;f.push("</div>"),r%5==0?(c.r-=51,c.g=255,c.b=255):(c.g=255,c.b=255)}p._htmlCache=f.join("")}u.append(p._htmlCache).find("a").click(function(n){o(t(this).attr("data-color")),e.closeDropDown(!0),n.preventDefault()}),e.createDropDown(n,"color-picker",u)},exec:function(e){var t=this;l.color._dropDown(t,e,function(e){t.execCommand("forecolor",e)})},tooltip:"Font Color"},bgcolor:{_dropDown:function(e,n,o){var r,i,a,s,c={r:255,g:255,b:255},u=t("<div />"),d=e.opts.colors?e.opts.colors.split("|"):new Array(21),f=[],p=l.bgcolor;if(!p._htmlCache){for(r=0;r<d.length;++r){for(s=d[r]?d[r].split(","):new Array(21),f.push('<div class="sceditor-color-column">'),i=0;i<s.length;++i)a=s[i]||"#"+c.r.toString(16)+c.g.toString(16)+c.b.toString(16),f.push('<a href="#" class="sceditor-color-option" style="background-color: '+a+'" data-color="'+a+'"></a>'),i%5==0?(c.g-=51,c.b=255):c.b-=51;f.push("</div>"),r%5==0?(c.r-=51,c.g=255,c.b=255):(c.g=255,c.b=255)}p._htmlCache=f.join("")}u.append(p._htmlCache).find("a").click(function(n){o(t(this).attr("data-color")),e.closeDropDown(!0),n.preventDefault()}),e.createDropDown(n,"bgcolor-picker",u)},exec:function(e){var t=this;l.bgcolor._dropDown(t,e,function(e){t.wysiwygEditorInsertHtml("<span bgcolor='"+e+"' style='background-color: "+e+"'>","</span>")})},tooltip:"Highlight"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(e){var t,n,o=this;(n=r("pastetext",{label:o._("Paste your text inside the following box:"),insert:o._("Insert")},!0)).find(".button").click(function(e){(t=n.find("#txt").val())&&o.wysiwygEditorInsertText(t),o.closeDropDown(!0),e.preventDefault()}),o.createDropDown(e,"pastetext",n)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},indent:{state:function(e,n){var o,r,i,l=t(n),a=l.parents("ul,ol,menu"),s=a.first();if(a.length>1||s.children().length>1)return 0;if(l.is("ul,ol,menu")){if(o=this.getRangeHelper().selectedRange(),!(window.Range&&o instanceof Range))return l.is("li,ul,ol,menu")?0:-1;if(r=o.startContainer.parentNode,i=o.endContainer.parentNode,r!==r.parentNode.firstElementChild||t(i).is("li")&&i!==i.parentNode.lastElementChild)return 0}return-1},exec:function(){var e=t(this.getRangeHelper().getFirstBlockParent());this.focus(),e.parents("ul,ol,menu")&&this.execCommand("indent")},tooltip:"Add indent"},outdent:{state:function(e,n){return t(n).is("ul,ol,menu")||t(n).parents("ul,ol,menu").length>0?0:-1},exec:function(){t(this.getRangeHelper().getFirstBlockParent()).parents("ul,ol,menu")&&this.execCommand("outdent")},tooltip:"Remove one indent"},table:{forceNewLineAfter:["table"],exec:function(e){var t=this,n=r("table",{rows:t._("Rows:"),cols:t._("Cols:"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o,r,l=n.find("#rows").val()-0,a=n.find("#cols").val()-0,s="<table>";if(!(l<1||a<1)){for(o=0;o<l;o++){for(s+="<tr>",r=0;r<a;r++)s+="<td>"+(i?"":"<br />")+"</td>";s+="</tr>"}s+="</table>",t.wysiwygEditorInsertHtml(s),t.closeDropDown(!0),e.preventDefault()}}),t.createDropDown(e,"inserttable",n)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{forceNewLineAfter:["code"],exec:function(){this.wysiwygEditorInsertHtml("<code>",(i?"":"<br />")+"</code>")},tooltip:"Code"},image:{exec:function(e){var t=this,n=r("image",{url:t._("URL:"),width:t._("Width (optional):"),height:t._("Height (optional):"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#image").val(),r=n.find("#width").val(),i=n.find("#height").val(),l="";r&&(l+=' width="'+r+'"'),i&&(l+=' height="'+i+'"'),o&&t.wysiwygEditorInsertHtml("<img"+l+' src="'+o+'" />'),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertimage",n)},tooltip:"Insert an image"},email:{exec:function(e){var t=this,n=r("email",{label:t._("E-mail:"),desc:t._("Description (optional):"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#email").val(),r=n.find("#des").val();o&&(t.focus(),!t.getRangeHelper().selectedHtml()||r?(r=r||o,t.wysiwygEditorInsertHtml('<a href="mailto:'+o+'">'+r+"</a>")):t.execCommand("createlink","mailto:"+o)),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertemail",n)},tooltip:"Insert an email"},link:{exec:function(e){var t=this,n=r("link",{url:t._("URL:"),desc:t._("Description (optional):"),ins:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#link").val(),r=n.find("#des").val();o&&(t.focus(),!t.getRangeHelper().selectedHtml()||r?(r=r||o,t.wysiwygEditorInsertHtml('<a href="'+o+'">'+r+"</a>")):t.execCommand("createlink",o)),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertlink",n)},tooltip:"Insert a link"},unlink:{state:function(){var e=t(this.currentNode());return e.is("a")||e.parents("a").length>0?0:-1},exec:function(){var e=t(this.currentNode()),n=e.is("a")?e:e.parents("a").first();n.length&&n.replaceWith(n.contents())},tooltip:"Unlink"},quote:{forceNewLineAfter:["blockquote"],exec:function(e,t,n){var o="<blockquote>",r="</blockquote>";t?(o=o+(n=n?"<cite>"+n+"</cite>":"")+t+r,r=null):""===this.getRangeHelper().selectedHtml()&&(r=(i?"":"<br />")+r),this.wysiwygEditorInsertHtml(o,r)},tooltip:"Insert a Quote"},emoticon:{exec:function(e){var n=this,o=function(r){var i,l=n.opts.emoticonsCompat,a=n.getRangeHelper(),s=l&&" "!==a.getOuterText(!0,1)?" ":"",c=l&&" "!==a.getOuterText(!1,1)?" ":"",u=t("<div />"),d=t("<div />").appendTo(u),f=0,p=t.extend({},n.opts.emoticons.dropdown,r?n.opts.emoticons.more:{});return t.each(p,function(){f++}),f=Math.sqrt(f),t.each(p,function(e,o){d.append(t("<img />").attr({src:o.url||o,alt:e,title:o.tooltip||e}).click(function(){return n.insert(s+t(this).attr("alt")+c,null,!1).closeDropDown(!0),!1})),d.children().length>=f&&(d=t("<div />").appendTo(u))}),!r&&n.opts.emoticons.more&&(i=t('<a class="sceditor-more">'+n._("More")+"</a>").click(function(){return n.createDropDown(e,"more-emoticons",o(!0)),!1}),u.append(i)),u};n.createDropDown(e,"emoticons",o(!1))},txtExec:function(e){l.emoticon.exec.call(this,e)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(e,t,n){var o,i=r("youtubeMenu",{label:e._("Video URL:"),insert:e._("Insert")},!0);i.find(".button").click(function(t){var r=i.find("#link").val();r&&((o=r.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/))&&(r=o[1]),/^[a-zA-Z0-9_\-]{11}$/.test(r)?n(r):alert("Invalid YouTube video")),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"insertlink",i)},exec:function(e){var t=this;l.youtube._dropDown(t,e,function(e){t.wysiwygEditorInsertHtml(r("youtube",{id:e}))})},tooltip:"Insert a YouTube video"},date:{_date:function(e){var t=new Date,n=t.getYear(),o=t.getMonth()+1,r=t.getDate();return n<2e3&&(n=1900+n),o<10&&(o="0"+o),r<10&&(r="0"+r),e.opts.dateFormat.replace(/year/i,n).replace(/month/i,o).replace(/day/i,r)},exec:function(){this.insertText(l.date._date(this))},txtExec:function(){this.insertText(l.date._date(this))},tooltip:"Insert current date"},time:{_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),o<10&&(o="0"+o),t+":"+n+":"+o},exec:function(){this.insertText(l.time._time())},txtExec:function(){this.insertText(l.time._time())},tooltip:"Insert current time"},ltr:{state:function(e,t){return t&&"ltr"===t.style.direction},exec:function(){var e=this.getRangeHelper().getFirstBlockParent(),n=t(e);this.focus(),(e&&!n.is("body")||(this.execCommand("formatBlock","p"),e=this.getRangeHelper().getFirstBlockParent(),n=t(e),e&&!n.is("body")))&&("ltr"===n.css("direction")?n.css("direction",""):n.css("direction","ltr"))},tooltip:"Left-to-Right"},rtl:{state:function(e,t){return t&&"rtl"===t.style.direction},exec:function(){var e=this.getRangeHelper().getFirstBlockParent(),n=t(e);this.focus(),(e&&!n.is("body")||(this.execCommand("formatBlock","p"),e=this.getRangeHelper().getFirstBlockParent(),n=t(e),e&&!n.is("body")))&&("rtl"===n.css("direction")?n.css("direction",""):n.css("direction","rtl"))},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize())},txtExec:function(){this.maximize(!this.maximize())},tooltip:"Maximize",shortcut:"Ctrl+Shift+M"},source:{state:function(){return this.sourceMode()},exec:function(){this.toggleSourceMode()},txtExec:function(){this.toggleSourceMode()},tooltip:"View source",shortcut:"Ctrl+Shift+S"},ignore:{}};return l}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";return{toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist,indent,outdent|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:n(1)("html").attr("lang")||"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,spellcheck:!0,runWithoutWysiwygSupport:!1,startInSourceMode:!1,id:null,plugins:"",zIndex:null,bbcodeTrim:!1,disableBlockRemove:!1,parserOptions:{},dropDownCss:{}}}.call(t,n,t,e))||(e.exports=o)}]),function(e,t,n){"use strict";var o=e.sceditor,r=o.plugins,i=o.escapeEntities,l=o.escapeUriScheme,a=o.ie,s=a&&a<11,c=o.command.get,u={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(e){var t=this;c("font")._dropDown(t,e,function(e){t.insertText("[font="+e+"]","[/font]")})}},size:{txtExec:function(e){var t=this;c("size")._dropDown(t,e,function(e){t.insertText("[size="+e+"]","[/size]")})}},color:{txtExec:function(e){var t=this;c("color")._dropDown(t,e,function(e){t.insertText("[color="+e+"]","[/color]")})}},bgcolor:{txtExec:function(e){var t=this;c("bgcolor")._dropDown(t,e,function(e){t.insertText("[bgcolor="+e+"]","[/bgcolor]")})}},bulletlist:{txtExec:function(t,n){var o="";e.each(n.split(/\r?\n/),function(){o+=(o?"\n":"")+"[li]"+this+"[/li]"}),this.insertText("[ul]\n"+o+"\n[/ul]")}},orderedlist:{txtExec:function(t,n){var o="";e.each(n.split(/\r?\n/),function(){o+=(o?"\n":"")+"[li]"+this+"[/li]"}),r.bbcode.bbcode.get(""),this.insertText("[ol]\n"+o+"\n[/ol]")}},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(e,t){var n=prompt(this._("Enter the image URL:"),t);n&&this.insertText("[img]"+n+"[/img]")}},email:{txtExec:function(e,t){var n=t&&t.indexOf("@")>-1?null:t,o=prompt(this._("Enter the e-mail address:"),n?"":t),r=prompt(this._("Enter the displayed text:"),n||o)||o;o&&this.insertText("[email="+o+"]"+r+"[/email]")}},link:{txtExec:function(t,n){var o=/^[a-z]+:\/\//i.test(e.trim(n))?null:n,r=prompt(this._("Enter URL:"),o?"http://":e.trim(n)),i=prompt(this._("Enter the displayed text:"),o||r)||r;r&&this.insertText("[url="+r+"]"+i+"[/url]")}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(e){var t=this;c("youtube")._dropDown(t,e,function(e){t.insertText("[youtube]"+e+"[/youtube]")})}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}},d=function(e){return e?e.replace(/\\(.)/g,"$1").replace(/^(["'])(.*?)\1$/,"$2"):e},f=function(){var e=arguments;return e[0].replace(/\{(\d+)\}/g,function(t,n){return void 0!==e[n-0+1]?e[n-0+1]:"{"+n+"}"})},p="open",h="content",m="newline",g="close",v=function(e,t,n,o,r,i){var l=this;l.type=e,l.name=t,l.val=n,l.attrs=o||{},l.children=r||[],l.closing=i||null};v.prototype={clone:function(e){var t=this;return new v(t.type,t.name,t.val,t.attrs,e?t.children:[],t.closing?t.closing.clone():null)},splitAt:function(t){var n,o=0,r=this.children.length;if("number"!=typeof t&&(t=e.inArray(t,this.children)),t<0||t>r)return null;for(;r--;)r>=t?o++:r=0;return(n=this.clone()).children=this.children.splice(t,o),n}};var b=function(t){if(!(this instanceof b))return new b(t);var o,l,c,u,f,y,x,w,C,k,S,E,T,D,M,R=this;o=function(){R.bbcodes=r.bbcode.bbcodes,R.opts=e.extend({},b.defaults,t)},R.tokenize=function(e){var t,n,o,r=[],i=[{type:g,regex:/^\[\/[^\[\]]+\]/},{type:p,regex:/^\[[^\[\]]+\]/},{type:m,regex:/^(\r\n|\r|\n)/},{type:h,regex:/^([^\[\r\n]+|\[)/}];i.reverse();e:for(;e.length;){for(o=i.length;o--;)if(n=i[o].type,(t=e.match(i[o].regex))&&t[0]){r.push(l(n,t[0])),e=e.substr(t[0].length);continue e}e.length&&r.push(l(h,e)),e=""}return r},l=function(t,n){var o,i,l;return t===p&&(o=n.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/))&&(l=D(o[1]),o[2]&&(o[2]=e.trim(o[2]))&&(i=c(o[2]))),t===g&&(o=n.match(/\[\/([^\[\]]+)\]/))&&(l=D(o[1])),t===m&&(l="#newline"),l&&(t!==p&&t!==g||r.bbcode.bbcodes[l])||(t=h,l="#"),new v(t,l,n,i)},c=function(e){var t,n=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,o={};if("="===e.charAt(0)&&e.indexOf("=",1)<0)o.defaultattr=d(e.substr(1));else for("="===e.charAt(0)&&(e="defaultattr"+e);t=n.exec(e);)o[D(t[1])]=d(t[3])||t[4];return o},R.parse=function(e,t){var n=u(R.tokenize(e)),o=R.opts;return o.fixInvalidChildren&&C(n),o.removeEmptyTags&&w(n),o.fixInvalidNesting&&y(n),f(n,null,t),o.removeEmptyTags&&w(n),n},E=function(e,t,n){for(var o=n.length;o--;)if(n[o].type===t&&n[o].name===e)return!0;return!1},x=function(t,n){var o=(t?R.bbcodes[t.name]:{}).allowedChildren;return!R.opts.fixInvalidChildren||!o||e.inArray(n.name||"#",o)>-1},u=function(t){for(var n,o,r,i,l,a,s=[],c=[],u=[],d=function(){return M(u)},f=function(e){d()?d().children.push(e):c.push(e)},v=function(t){return d()&&(o=R.bbcodes[d().name])&&o.closedBy&&e.inArray(t,o.closedBy)>-1};n=t.shift();){switch(a=t[0],n.type){case p:v(n.name)&&u.pop(),f(n),(o=R.bbcodes[n.name])&&o.isSelfClosing||!o.closedBy&&!E(n.name,g,t)?o&&o.isSelfClosing||(n.type=h):u.push(n);break;case g:if(d()&&n.name!==d().name&&v("/"+n.name)&&u.pop(),d()&&n.name===d().name)d().closing=n,u.pop();else if(E(n.name,p,u)){for(;r=u.pop();){if(r.name===n.name){r.closing=n;break}i=r.clone(),s.length&&i.children.push(M(s)),s.push(i)}for(f(M(s)),l=s.length;l--;)u.push(s[l]);s.length=0}else n.type=h,f(n);break;case m:d()&&a&&v((a.type===g?"/":"")+a.name)&&(a.type===g&&a.name===d().name||((o=R.bbcodes[d().name])&&o.breakAfter?u.pop():o&&!1===o.isInline&&R.opts.breakAfterBlock&&!1!==o.breakAfter&&u.pop())),f(n);break;default:f(n)}n}return c},f=function(e,t,n){var o,r,i,l,a,s,c,u,d=e.length;t&&(l=R.bbcodes[t.name]);for(var h=d;h--;)if(o=e[h])if(o.type===m){if(r=h>0?e[h-1]:null,i=h<d-1?e[h+1]:null,u=!1,!n&&l&&!0!==l.isSelfClosing&&(r?s||i||(!1===l.isInline&&R.opts.breakEndBlock&&!1!==l.breakEnd&&(u=!0),l.breakEnd&&(u=!0),s=u):(!1===l.isInline&&R.opts.breakStartBlock&&!1!==l.breakStart&&(u=!0),l.breakStart&&(u=!0))),r&&r.type===p&&(a=R.bbcodes[r.name])&&(n?!1===a.isInline&&(u=!0):(!1===a.isInline&&R.opts.breakAfterBlock&&!1!==a.breakAfter&&(u=!0),a.breakAfter&&(u=!0))),!n&&!c&&i&&i.type===p&&(a=R.bbcodes[i.name])&&(!1===a.isInline&&R.opts.breakBeforeBlock&&!1!==a.breakBefore&&(u=!0),a.breakBefore&&(u=!0),c=u,u)){e.splice(h,1);continue}u&&e.splice(h,1),c=!1}else o.type===p&&f(o.children,o,n)},y=function(t,n,o,r){var i,l,a,s,c,u,d=function(e){var t=R.bbcodes[e.name];return!t||!1!==t.isInline};for(n=n||[],r=r||t,l=0;l<t.length;l++)if((i=t[l])&&i.type===p){if(!d(i)&&o&&(u=(a=M(n)).splitAt(i),c=n.length>1?n[n.length-2].children:r,(s=e.inArray(a,c))>-1))return u.children.splice(e.inArray(i,u.children),1),void c.splice(s+1,0,i,u);n.push(i),y(i.children,n,o||d(i),r),n.pop(i)}},C=function(e,t){for(var n,o,r=e.length;r--;)(n=e[r])&&(x(t,n)||(n.name=null,n.type=h,x(t,n)?(o=[r+1,0].concat(n.children),n.closing&&(n.closing.name=null,n.closing.type=h,o.push(n.closing)),r+=o.length-1,Array.prototype.splice.apply(e,o)):t.children.splice(r,1)),n.type===p&&C(n.children,n))},w=function(t){for(var n,o,r=function(e){for(var t=e.length;t--;){var n=e[t].type;if(n===p||n===g)return!1;if(n===h&&/\S|\u00A0/.test(e[t].val))return!1}return!0},i=t.length;i--;)(n=t[i])&&n.type===p&&(o=R.bbcodes[n.name],w(n.children),r(n.children)&&o&&!o.isSelfClosing&&!o.allowsEmpty&&t.splice.apply(t,e.merge([i,1],n.children)))},R.toHTML=function(e,t){return k(R.parse(e,t),!0)},k=function(t,o){var l,c,u,d,f,h,g,v,b=[];for(g=function(e){return!1!==(!e||(void 0!==e.isHtmlInline?e.isHtmlInline:e.isInline))};t.length>0;)if(l=t.shift()){if(l.type===p)v=l.children[l.children.length-1]||{},c=R.bbcodes[l.name],f=o&&g(c),u=k(l.children,!1),c&&c.html?(g(c)||!g(R.bbcodes[v.name])||c.isPreFormatted||c.skipLastLineBreak||s||(u+="<br />"),e.isFunction(c.html)?d=c.html.call(R,l,l.attrs,u):(l.attrs[0]=u,d=r.bbcode.formatBBCodeString(c.html,l.attrs))):d=l.val+u+(l.closing?l.closing.val:"");else{if(l.type===m){if(!o){b.push("<br />");continue}h||(b.push("<div>"),(a<8||n.documentMode&&n.documentMode<8)&&b.push(" ")),s||b.push("<br />"),t.length||b.push("<br />"),b.push("</div>\n"),h=!1;continue}f=o,d=i(l.val,!0)}f&&!h?(b.push("<div>"),h=!0):!f&&h&&(b.push("</div>\n"),h=!1),b.push(d)}return h&&b.push("</div>\n"),b.join("")},R.toBBCode=function(e,t){return S(R.parse(e,t))},S=function(e){for(var t,n,o,r,i,l,a,s,c,u,d=[];e.length>0;)if(t=e.shift())if(r=!(!(o=R.bbcodes[t.name])||!1!==o.isInline),i=o&&o.isSelfClosing,a=r&&R.opts.breakBeforeBlock&&!1!==o.breakBefore||o&&o.breakBefore,s=r&&!i&&R.opts.breakStartBlock&&!1!==o.breakStart||o&&o.breakStart,c=r&&R.opts.breakEndBlock&&!1!==o.breakEnd||o&&o.breakEnd,u=r&&R.opts.breakAfterBlock&&!1!==o.breakAfter||o&&o.breakAfter,l=(o?o.quoteType:null)||R.opts.quoteType||b.QuoteType.auto,o||t.type!==p)if(t.type===p){if(a&&d.push("\n"),d.push("["+t.name),t.attrs)for(n in t.attrs.defaultattr&&(d.push("=",T(t.attrs.defaultattr,l,"defaultattr")),delete t.attrs.defaultattr),t.attrs)t.attrs.hasOwnProperty(n)&&d.push(" ",n,"=",T(t.attrs[n],l,n));d.push("]"),s&&d.push("\n"),t.children&&d.push(S(t.children)),i||o.excludeClosing||(c&&d.push("\n"),d.push("[/"+t.name+"]")),u&&d.push("\n"),t.closing&&i&&d.push(t.closing.val)}else d.push(t.val);else d.push(t.val),t.children&&d.push(S(t.children)),t.closing&&d.push(t.closing.val);return d.join("")},T=function(t,n,o){var r=b.QuoteType,i=/\s|=/.test(t);return e.isFunction(n)?n(t,o):n===r.never||n===r.auto&&!i?t:'"'+t.replace("\\","\\\\").replace('"','\\"')+'"'},M=function(e){return e.length?e[e.length-1]:null},D=function(e){return e.toLowerCase()},o()};b.QuoteType={always:1,never:2,auto:3},b.defaults={breakBeforeBlock:!1,breakStartBlock:!1,breakEndBlock:!1,breakAfterBlock:!0,removeEmptyTags:!0,fixInvalidNesting:!0,fixInvalidChildren:!0,quoteType:b.QuoteType.auto},e.sceditorBBCodePlugin=r.bbcode=function(){var t,i,l,a,c=this;c.bbcodes=r.bbcode.bbcodes,c.stripQuotes=d;var p={},h={},m={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]};c.init=function(){c.opts=this.opts,t(),this.commands=e.extend(!0,{},u,this.commands),this.toBBCode=c.signalToSource,this.fromBBCode=c.signalToWysiwyg},t=function(){e.each(c.bbcodes,function(t){var n,o=c.bbcodes[t].tags,r=c.bbcodes[t].styles;o&&e.each(o,function(e,o){n=!1===c.bbcodes[t].isInline,p[e]=p[e]||{},p[e][n]=p[e][n]||{},p[e][n][t]=o}),r&&e.each(r,function(e,o){n=!1===c.bbcodes[t].isInline,h[n]=h[n]||{},h[n][e]=h[n][e]||{},h[n][e][t]=o})})},i=function(t,n,r){var i,l,a=o.dom.getStyle;return h[r=!!r]?(e.each(h[r],function(o,r){(i=a(t[0],o))&&a(t.parent()[0],o)!==i&&e.each(r,function(o,r){(!r||e.inArray(i.toString(),r)>-1)&&(l=c.bbcodes[o].format,n=e.isFunction(l)?l.call(c,t,n):f(l,n))})}),n):n},l=function(t,n,r){var i,l,a=t[0],u=a.nodeName.toLowerCase();r=!!r,p[u]&&p[u][r]&&e.each(p[u][r],function(o,r){r&&(i=!1,e.each(r,function(n,o){if(t.attr(n)&&!(o&&e.inArray(t.attr(n),o)<0))return i=!0,!1}),!i)||(l=c.bbcodes[o].format,n=e.isFunction(l)?l.call(c,t,n):f(l,n))});var d=o.dom.isInline;if(r&&(!d(a,!0)||"br"===u)){for(var h,m,g=a.previousSibling;g&&1===g.nodeType&&!e(g).is("br")&&d(g,!0)&&!g.firstChild;)g=g.previousSibling;do{h=(m=a.parentNode).lastChild===a,a=m}while(m&&h&&d(m,!0));(!h||"li"===u||"br"===u&&s)&&(n+="\n"),"br"!==u&&g&&!e(g).is("br")&&d(g,!0)&&(n="\n"+n)}return n},c.signalToSource=function(t,r){var i,l,a=new b(c.opts.parserOptions);return r||(r="string"==typeof t?i=e("<div />").css("visibility","hidden").appendTo(n.body).html(t):e(t)),r&&r.jquery?(o.dom.removeWhiteSpace(r[0]),e(".sceditor-ignore",r).remove(),l=c.elementToBbcode(r),i&&i.remove(),l=a.toBBCode(l,!0),c.opts.bbcodeTrim&&(l=e.trim(l)),l):""},c.elementToBbcode=function(t){var n=function(t,r){var a="";return o.dom.traverse(t,function(t){var o=e(t),c="",u=t.nodeType,d=t.nodeName.toLowerCase(),f=m[d],p=t.firstChild,h=!0;if("object"==typeof r&&(h=e.inArray(d,r)>-1,o.is("img")&&o.data("sceditor-emoticon")&&(h=!0),h||(f=r)),3===u||1===u)if(1===u){if(o.hasClass("sceditor-nlf")&&(!p||!s&&1===t.childNodes.length&&/br/i.test(p.nodeName)))return;"iframe"!==d&&(c=n(t,f)),h?("code"!==d&&(c=i(o,c),c=l(o,c),c=i(o,c,!0)),a+=l(o,c,!0)):a+=c}else a+=t.nodeValue},!1,!0),a};return n(t[0])},c.signalToWysiwyg=function(t,n){var o=new b(c.opts.parserOptions).toHTML(c.opts.bbcodeTrim?e.trim(t):t);return n?a(o):o},a=function(t){var r,i,l,a=e("<div />").hide().appendTo(n.body),c=a[0];l=function(t,r){if(!o.dom.hasStyling(t)){if(s||1!==t.childNodes.length||!e(t.firstChild).is("br"))for(;i=t.firstChild;)c.insertBefore(i,t);if(r){var l=c.lastChild;t!==l&&e(l).is("div")&&t.nextSibling===l&&c.insertBefore(n.createElement("br"),t)}c.removeChild(t)}};return void 0!==t&&(t=t.replace(/src=/g,"tmpsrctmp=")),c.innerHTML=t.replace(/<\/div>\n/g,"</div>"),(r=c.firstChild)&&e(r).is("div")&&l(r,!0),(r=c.lastChild)&&e(r).is("div")&&l(r),c=c.innerHTML,a.remove(),void 0!==c&&(c=c.replace(/tmpsrctmp=/g,"src=")),c}},r.bbcode.formatBBCodeString=function(e,t){return e.replace(/\{([^}]+)\}/g,function(e,n){var o=!0;return"!"===n.charAt(0)&&(o=!1,n=n.substring(1)),"0"===n&&(o=!1),void 0===t[n]?e:o?i(t[n],!0):t[n]})};var y=function(e){return e=parseInt(e,10),isNaN(e)?"00":(e=Math.max(0,Math.min(e,255)).toString(16)).length<2?"0"+e:e},x=function(e){var t;return(t=(e=e||"#000").match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))?"#"+y(t[1])+y(t[2]-0)+y(t[3]-0):(t=e.match(/#([0-f])([0-f])([0-f])\s*?$/i))?"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:e},w={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:b.QuoteType.never,format:function(e,t){var n;return e.is("font")&&(n=e.attr("face"))||(n=e.css("font-family")),"[font="+d(n)+"]"+t+"[/font]"},html:'<font face="{defaultattr}">{0}</font>'},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(e,t){var n=e.attr("size"),o=2;return n||(n=e.css("fontSize")),n.indexOf("px")>-1?((n=n.replace("px","")-0)<12&&(o=1),n>15&&(o=3),n>17&&(o=4),n>23&&(o=5),n>31&&(o=6),n>47&&(o=7)):o=n,"[size="+o+"]"+t+"[/size]"},html:'<font size="{defaultattr}">{!0}</font>'},color:{tags:{font:{color:null}},styles:{color:null},quoteType:b.QuoteType.never,format:function(e,t){var n;return e.is("font")&&(n=e.attr("color"))||(n=e[0].style.color||e.css("color")),"[color="+x(n)+"]"+t+"[/color]"},html:function(e,t,n){return'<font color="'+i(x(t.defaultattr),!0)+'">'+n+"</font>"}},ul:{tags:{ul:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:!0,isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:!1,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:!1,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:!1,isHtmlInline:!0,skipLastLineBreak:!0,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:!1,skipLastLineBreak:!0,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:!0,isInline:!1,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:!0,isInline:!1,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:!0,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(e,t){return e.data("sceditor-emoticon")+t},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:!0,isSelfClosing:!0,isInline:!1,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:!0,tags:{img:{src:null}},allowedChildren:["#"],quoteType:b.QuoteType.never,format:function(e,t){var n,o,r="",i=e[0],l=function(e){return i.style?i.style[e]:null};if(e.attr("data-sceditor-emoticon"))return t;n=e.attr("width")||l("width"),o=e.attr("height")||l("height"),(i.complete&&(n||o)||n&&o)&&(r="="+e.width()+"x"+e.height());var a=e.attr("src");return"data:"==a.substr(0,5)?"":("'"==a.substr(0,1)&&(a=a.substr(1)),"'"==a.substr(-1,1)&&(a=a.substr(0,a.length-1)),"[img"+r+"]"+a+"[/img]")},html:function(e,t,n){var o,r,a,s="";return o=t.width,r=t.height,t.defaultattr&&(o=(a=t.defaultattr.split(/x/i))[0],r=2===a.length?a[1]:a[0]),void 0!==o&&(s+=' width="'+i(o,!0)+'"'),void 0!==r&&(s+=' height="'+i(r,!0)+'"'),"data:"==n.substr(0,5)?"":"<img"+s+' src="'+l(n)+'" />'}},url:{allowsEmpty:!0,tags:{a:{href:null}},quoteType:b.QuoteType.never,format:function(e,t){var n=e.attr("href");return"mailto:"===n.substr(0,7)?'[email="'+n.substr(7)+'"]'+t+"[/email]":"[url="+n+"]"+t+"[/url]"},html:function(e,t,n){return t.defaultattr=i(t.defaultattr,!0)||n,'<a href="'+l(t.defaultattr)+'">'+n+"</a>"}},email:{quoteType:b.QuoteType.never,html:function(e,t,n){return'<a href="mailto:'+(i(t.defaultattr,!0)||n)+'">'+n+"</a>"}},quote:{tags:{blockquote:null},isInline:!1,quoteType:b.QuoteType.never,format:function(t,n){var o="",r=e(t),i=r.children("cite").first();return(1===i.length||r.data("author"))&&(o=i.text()||r.data("author"),r.data("author",o),i.remove(),n=this.elementToBbcode(e(t)),o="="+o.replace(/(^\s+|\s+$)/g,""),r.prepend(i)),"[quote"+o+"]"+n+"[/quote]"},html:function(e,t,n){return t.defaultattr&&(n="<cite>"+i(t.defaultattr)+"</cite>"+n),"<blockquote>"+n+"</blockquote>"}},code:{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:!1,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:!1,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:!1,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:!1,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:!0,tags:{iframe:{"data-youtube-id":null}},format:function(e,t){return(e=e.attr("data-youtube-id"))?"[youtube]"+e+"[/youtube]":t},html:'<iframe width="560" height="315" frameborder="0" src="https://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}};r.bbcode.bbcode={get:function(e){return w[e]||null},set:function(t,n){return!(!t||!n)&&((n=e.extend(w[t]||{},n)).remove=function(){delete w[t]},w[t]=n,this)},rename:function(e,t){return e in w&&(w[t]=w[e],delete w[e],this)},remove:function(e){return e in w&&delete w[e],this}},e.fn.sceditorBBCodePlugin=function(t){return t=t||{},e.isPlainObject(t)&&(t.plugins=(t.plugins||"")+"bbcode"),this.sceditor(t)},r.bbcode.normaliseColour=x,r.bbcode.formatString=f,r.bbcode.stripQuotes=d,r.bbcode.bbcodes=w,o.BBCodeParser=b}(jQuery,window,document);