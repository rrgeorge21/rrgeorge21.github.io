/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{var t={727:()=>{!function(t){var e=function(e){this._options={checkOnLoad:!1,resetOnEnd:!1,loopCheckTime:50,loopMaxNumber:5,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1},this._var={version:"3.2.1",bait:null,checking:!1,loop:null,loopNumber:0,event:{detected:[],notDetected:[]}},void 0!==e&&this.setOption(e);var n=this,i=function(){setTimeout((function(){!0===n._options.checkOnLoad&&(!0===n._options.debug&&n._log("onload->eventCallback","A check loading is launched"),null===n._var.bait&&n._creatBait(),setTimeout((function(){n.check()}),1))}),1)};void 0!==t.addEventListener?t.addEventListener("load",i,!1):t.attachEvent("onload",i)};e.prototype._options=null,e.prototype._var=null,e.prototype._bait=null,e.prototype._log=function(t,e){console.log("[BlockAdBlock]["+t+"] "+e)},e.prototype.setOption=function(t,e){if(void 0!==e){var n=t;(t={})[n]=e}for(var i in t)this._options[i]=t[i],!0===this._options.debug&&this._log("setOption",'The option "'+i+'" he was assigned to "'+t[i]+'"');return this},e.prototype._creatBait=function(){var e=document.createElement("div");e.setAttribute("class",this._options.baitClass),e.setAttribute("style",this._options.baitStyle),this._var.bait=t.document.body.appendChild(e),this._var.bait.offsetParent,this._var.bait.offsetHeight,this._var.bait.offsetLeft,this._var.bait.offsetTop,this._var.bait.offsetWidth,this._var.bait.clientHeight,this._var.bait.clientWidth,!0===this._options.debug&&this._log("_creatBait","Bait has been created")},e.prototype._destroyBait=function(){t.document.body.removeChild(this._var.bait),this._var.bait=null,!0===this._options.debug&&this._log("_destroyBait","Bait has been removed")},e.prototype.check=function(t){if(void 0===t&&(t=!0),!0===this._options.debug&&this._log("check","An audit was requested "+(!0===t?"with a":"without")+" loop"),!0===this._var.checking)return!0===this._options.debug&&this._log("check","A check was canceled because there is already an ongoing"),!1;this._var.checking=!0,null===this._var.bait&&this._creatBait();var e=this;return this._var.loopNumber=0,!0===t&&(this._var.loop=setInterval((function(){e._checkBait(t)}),this._options.loopCheckTime)),setTimeout((function(){e._checkBait(t)}),1),!0===this._options.debug&&this._log("check","A check is in progress ..."),!0},e.prototype._checkBait=function(e){var n=!1;if(null===this._var.bait&&this._creatBait(),null===t.document.body.getAttribute("abp")&&null!==this._var.bait.offsetParent&&0!=this._var.bait.offsetHeight&&0!=this._var.bait.offsetLeft&&0!=this._var.bait.offsetTop&&0!=this._var.bait.offsetWidth&&0!=this._var.bait.clientHeight&&0!=this._var.bait.clientWidth||(n=!0),void 0!==t.getComputedStyle){var i=t.getComputedStyle(this._var.bait,null);!i||"none"!=i.getPropertyValue("display")&&"hidden"!=i.getPropertyValue("visibility")||(n=!0)}!0===this._options.debug&&this._log("_checkBait","A check ("+(this._var.loopNumber+1)+"/"+this._options.loopMaxNumber+" ~"+(1+this._var.loopNumber*this._options.loopCheckTime)+"ms) was conducted and detection is "+(!0===n?"positive":"negative")),!0===e&&(this._var.loopNumber++,this._var.loopNumber>=this._options.loopMaxNumber&&this._stopLoop()),!0===n?(this._stopLoop(),this._destroyBait(),this.emitEvent(!0),!0===e&&(this._var.checking=!1)):null!==this._var.loop&&!1!==e||(this._destroyBait(),this.emitEvent(!1),!0===e&&(this._var.checking=!1))},e.prototype._stopLoop=function(t){clearInterval(this._var.loop),this._var.loop=null,this._var.loopNumber=0,!0===this._options.debug&&this._log("_stopLoop","A loop has been stopped")},e.prototype.emitEvent=function(t){!0===this._options.debug&&this._log("emitEvent","An event with a "+(!0===t?"positive":"negative")+" detection was called");var e=this._var.event[!0===t?"detected":"notDetected"];for(var n in e)!0===this._options.debug&&this._log("emitEvent","Call function "+(parseInt(n)+1)+"/"+e.length),e.hasOwnProperty(n)&&e[n]();return!0===this._options.resetOnEnd&&this.clearEvent(),this},e.prototype.clearEvent=function(){this._var.event.detected=[],this._var.event.notDetected=[],!0===this._options.debug&&this._log("clearEvent","The event list has been cleared")},e.prototype.on=function(t,e){return this._var.event[!0===t?"detected":"notDetected"].push(e),!0===this._options.debug&&this._log("on",'A type of event "'+(!0===t?"detected":"notDetected")+'" was added'),this},e.prototype.onDetected=function(t){return this.on(!0,t)},e.prototype.onNotDetected=function(t){return this.on(!1,t)},t.BlockAdBlock=e,void 0===t.blockAdBlock&&(t.blockAdBlock=new e({checkOnLoad:!0,resetOnEnd:!0}))}(window)},741:(t,e,n)=>{var i;!function(t){!function(e){var i="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=o(t);function o(t,e){return function(n,i){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:i}),e&&e(n,i)}}void 0===i.Reflect?i.Reflect=t:r=o(i.Reflect,r),function(t){var e=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!o&&!s,c={create:o?function(){return N(Object.create(null))}:s?function(){return N({__proto__:null})}:function(){return N({})},has:a?function(t,n){return e.call(t,n)}:function(t,e){return e in t},get:a?function(t,n){return e.call(t,n)?t[n]:void 0}:function(t,e){return t[e]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[r]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var i=this._keys.length,r=n+1;r<i;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,i)},e.prototype.values=function(){return new n(this._keys,this._values,o)},e.prototype.entries=function(){return new n(this._keys,this._values,s)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[r]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function i(t,e){return t}function o(t,e){return e}function s(t,e){return[t,e]}}():Map,p=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new d}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[r]=function(){return this.keys()},t}():Set,h=new(l||"function"!=typeof WeakMap?function(){var t=16,n=c.create(),i=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){var t;do{t="@@WeakMap@@"+a()}while(c.has(n,t));return n[t]=!0,t}function o(t,n){if(!e.call(t,i)){if(!n)return;Object.defineProperty(t,i,{value:c.create()})}return t[i]}function s(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function a(){var e,n=(e=t,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e));n[6]=79&n[6]|64,n[8]=191&n[8]|128;for(var i="",r=0;r<t;++r){var o=n[r];4!==r&&6!==r&&8!==r||(i+="-"),o<16&&(i+="0"),i+=o.toString(16).toLowerCase()}return i}}():WeakMap);function f(t,e,n){var i=h.get(t);if(E(i)){if(!n)return;i=new d,h.set(t,i)}var r=i.get(e);if(E(r)){if(!n)return;r=new d,i.set(e,r)}return r}function g(t,e,n){if(m(t,e,n))return!0;var i=R(e);return!k(i)&&g(t,i,n)}function m(t,e,n){var i=f(e,n,!1);return!E(i)&&!!i.has(t)}function v(t,e,n){if(m(t,e,n))return y(t,e,n);var i=R(e);return k(i)?void 0:v(t,i,n)}function y(t,e,n){var i=f(e,n,!1);if(!E(i))return i.get(t)}function b(t,e,n,i){f(n,i,!0).set(t,e)}function w(t,e){var n=_(t,e),i=R(t);if(null===i)return n;var r=w(i,e);if(r.length<=0)return n;if(n.length<=0)return r;for(var o=new p,s=[],a=0,c=n;a<c.length;a++){var u=c[a];o.has(u)||(o.add(u),s.push(u))}for(var l=0,d=r;l<d.length;l++)u=d[l],o.has(u)||(o.add(u),s.push(u));return s}function _(t,e){var n=[],i=f(t,e,!1);if(E(i))return n;for(var o=function(t){var e=L(t,r);if(!C(e))throw new TypeError;var n=e.call(t);if(!T(n))throw new TypeError;return n}(i.keys()),s=0;;){var a=P(o);if(!a)return n.length=s,n;var c=a.value;try{n[s]=c}catch(t){try{D(o)}finally{throw t}}s++}}function S(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function E(t){return void 0===t}function k(t){return null===t}function T(t){return"object"==typeof t?null!==t:"function"==typeof t}function I(t,e){switch(S(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",r=L(t,i);if(void 0!==r){var o=r.call(t,n);if(T(o))throw new TypeError;return o}return function(t,e){if("string"===e){var n=t.toString;if(C(n)&&!T(r=n.call(t)))return r;if(C(i=t.valueOf)&&!T(r=i.call(t)))return r}else{var i;if(C(i=t.valueOf)&&!T(r=i.call(t)))return r;var r,o=t.toString;if(C(o)&&!T(r=o.call(t)))return r}throw new TypeError}(t,"default"===n?"number":n)}function O(t){var e=I(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function x(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function C(t){return"function"==typeof t}function A(t){return"function"==typeof t}function L(t,e){var n=t[e];if(null!=n){if(!C(n))throw new TypeError;return n}}function P(t){var e=t.next();return!e.done&&e}function D(t){var e=t.return;e&&e.call(t)}function R(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===u)return e;if(e!==u)return e;var n=t.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return e;var r=i.constructor;return"function"!=typeof r||r===t?e:r}function N(t){return t.__=void 0,delete t.__,t}t("decorate",(function(t,e,n,i){if(E(n)){if(!x(t))throw new TypeError;if(!A(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var i=(0,t[n])(e);if(!E(i)&&!k(i)){if(!A(i))throw new TypeError;e=i}}return e}(t,e)}if(!x(t))throw new TypeError;if(!T(e))throw new TypeError;if(!T(i)&&!E(i)&&!k(i))throw new TypeError;return k(i)&&(i=void 0),function(t,e,n,i){for(var r=t.length-1;r>=0;--r){var o=(0,t[r])(e,n,i);if(!E(o)&&!k(o)){if(!T(o))throw new TypeError;i=o}}return i}(t,e,n=O(n),i)})),t("metadata",(function(t,e){return function(n,i){if(!T(n))throw new TypeError;if(!E(i)&&!function(t){switch(S(t)){case 3:case 4:return!0;default:return!1}}(i))throw new TypeError;b(t,e,n,i)}})),t("defineMetadata",(function(t,e,n,i){if(!T(n))throw new TypeError;return E(i)||(i=O(i)),b(t,e,n,i)})),t("hasMetadata",(function(t,e,n){if(!T(e))throw new TypeError;return E(n)||(n=O(n)),g(t,e,n)})),t("hasOwnMetadata",(function(t,e,n){if(!T(e))throw new TypeError;return E(n)||(n=O(n)),m(t,e,n)})),t("getMetadata",(function(t,e,n){if(!T(e))throw new TypeError;return E(n)||(n=O(n)),v(t,e,n)})),t("getOwnMetadata",(function(t,e,n){if(!T(e))throw new TypeError;return E(n)||(n=O(n)),y(t,e,n)})),t("getMetadataKeys",(function(t,e){if(!T(t))throw new TypeError;return E(e)||(e=O(e)),w(t,e)})),t("getOwnMetadataKeys",(function(t,e){if(!T(t))throw new TypeError;return E(e)||(e=O(e)),_(t,e)})),t("deleteMetadata",(function(t,e,n){if(!T(e))throw new TypeError;E(n)||(n=O(n));var i=f(e,n,!1);if(E(i))return!1;if(!i.delete(t))return!1;if(i.size>0)return!0;var r=h.get(e);return r.delete(n),r.size>0||h.delete(e),!0}))}(r)}()}(i||(i={}))}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{AD_LABEL_CLASS:()=>Dt,Document:()=>ai,FetchTimeout:()=>ci,GlobalTimeout:()=>Fi,IframeBuilder:()=>qi,LazyQueue:()=>Zi,ScriptLoader:()=>ir,Targeting:()=>cr,WaitFor:()=>Vr,assetLoader:()=>_n,base64:()=>Sn,buildPromisedTimeout:()=>er,buildVastUrl:()=>Or,client:()=>zn,createExtendedPromise:()=>fi,createWithTimeout:()=>hi,debounce:()=>Kn,decorate:()=>qn,defer:()=>li,generateUniqueId:()=>gi,getContinentCode:()=>vi,getCountryCode:()=>mi,getCustomParameters:()=>Ir,getElementOffset:()=>Jn,getGlobalValue:()=>wi,getHeight:()=>Xn,getLeftOffset:()=>ti,getRegionCode:()=>yi,getServicesBaseURL:()=>or,getTimeDelta:()=>Bi,getTimeDeltaFixed:()=>Gi,getTimeOrigin:()=>$i,getTopOffset:()=>Zn,getTranslation:()=>Ki,getViewportHeight:()=>ei,getViewportWidth:()=>ni,getWidth:()=>Yn,isCoppaSubject:()=>Xi,isIframe:()=>oi,isInTheSameViewport:()=>ri,isInViewport:()=>ii,isProperCountry:()=>bi,logger:()=>Ui,makeLazyQueue:()=>Ji,once:()=>di,outboundTrafficRestrict:()=>tr,pageInIframe:()=>si,queryString:()=>p,sampler:()=>nr,scriptLoader:()=>rr,stringBuilder:()=>ar,targeting:()=>ur,timedPartnerScriptLoader:()=>lr,timeoutReject:()=>pi,tryProperty:()=>pr,uuid:()=>Nr,viewportObserver:()=>Mr,wait:()=>ui,warner:()=>Hi,whichProperty:()=>dr,withDebounce:()=>Wn});var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},e(t,n)};function i(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}function r(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function o(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function s(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))}function a(t,e){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function c(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}function l(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function d(t){return this instanceof d?(this.v=t,this):new d(t)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const p=new class{constructor(){this.cache=new Map}getValues(t){return[...this.getURLSearchParams(t).entries()].reduce(((t,[e,n])=>(t[e]=n,t)),{})}getURLSearchParams(t){const e=t||window.location.search.substring(1);return this.cache.has(e)||this.cache.set(e,new URLSearchParams(e)),this.cache.get(e)}get(t,e){return this.getURLSearchParams(e).get(t)||""}isUrlParamSet(t,e){return!!parseInt(this.get(t,e),10)}stringify(t){const e=new URLSearchParams(t);return e.sort(),e.toString()}};function h(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}var f=function t(e,n){function i(t,i,r){if("undefined"!=typeof document){"number"==typeof(r=h({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in r)r[s]&&(o+="; "+s,!0!==r[s]&&(o+="="+r[s].split(";")[0]));return document.cookie=t+"="+e.write(i,t)+o}}return Object.create({set:i,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],i={},r=0;r<n.length;r++){var o=n[r].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(i[a]=e.read(s,a),t===a)break}catch(t){}}return t?i[t]:i}},remove:function(t,e){i(t,"",h({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,h({},this.attributes,e))},withConverter:function(e){return t(h({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});class g{constructor(){this.cacheMaxAge=18e5,this.keysSeen=new Set}getItem(t){return f.get(t)}setItem(t,e,n){const i=n||this.cacheMaxAge,r={expires:new Date((new Date).getTime()+i),path:"/",domain:this.getCookieDomain(),overwrite:!0};this.keysSeen.add(t),f.set(t,e,r)}removeItem(t){this.keysSeen.delete(t),f.remove(t,{path:"/",domain:this.getCookieDomain()})}clear(){this.keysSeen.forEach((t=>{this.removeItem(t)}))}getCookieDomain(){const t=window.location.hostname.split(".");return t.length>1?`.${t[t.length-2]}.${t[t.length-1]}`:void 0}}const m=new g;function v(){return p.get("adengine_debug")||m.getItem("adengine_debug")}function y(t){null!==t?m.setItem("adengine_debug",t||"1"):m.removeItem("adengine_debug")}const b={isDebugMode:function(){return Boolean(v())},getDebugGroup:v,setDebugMode:y};window.ads=window.ads||{},window.ads.debug=y;const w={adUnitId:"",bidders:{enabled:!1,timeout:2e3,a9:{enabled:!1,videoEnabled:!1,amazonId:"3115",bidsRefreshing:{slots:[]}},prebid:{enabled:!1,bidsRefreshing:{slots:[]}}},events:{},listeners:{porvata:[]},options:{customAdLoader:{globalMethodName:"loadCustomAd"},maxDelayTimeout:2e3,optOutSale:!1,trackingOptIn:!1,isSubjectToCcpa:!1},services:{},slots:{},src:["gpt"],state:{adStack:[],isMobile:!1},targeting:{},vast:{size:[640,480],adUnitId:""}},_={};function S(t,e,n){let i="";e.forEach((e=>{i+=(""===i?"":".")+e,function(t,e,n){_[t]&&_[t].forEach((t=>{t(e,n)}))}(i,t,n)}))}function E(t,e,n=!1){const i=t.split("."),r=i.length;let o=w,s=null;for(let t=0;t<r;t+=1)s=i[t],t<r-1&&(o[s]=o[s]||{},o=o[s]);return n?(delete o[s],S(t,i,null),null):(void 0!==e&&(o[s]=e,S(t,i,e)),o[s])}const k=new class{constructor(){window.ads=window.ads||{},window.ads.adContext=b.isDebugMode()?w:{}}extend(t){Object.assign(w,t)}set(t,e){E(t,e)}get(t){return E(t)}remove(t){E(t,null,!0)}push(t,e){const n=E(t);n&&n.push(e)}onChange(t,e){_[t]=_[t]||[],_[t].push(e)}removeListeners(t){Object.keys(_).forEach((e=>{e!==t&&0!==e.indexOf(`${t}.`)||delete _[e]}))}};class T{execute(){const t=Object.assign(Object.assign({},window.mw&&window.mw.config?window.mw.config.values:{}),window.ads?window.ads.context:{});k.set("wiki",Object.assign(t,k.get("wiki")))}}function I(t){k.set("geo.region",t.region),k.set("geo.country",t.country),k.set("geo.continent",t.continent)}var O=function(){return O=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},O.apply(this,arguments)};function x(t,e){return Object.defineProperty(e,"type",{value:t,writable:!1})}function C(t){return!0===t.__global}function A(t,e){const n=function(t,e){if("function"==typeof e)return x(t,(function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return O(O({},e.apply(void 0,n)),{type:t})}));switch(e?e._as:"empty"){case"empty":return x(t,(function(){return{type:t}}));case"fsa":return x(t,(function(e,n){return e instanceof Error?{error:!0,meta:n,payload:e,type:t}:{error:!1,meta:n,payload:e,type:t}}));case"payload":return x(t,(function(e){return{payload:e,type:t}}));case"props":return x(t,(function(e){return O(O({},e),{type:t})}));default:throw new Error("Unexpected config.")}}(t,e),i=(...t)=>{const e=n(...t);return Object.assign(Object.assign({},e),{__global:!0})};return Object.defineProperty(i,"type",{value:t,writable:!1}),Object.defineProperty(i,"__global",{value:!0,writable:!1}),i}function L(t,e){return Object.keys(e).forEach((function(n){"default"===n||"__esModule"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})})),t}function P(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}var D={},R={};function N(t){return new Promise((e=>setTimeout((()=>e()),t)))}P(R,"delay",(()=>N));var j={};function M(){const t=new URLSearchParams(window.location.search.substring(1));return Boolean(t.get("adengine_debug"))?t.get("adengine_debug"):t.get("identity_debug")}P(j,"getDebugGroup",(()=>M));var V={};P(V,"localStorageHelper",(()=>$));class ${constructor(t,e=6e4){this.key=t,this.ttlInMilliseconds=e;let n=!1;try{n=void 0!==window.localStorage&&null!==window.localStorage,n&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(t){n=!1}const i=t=>window?.instantConfigCache?.[t]??null,r=(t,e)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[t]=e};this.storageAdapter={getItem:t=>{try{return n?window.localStorage.getItem(t)??i(t):i(t)}catch(e){return i(t)}},setItem:(t,e)=>{try{if(n)return localStorage.setItem(t,e);r(t,e)}catch(n){r(t,e)}}}}set(t){const e=this.getObjectToStore(t);this.storageAdapter.setItem(this.key,JSON.stringify(e))}get(){const t=this.storageAdapter.getItem(this.key);return t?this.parseStoredValue(JSON.parse(t)):null}expired(t){return!t||t<Date.now()}getObjectToStore(t){return{data:t,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(t){return this.expired(t?.ttl)?null:t.data}}var B={};P(B,"lock",(()=>U)),P(B,"release",(()=>H));const G=new $("instant-config-lock",1e3);function U(){return"lock"===G.get()||(G.set("lock"),!1)}function H(){G.set(null)}var F={};P(F,"getTimeDelta",(()=>q)),P(F,"logger",(()=>Q)),P(F,"warner",(()=>Y));const z=M()||"",W=z.split(","),K=Date.now();function q(){return((Date.now()-(window.performance?.timeOrigin??K))/1e3).toFixed(4)}function Q(t,...e){""!==z&&("1"!==z&&-1===W.indexOf(t)||window.console.info(`${q()}s\t\t ${t}`,e))}function Y(t,...e){""!==z&&("1"!==z&&-1===W.indexOf(t)||window.console.warn(t,e))}L(D,R),L(D,j),L(D,V),L(D,B),L(D,F);var X={},J={};P(J,"InstantConfigInterpreter",(()=>Tt));var Z={},tt={};function et(t){return Array.isArray(t)&&t.length>0&&"object"==typeof t[0]}function nt(t){const e=t.sampling??t.s;return"number"==typeof e&&e>0&&e<100}P(tt,"shouldBeListOfConfigGroups",(()=>et)),P(tt,"hasSampling",(()=>nt));var it={};P(it,"negativePrefix",(()=>rt)),P(it,"cacheSuffix",(()=>ot)),P(it,"samplingSeparator",(()=>st)),P(it,"worldWide",(()=>at)),P(it,"precision",(()=>ct)),P(it,"experimentBucketSettingKey",(()=>ut));const rt="non-",ot="-cached",st="/",at="XX",ct=10**6,ut="eb";L(Z,tt),L(Z,{}),L(Z,{}),L(Z,{}),L(Z,{}),L(Z,{}),L(Z,{}),L(Z,it);class lt{constructor(t,e,n){this.container=e,this.settingsRepository=n,"number"==typeof t?this.experimentBucket=this.manageSampling(t):!0===t?this.experimentBucket=this.manageSampling(0):!1===t&&this.clean()}build(){return()=>this.experimentBucket??lt.getRandomBucket()}static getRandomBucket(){return Math.round(100*Math.random())}manageSampling(t){const e=this.readFromLoaderVariable()??this.readFromSettings()??lt.getRandomBucket();return this.storeInLoaderVariable(e),this.storeInSettings(e,t),e}readFromLoaderVariable(){return this.container.fandomContext?.experimentBucket}readFromSettings(){const t=this.settingsRepository&&this.settingsRepository.get(ut);return t&&Number(t)}storeInSettings(t,e){this.settingsRepository&&this.settingsRepository.set(ut,t.toString(),e)}storeInLoaderVariable(t){this.container.fandomContext=this.container.fandomContext||{},this.container.fandomContext.experimentBucket=t}clean(){this.settingsRepository&&this.settingsRepository.remove(ut)}}class dt{activeKeyValues=[];activeLabradorKeyValues=[];constructor(t){Array.isArray(t)?this.keyValueNamesMap=t.map((t=>t&&t.toString().split(":"))).filter((t=>t&&t.length>=2)).reduce(((t,e)=>(t[e[0]]=e[1],t)),{}):this.keyValueNamesMap={}}getActiveKeyValues(){return this.activeKeyValues}getActiveLabradorKeyValues(){return this.activeLabradorKeyValues}mark(t,e,n){const i=`${t}_${n?"B":"A"}_${n?e:100-e}`,r=this.keyValueNamesMap[i]??i;this.activeKeyValues.includes(i)||this.activeKeyValues.push(i),this.activeLabradorKeyValues.includes(r)||this.activeLabradorKeyValues.push(r)}}var pt={},ht={};P(ht,"BrowserMatcher",(()=>mt));var ft={};function gt(t){return t.startsWith(rt)?{value:t.replace(rt,""),negated:!0}:{value:t,negated:!1}}P(ft,"extractNegation",(()=>gt));class mt{constructor(t){this.currentBrowser=t?.toLowerCase()}isValid(t){const e=t.b??t.browsers??[],n=e.map((t=>t.toLowerCase())).map((t=>gt(t)));return 0===e.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,n)&&n.some((t=>this.currentBrowser.includes(t.value)!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var vt={};P(vt,"DeviceMatcher",(()=>yt));class yt{constructor(t){this.currentDevice=t}isValid(t){const e=(t.d??t.devices??[]).map((t=>t.toLowerCase())).map((t=>gt(t)));return 0===e.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,e)&&e.some((t=>t.value===this.currentDevice!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var bt={};P(bt,"DomainMatcher",(()=>wt));class wt{isValid(t){const e=t.o??t.domains??[];return 0===e.length||e.some((t=>window.location.hostname.includes(t)))}}var _t={};P(_t,"RegionMatcher",(()=>St));class St{constructor(t){this.geo=t}isValid(t,e){const n=t.r??t.regions??[],i=this.filterOutInvalidRegions(n);return e?e(i):this.isProperGeo(i)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(t=[]){return!(!t||!t.indexOf||this.isGeoExcluded(t)||!(this.isProperContinent(t)||this.isProperCountry(t)||this.isProperRegion(t)))}filterOutInvalidRegions(t){return t.filter((t=>!t.includes(st))).filter((t=>!t.includes(ot)))}isProperCountry(t){return!!(t&&t.indexOf&&(t.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(t,this.getCountryCode())))}isProperRegion(t){const e=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(t&&t.indexOf&&(t.indexOf(e)>-1||this.isSampledForGeo(t,e)))}containsContinent(t){const e=`${at}-${this.getContinentCode()}`;return t.indexOf(e)>-1||this.isSampledForGeo(t,e)}containsWorldWide(t){return t.indexOf(at)>-1||this.isSampledForGeo(t,at)}isProperContinent(t){return!(!t||!t.indexOf||!this.containsWorldWide(t)&&!this.containsContinent(t))}isGeoExcluded(t){return!!(t.indexOf(`${rt}${this.getCountryCode()}`)>-1||t.indexOf(`${rt}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||t.indexOf(`${rt}${at}-${this.getContinentCode()}`)>-1)}hasSampling(t){return e=>0!==e.indexOf(rt)&&e.indexOf(t+st)>-1}getSamplingLimits(t){let[,e]=t.split(st);return e=e.replace(ot,""),Math.round(parseFloat(e)*ct)||0}isSampledForGeo(t,e){const n=t.filter(this.hasSampling(e));if(0===n.length)return!1;const i=Math.round(Math.random()*(100*ct))||0;return n.map((t=>this.getSamplingLimits(t))).some((t=>i<t))}}var Et={};P(Et,"SamplingMatcher",(()=>kt));class kt{constructor(t){this.samplingProvider=t,this.precision=10**6}isValid(t){return Math.round(this.samplingProvider()*this.precision)<Math.round(t*this.precision)}}L(pt,ht),L(pt,vt),L(pt,bt),L(pt,ft),L(pt,_t),L(pt,Et);class Tt{constructor(t=new mt,e=new yt,n=new wt,i=new St,r){this.browserMatcher=t,this.deviceMatcher=e,this.domainMatcher=n,this.regionMatcher=i,this.settingsRepository=r,this.logGroup="instant-config-interpreter",this.configResponse={}}init(t,e={},n,i=window){return this.configResponse={...e,...t},this.regionValidationPredicate=n,this.labradorKeyValuesMapper=new dt(this.getValue("icLABradorGamKeyValues")),this.samplingMatcher=new kt(new lt(this.getValue("icExperimentBucket"),i,this.settingsRepository).build()),this}getValues(){return D.logger(this.logGroup,"get values called with",this.configResponse),void 0===this.values&&(this.values=Object.keys(this.configResponse).reduce(((t,e)=>(t[e]=this.getValue(e),t)),{})),this.values}getValue(t){const e=this.configResponse[t];if(et(e)){const n=e.find(this.predicate(t));return n?.v??n?.value}return e}getActiveKeyValues(){return this.labradorKeyValuesMapper.getActiveKeyValues()}getActiveLabradorKeyValues(){return this.labradorKeyValuesMapper.getActiveLabradorKeyValues()}predicate(t){return e=>{const n=this.browserMatcher.isValid(e)&&this.deviceMatcher.isValid(e)&&this.domainMatcher.isValid(e)&&this.regionMatcher.isValid(e,this.regionValidationPredicate);if(!nt(e)||!1===n)return n;const i=e?.s??e?.sampling,r=this.samplingMatcher.isValid(i);return this.labradorKeyValuesMapper.mark(t,i,r),r}}}var It={};async function Ot(t,e=2e3){const n=new AbortController,i=setTimeout((()=>n.abort()),e),r=await fetch(t,{signal:n.signal});return clearTimeout(i),r}P(It,"InstantConfigLoader",(()=>Ct));const xt="instant-config-loader";class Ct{constructor(t,e=window){this.params=t,this.container=e,this.storage=new D.localStorageHelper(`instant-config-${t.appName}`,6e4),this.container.icbm=this.container.icbm||{},this.instantConfig=this.container.instantConfig,this.lockDelay="number"==typeof t.lockDelay?t.lockDelay:500}async getConfig(){if(this.instantConfig)return this.instantConfig;let t;return this.lockDelay>0?t=this.fetchInstantConfigThroughCache():(this.container.icbm.fetch||(this.container.icbm.fetch=this.fetchInstantConfig()),t=this.container.icbm.fetch),t.then((t=>t??this.fetchFallbackConfig()))}async fetchInstantConfigThroughCache(t=!1){if(D.lock()&&!t)return D.logger(xt,"locked, awaiting",this.lockDelay),await N(this.lockDelay),this.fetchInstantConfigThroughCache(!0);try{const t=this.storage.get();if(t)return D.logger(xt,"instant config pulled from local storage",t),JSON.parse(t);const e=await this.fetchInstantConfig();return e&&this.storage.set(JSON.stringify(e)),D.release(),e}catch(t){D.warner(xt,"could not get instant config via cache",t),D.release()}}async fetchInstantConfig(){const t=this.params.instantConfigEndpoint??"https://services.fandom.com",e=this.params.instantConfigVariant??"icbm",{appName:n,compact:i}=this.params,r=new URLSearchParams({app:n});i&&r.set("compact","true");const o=`${t}/${e}/api/config?${r.toString()}`;try{const t=await Ot(o,this.params.requestTimeout);if(!t.ok)return;const e=await t.json();return D.logger(xt,"instant config fetched",e),e}catch(t){return void D.warner(xt,"could not fetch instant config",t)}}async fetchFallbackConfig(){D.logger(xt,"Fetching fallback config");const t=this.params.instantConfigFallbackEndpoint;if(void 0===t)return{};try{D.logger(xt,t);const e=await Ot(t,this.params.requestTimeout);if(!e.ok)return{};const n=await e.json();return D.logger(xt,"fallback config fetched",n),n}catch(t){return D.warner(xt,"could not fetch fallback config",t),{}}}}var At={};P(At,"InstantConfigOverrider",(()=>Pt));const Lt=["InstantGlobals","icbm"];class Pt{override(t,e){return[...t.keys()].filter((t=>{return e=t,Lt.some((t=>e.startsWith(`${t}.`)||e.startsWith(`${t}__`)));var e})).map((t=>{const[,e]=t.split(".").map((t=>t.split("__"))).flat();return{paramKey:t,key:e}})).map((({paramKey:e,key:n})=>({key:n,value:this.parseValue(t.get(e))}))).reduce(((t,{key:e,value:n})=>({...t,[e]:n})),e)}parseValue(t){if("true"===t||"false"===t)return"true"===t;const e=parseInt(t,10);if(t===`${e}`)return e;try{return JSON.parse(t)}catch(e){return t||null}}}L(X,J),L(X,It),L(X,At),L(X,pt);const Dt="advertisement-label";var Rt=function(){return Rt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Rt.apply(this,arguments)},Nt={channelId:"default",host:window,coordinatorHost:window.top},jt={connect:"connect",connected:"connected"},Mt="@wikia/post-quecast";function Vt(t){return t.channelId&&t.libId===Mt&&t.action&&function(t){return"string"==typeof t.type&&"number"==typeof t.timestamp}(t.action)}function $t(t){return!t.data.private}function Bt(t,e){return t.data.channelId===e}function Gt(t){return t.data.action}var Ut=function(){function t(){}return t.make=function(t){return function(t){var e;return t.host===t.coordinatorHost&&!!(null===(e=t.coordinatorHost[Mt])||void 0===e?void 0:e.callbackConnector)}(t)?t.coordinatorHost[Mt].callbackConnector:new Ft({senderHost:t.coordinatorHost,listenerHost:t.host})},t}(),Ht=function(){function t(t){this.coordinatorHost=t,this.callbacks=[]}return t.prototype.dispatch=function(t){var e=this;if(!Vt(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.callbacks.forEach((function(n){return n({data:t,source:e.coordinatorHost})}))},t.prototype.addListener=function(t){this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),Ft=function(){function t(t){this.options=t,this.map=new Map}return t.prototype.dispatch=function(t){if(!Vt(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.options.senderHost.postMessage(t,"*")},t.prototype.addListener=function(t){var e=function(e){var n;(n=e)&&n.source&&n.data&&Vt(n.data)&&t(e)};this.map.set(t,e),this.options.listenerHost.addEventListener("message",e)},t.prototype.removeListener=function(t){var e=this.map.get(t);this.options.listenerHost.removeEventListener("message",e),this.map.delete(t)},t}(),zt=function(){function t(t){this.callbacks=[],this.history=[],this.channelId=t.channelId,this.connector=Ut.make(t),this.setupActions(),this.setupConnection()}return t.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},t.prototype.getHistory=function(){var t=this,e=function(n){if(Bt(n,t.channelId)&&function(t){return!!t.data.private}(n)){var i=Gt(n);(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some((function(e){return t.type===e}))})(i,jt.connected)&&(t.connector.removeListener(e),t.handleActions.apply(t,i.history))}};this.connector.addListener(e)},t.prototype.listenEvent=function(){var t=this;this.connector.addListener((function(e){if(Bt(e,t.channelId)&&$t(e)){var n=Gt(e);t.handleActions(n)}}))},t.prototype.handleActions=function(){for(var t,e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];(t=this.history).push.apply(t,n),n.forEach((function(t){return e.callbacks.forEach((function(e){return e(t)}))}))},t.prototype.setupConnection=function(){this.connector.dispatch({action:{type:jt.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:Mt})},t.prototype.addListener=function(t){this.history.forEach((function(e){return t(e)})),this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),Wt=function(){function t(t){void 0===t&&(t={});var e=Rt(Rt({},Nt),t);this.channelId=e.channelId,this.connector=Ut.make(e)}return t.prototype.dispatch=function(t){this.connector.dispatch({action:Rt(Rt({},t),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:Mt})},t}(),Kt=function(){function t(t){void 0===t&&(t={});var e=Rt(Rt({},Nt),t);this.transmitter=new Wt(e),this.receiver=new zt(e)}return t.prototype.dispatch=function(t){this.transmitter.dispatch(t)},t.prototype.addListener=function(t){this.receiver.addListener(t)},t.prototype.removeListener=function(t){this.receiver.removeListener(t)},t}(),qt=function(){function t(t,e){this.channelId=t,this.connectors=new Map,this.history=[],this.connectors.set(e,e[Mt].callbackConnector)}return t.prototype.addConnection=function(t){this.ensureConnector(t).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:Mt})},t.prototype.createConnectedAction=function(){return{type:jt.connected,history:this.history,timestamp:Date.now()}},t.prototype.broadcast=function(t){var e=this;this.history.push(t),this.connectors.forEach((function(n){n.dispatch({action:t,channelId:e.channelId,libId:Mt})}))},t.prototype.ensureConnector=function(t){return this.connectors.has(t)||this.connectors.set(t,new Ft({senderHost:t,listenerHost:t})),this.connectors.get(t)},t}(),Qt=function(){function t(t){this.coordinatorHost=t,this.channels=new Map,this.callbackConnector=new Ht(t),this.postMessageConnector=new Ft({senderHost:t,listenerHost:t})}return t.prototype.init=function(){var t=this,e=function(e){$t(e)||(t.handleConnect(e),t.handleBroadcast(e))};this.callbackConnector.addListener(e),this.postMessageConnector.addListener(e)},t.prototype.handleConnect=function(t){(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some((function(e){return t.data.action.type===e}))})(t,jt.connect)&&this.ensureChannel(t.data.channelId).addConnection(t.source)},t.prototype.handleBroadcast=function(t){(function(t){return!Object.values(jt).some((function(e){return t.data.action.type===e}))})(t)&&this.ensureChannel(t.data.channelId).broadcast(t.data.action)},t.prototype.ensureChannel=function(t){return this.channels.has(t)||this.channels.set(t,new qt(t,this.coordinatorHost)),this.channels.get(t)},t}();function Yt(t){return"function"==typeof t}function Xt(t){var e=t((function(t){Error.call(t),t.stack=(new Error).stack}));return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var Jt=Xt((function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}}));function Zt(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var te=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var t,e,n,i,r;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=c(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}else o.remove(this);var d=this.initialTeardown;if(Yt(d))try{d()}catch(t){r=t instanceof Jt?t.errors:[t]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var h=c(p),f=h.next();!f.done;f=h.next()){var g=f.value;try{ie(g)}catch(t){r=null!=r?r:[],t instanceof Jt?r=l(l([],u(r)),u(t.errors)):r.push(t)}}}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}if(r)throw new Jt(r)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)ie(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&Zt(e,t)},t.prototype.remove=function(e){var n=this._finalizers;n&&Zt(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t;var e}(),ee=te.EMPTY;function ne(t){return t instanceof te||t&&"closed"in t&&Yt(t.remove)&&Yt(t.add)&&Yt(t.unsubscribe)}function ie(t){Yt(t)?t():t.unsubscribe()}var re={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},oe={setTimeout:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=oe.delegate;return(null==r?void 0:r.setTimeout)?r.setTimeout.apply(r,l([t,e],u(n))):setTimeout.apply(void 0,l([t,e],u(n)))},clearTimeout:function(t){var e=oe.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function se(t){oe.setTimeout((function(){var e=re.onUnhandledError;if(!e)throw t;e(t)}))}function ae(){}var ce=ue("C",void 0,void 0);function ue(t,e,n){return{kind:t,value:e,error:n}}var le=null;function de(t){if(re.useDeprecatedSynchronousErrorHandling){var e=!le;if(e&&(le={errorThrown:!1,error:null}),t(),e){var n=le,i=n.errorThrown,r=n.error;if(le=null,i)throw r}}else t()}var pe=function(t){function e(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,ne(e)&&e.add(n)):n.destination=be,n}return i(e,t),e.create=function(t,e,n){return new me(t,e,n)},e.prototype.next=function(t){this.isStopped?ye(function(t){return ue("N",t,void 0)}(t),this):this._next(t)},e.prototype.error=function(t){this.isStopped?ye(ue("E",void 0,t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?ye(ce,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(te),he=Function.prototype.bind;function fe(t,e){return he.call(t,e)}var ge=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(t){ve(t)}},t.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(t){ve(t)}else ve(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){ve(t)}},t}(),me=function(t){function e(e,n,i){var r,o,s=t.call(this)||this;return Yt(e)||!e?r={next:null!=e?e:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0}:s&&re.useDeprecatedNextContext?((o=Object.create(e)).unsubscribe=function(){return s.unsubscribe()},r={next:e.next&&fe(e.next,o),error:e.error&&fe(e.error,o),complete:e.complete&&fe(e.complete,o)}):r=e,s.destination=new ge(r),s}return i(e,t),e}(pe);function ve(t){var e;re.useDeprecatedSynchronousErrorHandling?(e=t,re.useDeprecatedSynchronousErrorHandling&&le&&(le.errorThrown=!0,le.error=e)):se(t)}function ye(t,e){var n=re.onStoppedNotification;n&&oe.setTimeout((function(){return n(t,e)}))}var be={closed:!0,next:ae,error:function(t){throw t},complete:ae},we="function"==typeof Symbol&&Symbol.observable||"@@observable";function _e(t){return t}var Se=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var i,r=this,o=(i=t)&&i instanceof pe||function(t){return t&&Yt(t.next)&&Yt(t.error)&&Yt(t.complete)}(i)&&ne(i)?t:new me(t,e,n);return de((function(){var t=r,e=t.operator,n=t.source;o.add(e?e.call(o,n):n?r._subscribe(o):r._trySubscribe(o))})),o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=Ee(e))((function(e,i){var r=new me({next:function(e){try{t(e)}catch(t){i(t),r.unsubscribe()}},error:i,complete:e});n.subscribe(r)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[we]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0===(n=t).length?_e:1===n.length?n[0]:function(t){return n.reduce((function(t,e){return e(t)}),t)})(this);var n},t.prototype.toPromise=function(t){var e=this;return new(t=Ee(t))((function(t,n){var i;e.subscribe((function(t){return i=t}),(function(t){return n(t)}),(function(){return t(i)}))}))},t.create=function(e){return new t(e)},t}();function Ee(t){var e;return null!==(e=null!=t?t:re.Promise)&&void 0!==e?e:Promise}function ke(t){return function(e){if(function(t){return Yt(null==t?void 0:t.lift)}(e))return e.lift((function(e){try{return t(e,this)}catch(t){this.error(t)}}));throw new TypeError("Unable to lift unknown Observable type")}}function Te(t,e,n,i,r){return new Ie(t,e,n,i,r)}var Ie=function(t){function e(e,n,i,r,o,s){var a=t.call(this,e)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(t){try{n(t)}catch(t){e.error(t)}}:t.prototype._next,a._error=r?function(t){try{r(t)}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,a}return i(e,t),e.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}},e}(pe);function Oe(t,e){return ke((function(n,i){var r=0;n.subscribe(Te(i,(function(n){i.next(t.call(e,n,r++))})))}))}var xe=Array.isArray;function Ce(t,e,n){return n?Ce(t,e).pipe((i=n,Oe((function(t){return function(t,e){return xe(e)?t.apply(void 0,l([],u(e))):t(e)}(i,t)})))):new Se((function(n){var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.next(1===t.length?t[0]:t)},r=t(i);return Yt(e)?function(){return e(i,r)}:void 0}));var i}var Ae=Xt((function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Le=function(t){function e(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return i(e,t),e.prototype.lift=function(t){var e=new Pe(this,this);return e.operator=t,e},e.prototype._throwIfClosed=function(){if(this.closed)throw new Ae},e.prototype.next=function(t){var e=this;de((function(){var n,i;if(e._throwIfClosed(),!e.isStopped){e.currentObservers||(e.currentObservers=Array.from(e.observers));try{for(var r=c(e.currentObservers),o=r.next();!o.done;o=r.next())o.value.next(t)}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}}))},e.prototype.error=function(t){var e=this;de((function(){if(e._throwIfClosed(),!e.isStopped){e.hasError=e.isStopped=!0,e.thrownError=t;for(var n=e.observers;n.length;)n.shift().error(t)}}))},e.prototype.complete=function(){var t=this;de((function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var e=t.observers;e.length;)e.shift().complete()}}))},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var e=this,n=this,i=n.hasError,r=n.isStopped,o=n.observers;return i||r?ee:(this.currentObservers=null,o.push(t),new te((function(){e.currentObservers=null,Zt(o,t)})))},e.prototype._checkFinalizedStatuses=function(t){var e=this,n=e.hasError,i=e.thrownError,r=e.isStopped;n?t.error(i):r&&t.complete()},e.prototype.asObservable=function(){var t=new Se;return t.source=this,t},e.create=function(t,e){return new Pe(t,e)},e}(Se),Pe=function(t){function e(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return i(e,t),e.prototype.next=function(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,t)},e.prototype.error=function(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,t)},e.prototype.complete=function(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)},e.prototype._subscribe=function(t){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==n?n:ee},e}(Le),De=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function Re(t){return Yt(null==t?void 0:t.then)}function Ne(t){return Yt(t[we])}function je(t){return Symbol.asyncIterator&&Yt(null==t?void 0:t[Symbol.asyncIterator])}function Me(t){return new TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Ve="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function $e(t){return Yt(null==t?void 0:t[Ve])}function Be(t){return function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),o=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",(function(t){return function(e){return Promise.resolve(e).then(t,u)}})),i[Symbol.asyncIterator]=function(){return this},i;function s(t,e){r[t]&&(i[t]=function(e){return new Promise((function(n,i){o.push([t,e,n,i])>1||a(t,e)}))},e&&(i[t]=e(i[t])))}function a(t,e){try{(n=r[t](e)).value instanceof d?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(t){l(o[0][3],t)}var n}function c(t){a("next",t)}function u(t){a("throw",t)}function l(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,(function(){var e,n,i;return a(this,(function(r){switch(r.label){case 0:e=t.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,d(e.read())];case 3:return n=r.sent(),i=n.value,n.done?[4,d(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,d(i)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}}))}))}function Ge(t){return Yt(null==t?void 0:t.getReader)}function Ue(t){if(t instanceof Se)return t;if(null!=t){if(Ne(t))return r=t,new Se((function(t){var e=r[we]();if(Yt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(De(t))return i=t,new Se((function(t){for(var e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()}));if(Re(t))return n=t,new Se((function(t){n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,se)}));if(je(t))return He(t);if($e(t))return e=t,new Se((function(t){var n,i;try{for(var r=c(e),o=r.next();!o.done;o=r.next()){var s=o.value;if(t.next(s),t.closed)return}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}t.complete()}));if(Ge(t))return He(Be(t))}var e,n,i,r;throw Me(t)}function He(t){return new Se((function(e){(function(t,e){var n,i,r,o;return s(this,void 0,void 0,(function(){var s,u;return a(this,(function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),n=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=c(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,r){!function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)}(i,r,(e=t[n](e)).done,e.value)}))}}}(t),a.label=1;case 1:return[4,n.next()];case 2:if((i=a.sent()).done)return[3,4];if(s=i.value,e.next(s),e.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=a.sent(),r={error:u},[3,11];case 6:return a.trys.push([6,,9,10]),i&&!i.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}}))}))})(t,e).catch((function(t){return e.error(t)}))}))}function Fe(t,e,n,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var o=e.schedule((function(){n(),r?t.add(this.schedule(null,i)):this.unsubscribe()}),i);if(t.add(o),!r)return o}function ze(t,e,n){return void 0===n&&(n=1/0),Yt(e)?ze((function(n,i){return Oe((function(t,r){return e(n,t,i,r)}))(Ue(t(n,i)))}),n):("number"==typeof e&&(n=e),ke((function(e,i){return function(t,e,n,i,r,o,s,a){var c=[],u=0,l=0,d=!1,p=function(){!d||c.length||u||e.complete()},h=function(t){return u<i?f(t):c.push(t)},f=function(t){u++;var r=!1;Ue(n(t,l++)).subscribe(Te(e,(function(t){e.next(t)}),(function(){r=!0}),void 0,(function(){if(r)try{u--;for(;c.length&&u<i;)t=void 0,t=c.shift(),f(t);p()}catch(t){e.error(t)}var t})))};return t.subscribe(Te(e,h,(function(){d=!0,p()}))),function(){}}(e,i,t,n)})))}var We=new Se((function(t){return t.complete()}));function Ke(t){return t[t.length-1]}function qe(t,e){return void 0===e&&(e=0),ke((function(n,i){n.subscribe(Te(i,(function(n){return Fe(i,t,(function(){return i.next(n)}),e)}),(function(){return Fe(i,t,(function(){return i.complete()}),e)}),(function(n){return Fe(i,t,(function(){return i.error(n)}),e)})))}))}function Qe(t,e){return void 0===e&&(e=0),ke((function(n,i){i.add(t.schedule((function(){return n.subscribe(i)}),e))}))}function Ye(t,e){if(!t)throw new Error("Iterable cannot be null");return new Se((function(n){Fe(n,e,(function(){var i=t[Symbol.asyncIterator]();Fe(n,e,(function(){i.next().then((function(t){t.done?n.complete():n.next(t.value)}))}),0,!0)}))}))}function Xe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(t){return(e=Ke(t))&&Yt(e.schedule)?t.pop():void 0;var e}(t),i=function(t,e){return"number"==typeof Ke(t)?t.pop():1/0}(t),r=t;return r.length?1===r.length?Ue(r[0]):function(t){return void 0===t&&(t=1/0),ze(_e,t)}(i)(function(t,e){return e?function(t,e){if(null!=t){if(Ne(t))return function(t,e){return Ue(t).pipe(Qe(e),qe(e))}(t,e);if(De(t))return function(t,e){return new Se((function(n){var i=0;return e.schedule((function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())}))}))}(t,e);if(Re(t))return function(t,e){return Ue(t).pipe(Qe(e),qe(e))}(t,e);if(je(t))return Ye(t,e);if($e(t))return function(t,e){return new Se((function(n){var i;return Fe(n,e,(function(){i=t[Ve](),Fe(n,e,(function(){var t,e,r;try{e=(t=i.next()).value,r=t.done}catch(t){return void n.error(t)}r?n.complete():n.next(e)}),0,!0)})),function(){return Yt(null==i?void 0:i.return)&&i.return()}}))}(t,e);if(Ge(t))return function(t,e){return Ye(Be(t),e)}(t,e)}throw Me(t)}(t,e):Ue(t)}(r,n)):We}var Je={now:function(){return(Je.delegate||Date).now()},delegate:void 0},Ze=function(t){function e(e,n,i){void 0===e&&(e=1/0),void 0===n&&(n=1/0),void 0===i&&(i=Je);var r=t.call(this)||this;return r._bufferSize=e,r._windowTime=n,r._timestampProvider=i,r._buffer=[],r._infiniteTimeWindow=!0,r._infiniteTimeWindow=n===1/0,r._bufferSize=Math.max(1,e),r._windowTime=Math.max(1,n),r}return i(e,t),e.prototype.next=function(e){var n=this,i=n.isStopped,r=n._buffer,o=n._infiniteTimeWindow,s=n._timestampProvider,a=n._windowTime;i||(r.push(e),!o&&r.push(s.now()+a)),this._trimBuffer(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var e=this._innerSubscribe(t),n=this._infiniteTimeWindow,i=this._buffer.slice(),r=0;r<i.length&&!t.closed;r+=n?1:2)t.next(i[r]);return this._checkFinalizedStatuses(t),e},e.prototype._trimBuffer=function(){var t=this,e=t._bufferSize,n=t._timestampProvider,i=t._buffer,r=t._infiniteTimeWindow,o=(r?1:2)*e;if(e<1/0&&o<i.length&&i.splice(0,i.length-o),!r){for(var s=n.now(),a=0,c=1;c<i.length&&i[c]<=s;c+=2)a=c;a&&i.splice(0,a+1)}},e}(Le);function tn(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!0!==e){if(!1!==e){var r=new me({next:function(){r.unsubscribe(),t()}});return Ue(e.apply(void 0,l([],u(n)))).subscribe(r)}}else t()}function en(t,e){return ke((function(n,i){var r=0;n.subscribe(Te(i,(function(n){return t.call(e,n,r++)&&i.next(n)})))}))}function nn(t){return t<=0?function(){return We}:ke((function(e,n){var i=0;e.subscribe(Te(n,(function(e){++i<=t&&(n.next(e),t<=i&&n.complete())})))}))}function rn(t){return en((function(e,n){return t<=n}))}const on={name:"Ad Slot added",payload:{_as:"props",_p:void 0}},sn={name:"Ad Slot event",payload:{_as:"props",_p:void 0}},an={name:"Ad Slot loaded",payload:{_as:"props",_p:void 0}},cn={name:"Invalidate slot targeting",payload:{_as:"props",_p:void 0}};function un(...t){return e=>e.pipe(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return en((function(e){var n=e.type;return t.some((function(t){return t.type===n}))}))}(...t),en((e=>t.some((t=>!0===t.__global?C(e):!C(e))))))}class ln{static connect(t="AdEngine"){if(this.devtools)throw new Error("Trying to initialize ReduxDevtools second time");const e=window.__REDUX_DEVTOOLS_EXTENSION__;if(e)return this.devtools=e.connect({name:t})}}const dn=new class{constructor(){const{channelId:t,coordinatorName:e,reduxDevtoolsName:n}=this.getSettings();!function(t){if(void 0===t&&(t=window),!t[Mt]){var e=new Qt(t);e.init(),t[Mt]=e}}(),this.communicator=new Kt({channelId:t||"default",coordinatorHost:window[e]||top});const i=Ce((t=>this.communicator.addListener(t)),(t=>this.communicator.removeListener(t))).pipe(function(t,e,n){var i,r,o,s,a=!1;return t&&"object"==typeof t?(i=t.bufferSize,s=void 0===i?1/0:i,r=t.windowTime,e=void 0===r?1/0:r,a=void 0!==(o=t.refCount)&&o,n=t.scheduler):s=null!=t?t:1/0,function(t){void 0===t&&(t={});var e=t.connector,n=void 0===e?function(){return new Le}:e,i=t.resetOnError,r=void 0===i||i,o=t.resetOnComplete,s=void 0===o||o,a=t.resetOnRefCountZero,c=void 0===a||a;return function(t){var e,i,o,a=0,u=!1,l=!1,d=function(){null==i||i.unsubscribe(),i=void 0},p=function(){d(),e=o=void 0,u=l=!1},h=function(){var t=e;p(),null==t||t.unsubscribe()};return ke((function(t,f){a++,l||u||d();var g=o=null!=o?o:n();f.add((function(){0!=--a||l||u||(i=tn(h,c))})),g.subscribe(f),!e&&a>0&&(e=new me({next:function(t){return g.next(t)},error:function(t){l=!0,d(),i=tn(p,r,t),g.error(t)},complete:function(){u=!0,d(),i=tn(p,s),g.complete()}}),Ue(t).subscribe(e))}))(t)}}({connector:function(){return new Ze(s,e,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:a})}({refCount:!0}));this.subject=new Le,this.action$=Xe(i.pipe(en((t=>C(t)))),this.subject.asObservable().pipe(en((t=>!C(t))))),this.connectReduxDevtools(n)}emit(t,e){this.dispatch(this.getGlobalAction(t)(e))}on(t,e,n=!0){this.action$.pipe(un(this.getGlobalAction(t)),n?nn(1):rn(0)).subscribe(e)}onSlotEvent(t,e,n="",i=!1){this.action$.pipe(un(this.getGlobalAction(sn)),en((e=>e.event===t.toString()&&(!n||e.adSlotName===n))),i?nn(1):rn(0)).subscribe(e)}dispatch(t){C(t)?this.communicator.dispatch(t):this.subject.next(t)}getGlobalAction(t){return t.action||(t.action=t.payload?A(`${t.category||"[AdEngine]"} ${t.name}`,t.payload):A(`${t.category||"[AdEngine]"} ${t.name}`)),t.action}getSettings(){return window["@wikia/post-quecast-settings"]||{}}connectReduxDevtools(t){const e=ln.connect(t);e&&(e.subscribe((t=>{try{if("@devtools-extension"===t.source&&"ACTION"===t.type){const e=new Function(`return ${t.payload}`)();this.dispatch(e)}}catch(t){e.error(t.message)}})),this.action$.subscribe((t=>e.send(t,{}))))}},pn={name:"Identity partner data obtained",payload:{_as:"payload",_p:void 0}},hn={name:"Partner load status",payload:{_as:"props",_p:void 0}},fn={name:"IntentIQ A/B test group obtained",payload:{_as:"props",_p:void 0}},gn={name:"LiveConnect started"},mn={name:"LiveConnect data cached"},vn={name:"LiveConnect responded with UUID"},yn={name:"LiveConnect loaded"},bn={name:"LiveConnect HEM ready",payload:{_as:"props",_p:void 0}},wn={category:"[IdentityEngine]",name:"Identity ready"},_n=new class{loadPixel(t,e){const n=document.createElement("img");n.src=t,n.onload=()=>{Ui(e,"pixel loaded"),dn.emit(hn,{status:e+"_loaded"})},document.body.appendChild(n)}},Sn=new class{hexToBase64(t){return btoa(String.fromCharCode(...t.match(/.{2}/g).map((t=>parseInt(t,16)))))}};n(727);var En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kn=window.device,Tn={},In=[];window.device=Tn;var On=window.document.documentElement,xn=window.navigator.userAgent.toLowerCase(),Cn=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function An(t,e){return-1!==t.indexOf(e)}function Ln(t){return An(xn,t)}function Pn(t){return On.className.match(new RegExp(t,"i"))}function Dn(t){var e=null;Pn(t)||(e=On.className.replace(/^\s+|\s+$/g,""),On.className=e+" "+t)}function Rn(t){Pn(t)&&(On.className=On.className.replace(" "+t,""))}function Nn(){Tn.landscape()?(Rn("portrait"),Dn("landscape"),jn("landscape")):(Rn("landscape"),Dn("portrait"),jn("portrait")),$n()}function jn(t){for(var e=0;e<In.length;e++)In[e](t)}Tn.macos=function(){return Ln("mac")},Tn.ios=function(){return Tn.iphone()||Tn.ipod()||Tn.ipad()},Tn.iphone=function(){return!Tn.windows()&&Ln("iphone")},Tn.ipod=function(){return Ln("ipod")},Tn.ipad=function(){var t="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return Ln("ipad")||t},Tn.android=function(){return!Tn.windows()&&Ln("android")},Tn.androidPhone=function(){return Tn.android()&&Ln("mobile")},Tn.androidTablet=function(){return Tn.android()&&!Ln("mobile")},Tn.blackberry=function(){return Ln("blackberry")||Ln("bb10")},Tn.blackberryPhone=function(){return Tn.blackberry()&&!Ln("tablet")},Tn.blackberryTablet=function(){return Tn.blackberry()&&Ln("tablet")},Tn.windows=function(){return Ln("windows")},Tn.windowsPhone=function(){return Tn.windows()&&Ln("phone")},Tn.windowsTablet=function(){return Tn.windows()&&Ln("touch")&&!Tn.windowsPhone()},Tn.fxos=function(){return(Ln("(mobile")||Ln("(tablet"))&&Ln(" rv:")},Tn.fxosPhone=function(){return Tn.fxos()&&Ln("mobile")},Tn.fxosTablet=function(){return Tn.fxos()&&Ln("tablet")},Tn.meego=function(){return Ln("meego")},Tn.cordova=function(){return window.cordova&&"file:"===location.protocol},Tn.nodeWebkit=function(){return"object"===En(window.process)},Tn.mobile=function(){return Tn.androidPhone()||Tn.iphone()||Tn.ipod()||Tn.windowsPhone()||Tn.blackberryPhone()||Tn.fxosPhone()||Tn.meego()},Tn.tablet=function(){return Tn.ipad()||Tn.androidTablet()||Tn.blackberryTablet()||Tn.windowsTablet()||Tn.fxosTablet()},Tn.desktop=function(){return!Tn.tablet()&&!Tn.mobile()},Tn.television=function(){for(var t=0;t<Cn.length;){if(Ln(Cn[t]))return!0;t++}return!1},Tn.portrait=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?An(screen.orientation.type,"portrait"):Tn.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90!==Math.abs(window.orientation):window.innerHeight/window.innerWidth>1},Tn.landscape=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?An(screen.orientation.type,"landscape"):Tn.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90===Math.abs(window.orientation):window.innerHeight/window.innerWidth<1},Tn.noConflict=function(){return window.device=kn,this},Tn.ios()?Tn.ipad()?Dn("ios ipad tablet"):Tn.iphone()?Dn("ios iphone mobile"):Tn.ipod()&&Dn("ios ipod mobile"):Tn.macos()?Dn("macos desktop"):Tn.android()?Tn.androidTablet()?Dn("android tablet"):Dn("android mobile"):Tn.blackberry()?Tn.blackberryTablet()?Dn("blackberry tablet"):Dn("blackberry mobile"):Tn.windows()?Tn.windowsTablet()?Dn("windows tablet"):Tn.windowsPhone()?Dn("windows mobile"):Dn("windows desktop"):Tn.fxos()?Tn.fxosTablet()?Dn("fxos tablet"):Dn("fxos mobile"):Tn.meego()?Dn("meego mobile"):Tn.nodeWebkit()?Dn("node-webkit"):Tn.television()?Dn("television"):Tn.desktop()&&Dn("desktop"),Tn.cordova()&&Dn("cordova"),Tn.onChangeOrientation=function(t){"function"==typeof t&&In.push(t)};var Mn="resize";function Vn(t){for(var e=0;e<t.length;e++)if(Tn[t[e]]())return t[e];return"unknown"}function $n(){Tn.orientation=Vn(["portrait","landscape"])}Object.prototype.hasOwnProperty.call(window,"onorientationchange")&&(Mn="orientationchange"),window.addEventListener?window.addEventListener(Mn,Nn,!1):window.attachEvent?window.attachEvent(Mn,Nn):window[Mn]=Nn,Nn(),Tn.type=Vn(["mobile","tablet","desktop"]),Tn.os=Vn(["ios","iphone","ipad","ipod","android","blackberry","macos","windows","fxos","meego","television"]),$n();const Bn=Tn;let Gn,Un=null,Hn=!1,Fn=null;const zn=new class{isSmartphone(){return Bn.mobile()}isTablet(){return Bn.tablet()}isDesktop(){return!this.isSmartphone()&&!this.isTablet()}checkBlocking(t=(()=>{}),e=(()=>{})){return new Promise((t=>{if(!Hn){if("undefined"==typeof BlockAdBlock)return void t(!0);Gn=new BlockAdBlock({checkOnLoad:!1,resetOnEnd:!0,loopCheckTime:50,loopMaxNumber:5}),Hn=!0}Gn.onDetected((()=>t(!0))),Gn.onNotDetected((()=>t(!1))),Gn.check(!0)})).then((n=>(n?t():e(),n)))}getDeviceType(){return this.isTablet()?"tablet":this.isSmartphone()?"smartphone":"desktop"}getDeviceMode(){return window.matchMedia("(max-width: 840px)").matches?"mobile":"desktop"}getOperatingSystem(){if(null!==Fn)return Fn;const{userAgent:t}=window.navigator;return Fn="unknown",-1!==t.indexOf("Win")&&(Fn="Windows"),-1!==t.indexOf("Mac")&&(Fn="OSX"),-1!==t.indexOf("Linux")&&(Fn="Linux"),-1!==t.indexOf("Android")&&(Fn="Android"),-1!==t.indexOf("like Mac")&&(Fn="iOS"),Fn}getBrowser(){if(null!==Un)return Un;const{appName:t,appVersion:e,userAgent:n}=window.navigator;let i,r=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?(i=/\brv[ :]+(\d+)/g.exec(n)||[""],Un=`IE ${i[1]||""}`,Un):"Chrome"===r[1]&&(i=n.match(/\b(OPR|Edge)\/(\d+)/),null!==i)?(Un=i.slice(1).join(" ").replace("OPR","Opera"),Un):(r=r[2]?[r[1],r[2]]:[t,e,"-?"],i=n.match(/version\/(\d+)/i),null!==i&&r.splice(1,1,i[1]),Un=r.join(" "),Un)}isChromeBrowser(){return"Chrome"===this.getBrowser().split(" ")[0]}isSteamPlatform(){const{userAgent:t}=window.navigator;return t.toLowerCase().indexOf("steam")>-1}};function Wn(t,e){let n=null;return function(...i){clearTimeout(n),n=setTimeout((()=>{t.apply(this,i)}),e)}}function Kn(t){let e=null;return function(n,i,r){const o=r.value;return r.value=function(...n){clearTimeout(e),e=setTimeout((()=>{o.apply(this,n)}),t)},r}}function qn(t){return function(e,n,i){const r=i.value;return i.value=t.call(this,r),i}}var Qn;function Yn(t){return t?parseFloat(getComputedStyle(t,null).width.replace("px","")):0}function Xn(t){return t?parseFloat(getComputedStyle(t,null).height.replace("px","")):0}function Jn(t){let e=!1;const n={display:"",height:""};t.classList.contains(Qn.HIDDEN_AD_CLASS)&&(e=!0,n.display=t.style.display,n.height=t.style.height,t.classList.remove(Qn.HIDDEN_AD_CLASS),t.style.display="block",t.style.height="1px");const i=function(t){const e=t.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,i=window.pageYOffset||document.documentElement.scrollTop;return{top:e.top+i,left:e.left+n}}(t);return e&&(t.classList.add(Qn.HIDDEN_AD_CLASS),t.style.display=n.display,t.style.height=n.height),i}function Zn(t){return Jn(t).top}function ti(t){return Jn(t).left}function ei(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)}function ni(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)}function ii(t,{topOffset:e=0,bottomOffset:n=0,areaThreshold:i=.5}={}){const r=window.getComputedStyle(t).position;if(["fixed","sticky"].includes(r))return!0;const o=t.offsetHeight,s=Zn(t),a=s+o,c=window.scrollY,u=ei(),l=i*o;return s>=e+c-l&&a<=n+c+u+l}function ri(t,e=[]){if(null===t.offsetParent)return!1;const n=t.offsetHeight,i=Zn(t),r=ei();return e.some((e=>{if(t.previousSibling&&t.previousSibling.isSameNode(e)||t.nextSibling&&t.nextSibling.isSameNode(e))return!0;const o=e.offsetHeight,s=Zn(e);return(s<i?i-s-o:s-i-n)<r}))}function oi(t){return"IFRAME"===t.tagName}function si(t){try{return t.self!==t.top}catch(t){return!0}}!function(t){t.AD_CLASS="gpt-ad",t.AD_SLOT_PLACEHOLDER_CLASS="ad-slot-placeholder",t.HIDDEN_AD_CLASS="hidead"}(Qn||(Qn={}));class ai{static getFirstElementChild(t){return t.firstElementChild}}class ci{fetch(t){return s(this,arguments,void 0,(function*(t,e=2e3,n){const i=new AbortController,r=setTimeout((()=>i.abort()),e),o=yield fetch(t,Object.assign({signal:i.signal},n));return clearTimeout(r),o}))}}const ui=(t=0)=>new Promise(((e,n)=>{"number"==typeof t?setTimeout(e,t):n(new Error("Delay value must be a number."))}));function li(t,...e){return new Promise(((n,i)=>{"function"==typeof t?setTimeout((()=>n(t(...e))),0):i(new Error("Expected a function."))}))}function di(t,e,n={}){const i="object"==typeof t&&"function"==typeof t.addEventListener,r="boolean"==typeof n?{capture:n}:Object.assign({},n);return new Promise(((n,o)=>{i?t.addEventListener(e,n,Object.assign(Object.assign({},r),{once:!0})):o(new Error("Emitter does not have `addEventListener` nor `once` method."))}))}function pi(t){return new Promise(((e,n)=>{setTimeout(n,t)}))}function hi(t,e=2e3){return Promise.race([new Promise(t),pi(e)])}function fi(){let t,e;const n=new Promise(((n,i)=>{t=n,e=i}));return n.resolve=t,n.reject=e,n}function gi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function mi(){return k.get("geo.country")}function vi(){return k.get("geo.continent")}function yi(){return k.get("geo.region")}function bi(t=[]){return!!(t&&t.indexOf&&t.indexOf(mi())>-1)}function wi(t){const e="undefined"!=typeof window&&window||"undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==n.g&&n.g||void 0;let i;return void 0!==e&&(i=e[t]),i}var _i=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Si="Singleton",Ei=function(){function t(){}return t.prototype.reset=function(t){},t}(),ki=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _i(e,t),e.prototype.resolve=function(t,e){return t()},e}(Ei),Ti=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.instances=new Map,e}return _i(e,t),e.prototype.resolve=function(t,e){var n=this.instances.get(e);return n||(n=t(),this.instances.set(e,n)),n},e.prototype.reset=function(t){this.instances.delete(t)},e}(Ei),Ii="wikia-ioc:paramtypes",Oi="wikia-ioc:autobind",xi="wikia-ioc:scope";function Ci(t){return void 0===t&&(t={}),function(e){if(Reflect.hasOwnMetadata(Ii,e))throw new Error("Cannot apply @Injectable decorator multiple times.");var n=Reflect.getMetadata("design:paramtypes",e)||[];return Reflect.defineMetadata(Ii,n,e),"boolean"==typeof t.autobind&&Reflect.defineMetadata(Oi,t.autobind,e),"string"==typeof t.scope&&Reflect.defineMetadata(xi,t.scope,e),e}}function Ai(t,e){return"value"in e?t.value(e.value):"to"in e?t.to(e.to):"provider"in e?t.provider(e.provider):t}function Li(t){var e=typeof t;return Pi(t)||"symbol"===e||"string"===e}function Pi(t){return"function"==typeof t}n(741);var Di=function(){function t(t,e,n,i){var r,o;if(this.sourceType=t,this.container=e,this.scopes=n,this.paramTypes=[],!Pi(this.sourceType))return this.scope(i.defaultScope);this.scope(null!==(r=Reflect.getMetadata(xi,this.sourceType))&&void 0!==r?r:i.defaultScope),(null!==(o=Reflect.getMetadata(Oi,this.sourceType))&&void 0!==o?o:i.defaultAutobind)&&this.to(this.sourceType)}return t.prototype.to=function(t){return function(t){if(!Pi(t))throw new TypeError("Invalid type requested to IoC container. Type must be Class.")}(t),this.targetType=t,this.paramTypes=this.getMetadataParamTypes(),this.sourceType===this.targetType?this.provideSourceType(t):this.provideTargetType(t),this},t.prototype.getMetadataParamTypes=function(){var t=Reflect.getMetadata(Ii,this.targetType)||[],e=Reflect.getMetadata("wikia-ioc:taggedtypes",this.targetType)||{};return t.map((function(t,n){return e[n]||t}))},t.prototype.provideSourceType=function(t){var e=this;this.provider((function(){var n=e.getParameters();return new(t.bind.apply(t,function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}([void 0],n)))}))},t.prototype.getParameters=function(){var t=this;return this.paramTypes.map((function(e){return t.container.get(e)}))},t.prototype.provideTargetType=function(t){var e=this;this.provider((function(){return e.container.get(t)}))},t.prototype.value=function(t){return this.provider((function(){return t}))},t.prototype.provider=function(t){return this._provider=t,this._scope.reset(this.sourceType),this},t.prototype.scope=function(t){return this._scope=this.scopes[t],this._scope.reset(this.sourceType),this},t.prototype.withParams=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.paramTypes=t,this},t.prototype.getInstance=function(){var t=this;if(!this._provider)throw new Error(this.sourceType.toString()+" is not bound to anything.");return this._scope.resolve((function(){return t._provider(t.container)}),this.sourceType)},t.prototype.getType=function(){return this.targetType},t}(),Ri=function(){return Ri=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Ri.apply(this,arguments)},Ni=function(){function t(e){void 0===e&&(e={}),this.bindings=new Map,this.scopes={Singleton:new Ti,Transient:new ki},this.containerOptions=Ri({defaultScope:Si,defaultAutobind:!0},e),this.bind(t).scope(Si).value(this)}return t.prototype.bind=function(t){var e=Li(t)?t:null==t?void 0:t.bind;return this.bindings.has(e)?this.bindings.get(e):Pi(t)?Ai(this.ensureBinding(e),{bind:t,to:t}):Li(t)?this.ensureBinding(e):Ai(this.ensureBinding(e),t)},t.prototype.unbind=function(t){var e=Li(t)?t:null==t?void 0:t.bind;this.bindings.delete(e)},t.prototype.get=function(t){return this.ensureBinding(t).getInstance()},t.prototype.getType=function(t){return this.ensureBinding(t).getType()},t.prototype.ensureBinding=function(t){!function(t){if(!Li(t))throw new TypeError("Invalid type requested to IoC container. TypeKey must be Class, symbol or string.")}(t);var e=this.bindings.get(t);return e||(e=new Di(t,this,this.scopes,this.containerOptions),this.bindings.set(t,e)),e},t}();const ji=b.getDebugGroup()||"",Mi=ji.split(",");""!==ji&&window.console.info("AdEngine debug mode - groups:","1"===ji?"all":Mi);const Vi=Date.now();function $i(){var t,e;return null!==(e=null===(t=window.performance)||void 0===t?void 0:t.timeOrigin)&&void 0!==e?e:Vi}function Bi(){return Date.now()-$i()}function Gi(){return(Bi()/1e3).toFixed(4)}function Ui(t,...e){""!==ji&&("1"!==ji&&-1===Mi.indexOf(t)||window.console.info(`${Gi()}s\t\t [AE] ${t}`,e))}function Hi(t,...e){""!==ji&&("1"!==ji&&-1===Mi.indexOf(t)||window.console.warn(`${Gi()}s\t\t [AE] ${t}`,e))}let Fi=class{constructor(){this.timeouts={}}get(t){return Ui("global-timeout",`Getting timeout ${t}`),this.timeouts[t]}set(t,e){return this.timeouts[t]?(Ui("global-timeout",`Timeout ${t} already set`),this.timeouts[t]):(Ui("global-timeout",`Setting timeout ${t} for ${e}ms`),this.timeouts[t]=new Promise((t=>{setTimeout((()=>{t()}),e)})),this.timeouts[t])}};Fi=r([Ci({scope:"Singleton"})],Fi);const zi={en:{advertisement:"Advertisement","learn-more":"Learn More"},ar:{advertisement:""},bn:{advertisement:""},br:{advertisement:"Bomm bruderezh"},ca:{advertisement:"Anunci"},cs:{advertisement:"Reklama"},de:{advertisement:"Anzeige","learn-more":"Erfahre mehr"},es:{advertisement:"Anuncio","learn-more":"Conoce ms"},eu:{advertisement:"Iragarkia"},fa:{advertisement:""},fo:{advertisement:"Lsing"},fr:{advertisement:"Publicit","learn-more":"En savoir plus"},fy:{advertisement:"Advertinsje"},gl:{advertisement:"Anuncio"},gv:{advertisement:"Soilsheen"},he:{advertisement:""},hu:{advertisement:"Hirdets"},id:{advertisement:"Iklan","learn-more":"Baca Selengkapnya"},inh:{advertisement:""},it:{advertisement:"Pubblicit","learn-more":"Ulteriori informazioni"},ja:{advertisement:"","learn-more":""},ko:{advertisement:""},krc:{advertisement:"P"},lb:{advertisement:"Reklamm"},mk:{advertisement:"P"},mr:{advertisement:""},ms:{advertisement:"Iklan"},nl:{advertisement:"Advertentie","learn-more":"Meer te weten komen"},no:{advertisement:"Reklame"},pl:{advertisement:"Reklama","learn-more":"Czytaj wicej"},ps:{advertisement:""},pt:{advertisement:"Anncio","learn-more":"Saiba Mais"},"roa-tara":{advertisement:"Pubblecet"},ru:{advertisement:"P","learn-more":" "},si:{advertisement:" "},sl:{advertisement:"Oglas"},"sr-ec":{advertisement:"P"},sv:{advertisement:"Annons"},te:{advertisement:" "},th:{advertisement:""},tr:{advertisement:"Reklam"},"tt-cyrl":{advertisement:"P"},uk:{advertisement:"P"},vi:{advertisement:"Qung co"},"zh-hans":{advertisement:"","learn-more":""},"zh-hant":{advertisement:"","learn-more":""}},Wi="en";function Ki(t){const e=k.get("wiki.targeting.wikiLanguage"),n=e&&void 0!==zi[e]?e:Wi;return zi[n][t]||zi[Wi][t]}class qi{create(t,e){const n=this.createEmptyIframe();return t.appendChild(n),e&&(n.contentWindow.document.open(),n.contentWindow.document.write(e),n.contentWindow.document.close()),n}createEmptyIframe(){const t=document.createElement("iframe");return t.height="0",t.width="0",t.border="0px",t.hspace="0",t.vspace="0",t.marginWidth="0",t.marginHeight="0",t.style.border="0",t.scrolling="no",t.frameBorder="0",t.src="about:blank",t.style.display="inline",t.style.overflow="hidden",t}}var Qi;!function(t){t.site="site",t.page="page",t.tracking="tracking",t.targeting="targeting",t.partners="partners"}(Qi||(Qi={}));const Yi=new class{constructor(){this.logGroup="GlobalContextService",window.fandomContext||this.createEmptyContext()}createEmptyContext(){Ui(this.logGroup,"Creating empty fandomContext"),window.fandomContext={site:{},page:{},tracking:{},partners:{},targeting:{}}}isObject(t){return"object"==typeof t&&!Array.isArray(t)}merge(t,e){const n=n=>this.isObject(e[n])&&Object.prototype.hasOwnProperty.call(t,n)&&this.isObject(t[n]),i=Object.getOwnPropertyNames(e).map((i=>({[i]:n(i)?this.merge(t[i],e[i]):e[i]}))).reduce(((t,e)=>Object.assign(Object.assign({},t),e)),{});return Object.assign(Object.assign({},t),i)}setValue(t,e){window.fandomContext||this.createEmptyContext(),window.fandomContext[t]||(window.fandomContext[t]={}),window.fandomContext[t]=this.merge(window.fandomContext[t],e)}getValue(t,e){if(!window.fandomContext)return;const n=window.fandomContext[t];if(n)return n[e];Ui(this.logGroup,`Attempting to retrieve invalid category "${t}" in context!`)}hasBundle(t){var e,n,i,r;return null===(r=null===(i=null===(n=null===(e=window.fandomContext)||void 0===e?void 0:e.site)||void 0===n?void 0:n.tags)||void 0===i?void 0:i.bundles)||void 0===r?void 0:r.includes(t)}};function Xi(){return Yi.getValue(Qi.partners,"directedAtChildren")}function Ji(t,e){if("function"!=typeof e)throw new Error("LazyQueue used with callback not being a function");if(!(t instanceof Array))throw new Error("LazyQueue requires an array as the first parameter");t.start=()=>{for(;t.length>0;)e(t.shift());t.push=t=>{e(t)}}}class Zi{get length(){return this.items.length}constructor(...t){this.itemFlushCallbacks=[],this.items=[],this.items=[...t],this.setPreFlushPush()}flush(){for(;this.items.length>0;)this.emit(this.items.shift());this.setPostFlushPush()}push(...t){this.pushCommand(...t)}onItemFlush(t){if("function"!=typeof t)throw new Error("onItemFlush used with callback not being a function");this.itemFlushCallbacks.push(t)}setPreFlushPush(){this.pushCommand=(...t)=>{this.items.push(...t)}}setPostFlushPush(){this.pushCommand=(...t)=>{t.forEach((t=>{this.emit(t)}))}}emit(t){this.itemFlushCallbacks.forEach((e=>{e(t)}))}}const tr=new class{constructor(){this.MAX=100,this.ALWAYS_ALLOWED_THRESHOLD=100}isOutboundTrafficAllowed(t="default"){const e=k.get(`services.${t}.allowed`);if("boolean"==typeof e)return e;const n=k.get(`services.${t}.threshold`),i=n>=0&&n<=100?n:this.ALWAYS_ALLOWED_THRESHOLD;let r=!0;return i!==this.ALWAYS_ALLOWED_THRESHOLD&&(r=this.getSeed()<i),i<1&&(r=!1),Ui("outbound-traffic-restrict",`Outbound traffic for: "${t}" is allowed: ${r}`,`Threshold: ${i}`),k.set(`services.${t}.allowed`,r),r}getSeed(){return Math.random()*this.MAX}};function er(t){let e;const n=new Promise((n=>{e=setTimeout((()=>n(t)),t)}));return{cancel(){clearTimeout(e)},promise:n}}const nr=new class{sample(t,e,n=100){return!!function(t){return-1!==(p.get("ignored_samplers")||"").split(",").indexOf(t)}(t)||function(t,e){return Math.floor(Math.random()*(e-0))+0}(0,n)<e}};class ir{createScript(t,e=!0,n=null,i={},r={}){const o=document.createElement("script");if(o.async=e,o.defer=!e,o.src=t,Object.keys(i).forEach((t=>{o.setAttribute(t,i[t])})),Object.keys(r).forEach((t=>{o.dataset[t]=r[t]})),"string"==typeof n){const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(o,t)}else(n||document.body).appendChild(o);return o}loadScript(t,e=!0,n=null,i={},r={}){return new Promise(((o,s)=>{const a=this.createScript(t,e,n,i,r);a.onload=o,a.onerror=s}))}loadAsset(t,e="json"){const n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType=e,new Promise((t=>{n.addEventListener("timeout",(()=>{t(null)})),n.addEventListener("error",(()=>{t(null)})),n.onreadystatechange=function(){this.readyState===this.DONE&&(200===this.status?t(this.response):t(null))},n.send()}))}loadSync(t){try{const e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),200===e.status&&0!==e.responseText.length&&e.responseText}catch(t){return!1}}}const rr=new ir;function or(){return["fandom.com","tvguide.com","metacritic.com","gamespot.com","giantbomb.com","muthead.com","fandom-ae-assets.s3.amazonaws.com","fanatical.com"].find((t=>window.location.hostname.includes(t)))?"https://services.fandom.com/":"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/"}const sr=new class{constructor(){this.adTargeting={},this.onChangeCallbacks=[],this.pageTargetingGroupName="PAGE_TARGETING",this.sentryEnabled=!1,this.sentryKey="fs",this.sentryValue="t",b.isDebugMode()&&(window.ads.adTargeting=this.adTargeting)}clear(t=null){const e=t||this.pageTargetingGroupName;this.adTargeting[e]={}}extend(t,e=null){const n=e||this.pageTargetingGroupName;this.adTargeting[n]=this.adTargeting[n]||{},this.adTargeting[n]=Object.assign(this.adTargeting[n],t),this.ensureSentryIsLast(n)}dump(t=null){const e=t||this.pageTargetingGroupName;return this.adTargeting[e]=this.adTargeting[e]||{},this.ensureSentryIsLast(e),this.adTargeting[e]}get(t,e=null){const n=e||this.pageTargetingGroupName;if(this.adTargeting[n])return this.ensureSentryIsLast(n),this.adTargeting[n][t]}set(t,e,n=null){if(void 0!==e){const i=n||this.pageTargetingGroupName;this.adTargeting[i]=this.adTargeting[i]||{},this.adTargeting[i][t]=e,i===this.pageTargetingGroupName&&this.triggerOnChange(t,e),this.ensureSentryIsLast(i)}}remove(t,e=null){const n=e||this.pageTargetingGroupName;this.adTargeting[n]&&this.adTargeting[n][t]&&(delete this.adTargeting[n][t],n===this.pageTargetingGroupName&&this.triggerOnChange(t,null),this.ensureSentryIsLast(n))}onChange(t){this.onChangeCallbacks=this.onChangeCallbacks||[],this.onChangeCallbacks.push(t)}removeListeners(){this.onChangeCallbacks=[]}triggerOnChange(t,e){this.onChangeCallbacks.forEach((n=>{n(t,e)}))}addSentryFlag(t){this.sentryEnabled=t}ensureSentryIsLast(t){if(this.sentryEnabled&&this.adTargeting[t]&&Object.keys(this.adTargeting[t]||{}).length>0){const e=this.adTargeting[t],n=this.sentryKey,i=(e[n],function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["symbol"==typeof n?n:n+""]));this.adTargeting[t]=Object.assign(Object.assign({},i),{[this.sentryKey]:this.sentryValue})}}},ar=new class{build(t,e={}){const n=t.match(/{(.+?)}/g);let i=t;return n&&n.forEach((t=>{const n=t.replace("{","").replace("}",""),r=k.get(n),o=n.split(".");let s,a,c=e[o[0]];if(c)for(s=1;s<o.length;s+=1){if(a=o[s],void 0===c[a]){c=void 0;break}c=c[a]}void 0===c&&n.startsWith("targeting.")&&(c=sr.get(n.replace("targeting.",""))),void 0===c&&(c=r),void 0!==c&&(i=i.replace(t,c))})),i}};class cr{constructor(t){this.container=t}static containsValue(t,e){const n=e.toUpperCase();return t.some((t=>t.toUpperCase()===n))}getHostnamePrefix(){const t=this.container.location.hostname.toLowerCase(),e=/(^|.)(showcase|externaltest|preview|verify|stable|sandbox-[^.]+)\./.exec(t);if(e&&e.length>2)return e[2];const n=t.split(".");return n.length?n[0]:void 0}getRawDbName(t){return`_${t||"wikia"}`.replace("/[^0-9A-Z_a-z]/","_")}getTargetingBundles(t){const e=sr.get("bundles")||[];try{const n=[];Object.keys(t).forEach((e=>{this.matchesTargetingBundle(t[e])&&n.push(e)})),n.forEach((t=>{cr.containsValue(e,t)||e.push(t)}))}catch(t){Ui("targeting-bundles","Invalid input data!")}return this.applyCodeLevelBundles(e)}applyCodeLevelBundles(t){(new g).getItem("_ae_intrsttl_imp")&&t.push("interstitial_disabled");const e=sr.get("skin");e&&e.includes("ucp_")&&!cr.containsValue(t,"VIDEO_TIER_1_AND_2_BUNDLE")&&t.push("VIDEO_TIER_3_BUNDLE");const n=sr.get("word_count")||-1;return n>-1&&n<=100&&(t.push("short_page"),k.set("custom.short_page",!0)),t}matchesTargetingBundle(t){return!Object.keys(t).some((e=>{const n=sr.get(e);if(!n)return!0;if(Array.isArray(n)){if(!t[e].some((t=>n.includes(t))))return!0}else if(!t[e].includes(n))return!0;return!1}))}}const ur=new cr(window),lr=new class extends ir{loadScriptWithStatus(t,e){const n=Object.create(null,{loadScript:{get:()=>super.loadScript}});return s(this,arguments,void 0,(function*(t,e,i=!0,r=null,o={},s={}){Ui(e,"loading"),dn.emit(hn,{status:e+"_started"});const a=yield n.loadScript.call(this,t,i,r,o,s);return dn.emit(hn,{status:e+"_loaded"}),Ui(e,"ready"),a}))}};function dr(t={},e=[]){if(t)return e.find((e=>{if("string"!=typeof e)throw new Error("property name must be a string");return e in t}))}function pr(t,e=[]){const n=dr(t,e);if(n){const e=t[n];return"function"==typeof e?e.bind(t):e}}var hr;!function(t){t.CUSTOM_EVENT="customEvent",t.SLOT_ADDED_EVENT="slotAdded",t.SLOT_REQUESTED_EVENT="slotRequested",t.SLOT_RESPONSE_RECEIVED="slotResponseReceived",t.SLOT_LOADED_EVENT="slotLoaded",t.SLOT_VIEWED_EVENT="slotViewed",t.SLOT_RENDERED_EVENT="slotRendered",t.SLOT_VISIBILITY_CHANGED="slotVisibilityChanged",t.SLOT_BACK_TO_VIEWPORT="slotBackToViewport",t.SLOT_LEFT_VIEWPORT="slotLeftViewport",t.SLOT_STATUS_CHANGED="slotStatusChanged",t.DESTROYED_EVENT="slotDestroyed",t.DESTROY_EVENT="slotDestroy",t.HIDDEN_EVENT="slotHidden",t.SHOWED_EVENT="slotShowed",t.VIDEO_VIEWED_EVENT="videoViewed",t.VIDEO_AD_REQUESTED="videoAdRequested",t.VIDEO_AD_ERROR="videoAdError",t.VIDEO_AD_IMPRESSION="videoAdImpression",t.VIDEO_AD_USED="videoAdUsed",t.TEMPLATES_LOADED="Templates Loaded"}(hr||(hr={}));const fr={name:"A9 Apstag HEM sent"},gr={category:"[Prebid]",name:"Call per group",payload:{_as:"props",_p:void 0}},mr="message-bus",vr=new class{constructor(t=window){this.source=t,this.isInitialized=!1,this.callbacks=[]}init(){this.isInitialized||(Ui(mr,"Register message listener"),this.source.addEventListener("message",(t=>this.onMessage(t)),!1),this.isInitialized=!0)}register(t,e){this.init(),this.callbacks.push({match:t,fn:e})}onMessage(t){let e,n=0;if(this.isAdEngineMessage(t))for(Ui(mr,"Message received",t),n=0;n<this.callbacks.length;n+=1)if(e=this.callbacks[n],this.messageMatch(e.match,t))return Ui(mr,"Matching message",t,e),e.fn(this.getDataFromMessage(t).AdEngine),void(e.match.infinite||this.callbacks.splice(n,1))}isAdEngineMessage(t){const e=this.getDataFromMessage(t);return!!e&&!!e.AdEngine}messageMatch(t,e){let n=!0;if(t.origin&&!t.origin.includes(e.origin))return!1;if(t.keys){const i=this.getDataFromMessage(e).AdEngine;t.keys.forEach((t=>{n=n&&i[t]}))}return n}getDataFromMessage(t){if("string"==typeof t.data)try{return JSON.parse(t.data)}catch(t){return}return t.data}},yr="slot-tweaker";class br{forceRepaint(t){return t.offsetWidth}addDefaultClasses(t){const e=t.getElement(),n=t.getConfigProperty("defaultClasses")||[];e&&n.length&&n.forEach((t=>e.classList.add(t)))}collapse(t){const e=t.getElement();e.style.maxHeight=`${e.scrollHeight}px`,this.forceRepaint(e),e.classList.add("slot-animation"),e.style.maxHeight="0"}expand(t){const e=t.getElement();e.style.maxHeight=`${e.offsetHeight}px`,e.classList.remove(Qn.HIDDEN_AD_CLASS),e.classList.add("slot-animation"),e.style.maxHeight=`${e.scrollHeight}px`}makeResponsive(t){return s(this,arguments,void 0,(function*(t,e=null,n=!0){t.addClass("slot-responsive"),Ui(yr,"make responsive",t.getSlotName());const i=yield this.onReady(t);return this.setPaddingBottom(i,e,n),i}))}setPaddingBottom(t,e,n=!0){let i,r=e;if(oi(t)){if(!e){const e=t.contentWindow.document.body.scrollHeight;r=t.contentWindow.document.body.scrollWidth/e}i=t.parentElement}else i=t;n&&(i.style.paddingBottom=100/r+"%")}onReady(t){function e(){const e=t.getIframe();if(!e)throw new Error("Cannot find iframe element");return e}return t.getConfigProperty("useGptOnloadEvent")?t.loaded.then(e):new Promise((n=>{const i=e();let r=null;try{r=i.contentWindow.document}catch(e){Ui(yr,t.getSlotName(),"loaded through SafeFrame")}r&&"complete"===r.readyState?n(i):i.addEventListener("load",(()=>n(i)))}))}adjustIframeByContentSize(t){return s(this,void 0,void 0,(function*(){const e=yield this.onReady(t);if(oi(e)){const n=e.contentWindow.document.body.scrollHeight,i=e.contentWindow.document.body.scrollWidth;e.width=i.toString(),e.height=n.toString(),Ui(yr,"adjust size",t.getSlotName(),i,n)}return e}))}registerMessageListener(t){vr.register({keys:["action","slotName"],infinite:!0},(e=>{if(!e.slotName)return void Ui(yr,"Missing slot name");const n=t(e.slotName);switch(e.action){case"expand":this.expand(n);break;case"collapse":this.collapse(n);break;case Qn.HIDDEN_AD_CLASS:n.hide();break;case"show":n.show();break;case"make-responsive":this.makeResponsive(n,e.aspectRatio);break;default:Ui(yr,"Unknown action",e.action)}}))}setDataParam(t,e,n){const i=t.getElement();i&&(i.dataset[e]="string"==typeof n?n:JSON.stringify(n))}}br.SLOT_CLOSE_IMMEDIATELY="force-close";const wr=new br,_r="slot-service",Sr=new class{constructor(){this.slotStatuses={},this.slotStates={},this.slots={}}add(t){const e=t.getSlotName();this.slots[e]=t,!1===this.slotStates[e]&&t.disable(this.slotStatuses[e]),!0===this.slotStates[e]&&t.enable(),wr.addDefaultClasses(t),dn.emit(on,{name:e,slot:t,state:hr.SLOT_ADDED_EVENT})}removeAll(){Object.values(this.slots).forEach((t=>this.remove(t)))}remove(t){const e=t.getSlotName();k.removeListeners(`slots.${e}`),t.destroy(),delete this.slots[e],delete this.slotStates[e],delete this.slotStatuses[e]}get(t){if(t.includes("gpt_unit_")){const e=this.getGptAdSlot(t);return this.setGptAdSlotInsertId(e,t),e}const[e]=t.split(",");if(this.slots[e])return this.slots[e];let n=null;return this.forEach((t=>{if(null!==n)return;const i=sr.get("pos",t.getSlotName())||[];i!==e&&i[0]!==e||(n=t)})),n}getSlotId(t){let e=k.get(`slots.${t}.uid`);return e||(e=gi(),k.set(`slots.${t}.uid`,e)),e}forEach(t){Object.keys(this.slots).forEach((e=>{t(this.slots[e])}))}enable(t){this.setState(t,!0)}disable(t,e=null){this.setState(t,!1,e)}getState(t){return!1!==this.slotStates[t]}setState(t,e,n=null){const i=this.get(t);this.slotStates[t]=e,this.slotStatuses[t]=n,i?(i.setStatus(n),e?i.enable():i.disable()):e?k.set(`slots.${t}.disabled`,!1):k.set(`slots.${t}.disabled`,!0),Ui(_r,"set state",t,e)}hasViewportConflict(t){if(!t.hasDefinedViewportConflicts()||null===t.getElement())return!1;const e=t.getElement().offsetHeight,n=Zn(t.getElement()),i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=t.getViewportConflicts().some((t=>function(t,e,n,i){const r=document.getElementById(i);if(null===r.offsetParent)return!1;const o=r.offsetHeight,s=Zn(r);return(s<e?e-s-o:s-e-t)<n}(e,n,i,t)));return Ui(_r,"hasViewportConflict",t.getSlotName(),r),r}get slotConfigsMap(){return k.get("slots")||{}}getFirstCallSlotNames(){return Object.entries(this.slotConfigsMap).filter((([,t])=>!!t.firstCall)).map((([t])=>t))}getNonFirstCallSlotNames(){return Object.entries(this.slotConfigsMap).filter((([,t])=>!t.firstCall)).map((([t])=>t))}getEnabledSlotNames(){return Object.entries(this.slotConfigsMap).filter((([,t])=>!t.disabled)).map((([t])=>t))}pushSlot(t){this.pushSlotById(t.id)}pushSlotById(t){const e=function(){const t=k.get("state.adStack");return Ui("ad-engine","getting adStack: ",...t),t}();e?(Ui(_r,`Push slot ${t} to adStack.`),this.addToAdStack(e,t)):Ui(_r,`Could not push slot ${t} because adStack is not present.`)}addToAdStack(t,e){!function(t,e){const n=!!k.get(`slots.${t}.bidBeforeRun`),i=k.get(`slots.${t}.bidGroup`);n&&i?(Ui("bid-before-run",`Bid before push ${t}`),dn.emit(gr,{group:i,callback:()=>{e()}})):e()}(e,(()=>{t.push({id:e})}))}getGptAdSlot(t){const e=k.get("custom.serverPrefix"),n=new RegExp(`/${e?`${e}.`:""}[A-Z]+/(?<slotName>[a-z_]+)/`),i=t.match(n);try{return this.slots[i.groups.slotName]}catch(t){throw new Error("Unsupported GPT Template slot id format")}}setGptAdSlotInsertId(t,e){t.setConfigProperty("insertId",e)}},Er={isGdprConsentRequired:function(){return!!k.get("options.geoRequiresConsent")},isOptedIn:function(t){return!!(null!=t?t:k.get("options.trackingOptIn"))},isOptOutSale:function(t){return!!k.get("options.isSubjectToCcpa")||!!(null!=t?t:k.get("options.optOutSale"))}},kr=["preroll","midroll","postroll"],Tr="https://pubads.g.doubleclick.net/gampad/ads?";function Ir(t,e={},n=!0){const i=sr.dump()||{},r={};Object.keys(i).forEach((t=>{!function(t,e){"function"==typeof e?r[t]=e():"undefined"!==e&&null!==e&&(r[t]=e)}(t,i[t])})),dn.emit(cn,{slot:t});const o=Object.assign(Object.assign(Object.assign({},r),t.getTargeting()),e),s=Object.keys(o).filter((t=>o[t])).map((t=>`${t}=${o[t]}`)).join("&");return n?encodeURIComponent(s):s}function Or(t,e,n={}){const i=["output=xml_vast4","env=vp","gdfp_req=1","impl=s","unviewed_position_start=1",`url=${encodeURIComponent(window.location.href)}`,`description_url=${encodeURIComponent(window.location.href)}`,`correlator=${Math.round(1e10*Math.random())}`],r=Sr.get(e),o=sr.get("ppid"),s=sr.get("over18");if(s&&i.push(`over_18=${s}`),o&&i.push(`ppid=${o}`),Xi()&&i.push("tfcd=1"),r)i.push(`iu=${r.getVideoAdUnit()}`),i.push(`sz=${function(t){const e=t.getVideoSizes();return e?e.map((t=>t.join("x"))).join("|"):"640x480"}(r)}`),i.push(`cust_params=${Ir(r,n.targeting)}`);else{if(!n.videoAdUnitId||!n.customParams)throw Error("Slot does not exist!");i.push(`iu=${n.videoAdUnitId}`),i.push("sz=640x480"),i.push(`cust_params=${encodeURIComponent(n.customParams)}`)}if(n.contentSourceId&&n.videoId&&(i.push(`cmsid=${n.contentSourceId}`),i.push(`vid=${n.videoId}`)),n.vpos&&kr.indexOf(n.vpos)>-1&&i.push(`vpos=${n.vpos}`),void 0!==n.numberOfAds&&i.push(`pmad=${n.numberOfAds}`),i.push("rdp="+(Er.isOptOutSale()?1:0)),i.push("npa="+(Er.isOptedIn()?0:1)),n.isTagless){const t=k.get("options.geoRequiresConsent"),e=k.get("options.geoRequiresSignal");i.push("tagless=1"),t?i.push("gdpr=1"):i.push("gdpr=0"),t&&n.gdpr_consent&&i.push(`gdpr_consent=${n.gdpr_consent}`),e&&n.us_privacy&&i.push(`us_privacy=${n.us_privacy}`)}return Tr+i.join("&")}const xr={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var Cr,Ar=new Uint8Array(16);function Lr(){if(!Cr&&!(Cr="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Cr(Ar)}for(var Pr=[],Dr=0;Dr<256;++Dr)Pr.push((Dr+256).toString(16).slice(1));const Rr=function(t,e,n){if(xr.randomUUID&&!e&&!t)return xr.randomUUID();var i=(t=t||{}).random||(t.rng||Lr)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(var r=0;r<16;++r)e[n+r]=i[r];return e}return function(t,e=0){return(Pr[t[e+0]]+Pr[t[e+1]]+Pr[t[e+2]]+Pr[t[e+3]]+"-"+Pr[t[e+4]]+Pr[t[e+5]]+"-"+Pr[t[e+6]]+Pr[t[e+7]]+"-"+Pr[t[e+8]]+Pr[t[e+9]]+"-"+Pr[t[e+10]]+Pr[t[e+11]]+Pr[t[e+12]]+Pr[t[e+13]]+Pr[t[e+14]]+Pr[t[e+15]]).toLowerCase()}(i)},Nr=new class{v4(){return Rr()}},jr=new class{constructor(){this.serviceName="scroll-listener",this.callbacks={}}init(){let t=!1;document.addEventListener("scroll",(e=>{t||(window.requestAnimationFrame((()=>{t=!1,Object.keys(this.callbacks).forEach((t=>{"function"==typeof this.callbacks[t]&&this.callbacks[t](e.type,t)}))})),t=!0)})),Ui(this.serviceName,"Service initialised.")}addSlot(t,{threshold:e,distanceFromTop:n}={}){const i=document.getElementById(t);i?void 0!==e||void 0!==n?void 0===e||void 0===n?(Ui(this.serviceName,`Add slot ${t}.`),this.addCallback(((t,r)=>{const o=window.scrollY||window.pageYOffset||document.documentElement.scrollTop;if(void 0!==e){const t=Zn(i);o+ei()>t-e&&(this.removeCallback(r),Sr.pushSlot(i))}else o>n&&(this.removeCallback(r),Sr.pushSlot(i))}))):Ui(this.serviceName,"either threshold or distanceFromTop can be initialised, not both"):Ui(this.serviceName,"either threshold or distanceFromTop must be initialised"):Ui(this.serviceName,`Node with id ${t} not found.`)}addCallback(t){const e=this.getUniqueId();return this.callbacks[e]=t,e}removeCallback(t){delete this.callbacks[t]}getUniqueId(){return(16777216*(1+Math.random())).toString(16).substring(1)}},Mr={addListener:function(t,e,n={}){const i={element:t,callback:e,offsetTop:n.offsetTop||0,offsetBottom:n.offsetBottom||0,areaThreshold:n.areaThreshold,inViewport:!1},r=()=>{!function(t){const e=ii(t.element,{topOffset:t.offsetTop,bottomOffset:t.offsetBottom,areaThreshold:t.areaThreshold});e!==t.inViewport&&(t.callback(e),t.inViewport=e)}(i)};return i.id=jr.addCallback(r),r(),i.id},removeListener:function(t){jr.removeCallback(t)}};class Vr{constructor(t,e=100,n=0,i=0){this.condition=t,this.noTries=e,this.growingTimeout=n,this.fixedTimeout=i}until(){return s(this,void 0,void 0,(function*(){let t=0,e=this.growingTimeout||this.fixedTimeout,n=this.condition();for(;!n&&t<this.noTries;)yield this.delay(e),n=this.condition(),this.growingTimeout&&(e*=2),t++;return Promise.resolve(n)}))}delay(t){return new Promise((e=>{this.timeoutId=setTimeout(e,t)}))}reset(){this.timeoutId&&window.clearTimeout(this.timeoutId)}}class $r{constructor(t){this.params=t,this.repository={}}init(){return s(this,arguments,void 0,(function*(t={}){const e={country:mi(),continent:vi(),region:yi()},n=new Ct(this.params),i=new Tt(new mt(zn.getBrowser()),new yt(zn.getDeviceType()),new wt,new St(e));return this.interpreter=yield n.getConfig().then((t=>(new Pt).override(p.getURLSearchParams(),t))).then((e=>i.init(e,t))),this.repository=this.interpreter.getValues(),Ui("instant-config-service","instantiated with",this.repository),this}))}get(t,e){var n,i;return null!==(i=null===(n=this.repository)||void 0===n?void 0:n[t])&&void 0!==i?i:e}getActiveKeyValues(){return this.interpreter.getActiveKeyValues()}getActiveLabradorKeyValues(){return this.interpreter.getActiveLabradorKeyValues()}}var Br;const Gr=A("[AdEngine] set InstantConfig",{_as:"props",_p:void 0});let Ur=class{constructor(t){this.container=t}execute(){return s(this,void 0,void 0,(function*(){const{app:t,env:e,platform:n}=window.ads.context,i=null!=n?n:t,r="dev"===e?"https://services.fandom-dev.pl":"https://services.fandom.com",o=`https://script.wikia.nocookie.net/fandom-ae-assets/icbm/${null!=e?e:"prod"}/icbm_state_${i}.json`,s=yield new $r({appName:i,instantConfigEndpoint:r,instantConfigFallbackEndpoint:o,instantConfigVariant:k.get("wiki.services_instantConfig_variant"),compact:!0}).init();k.set("services.instantConfig.appName",i),this.container.bind($r).value(s),dn.dispatch(Gr({instantConfig:s}))}))}};Ur=r([Ci(),o("design:paramtypes",["function"==typeof(Br=void 0!==Ni&&Ni)?Br:Object])],Ur);const Hr={category:"[AdEngine OptIn]",name:"set opt in",payload:{_as:"props",_p:void 0}},Fr={category:"[AdEngine OptIn]",name:"update opt in",payload:{_as:"props",_p:void 0}},zr={name:"GPT Ready"},Wr={name:"Partners Ready"},Kr={name:"Ad Stack started"},qr="tracking-opt-in-wrapper";let Qr=class{constructor(){window.ads=window.ads||{},this.installConsentQueue()}execute(){return s(this,void 0,void 0,(function*(){return new Promise((t=>{Ui(qr,"Waiting for consents"),dn.on(Hr,(e=>{this.setConsents(e),t()})),dn.on(Fr,this.setConsents)}))}))}setConsents(t){Ui(qr,"TrackingOptIn consents",t),k.set("options.trackingOptIn",t.gdprConsent),k.set("options.geoRequiresConsent",t.geoRequiresConsent),k.set("options.optOutSale",t.ccpaSignal),k.set("options.geoRequiresSignal",t.geoRequiresSignal)}installConsentQueue(){window.ads.consentQueue=new Zi(...window.ads.consentQueue||[]),window.ads.pushToConsentQueue=window.ads.pushToConsentQueue||(t=>{window.ads.consentQueue.push(t)}),dn.on(Hr,(t=>{window.ads.consentQueue.onItemFlush((e=>{console.warn('[AdEngine] You are using deprecated API to get consent.\nPlease use PostQuecast action "[AdEngine OptIn] set opt in" instead.'),e(t)})),window.ads.consentQueue.flush()}))}};var Yr,Xr;Qr=r([Ci(),o("design:paramtypes",[])],Qr);let Jr=class{constructor(t=null,e=null){this.instantConfig=t,this.globalTimeout=e,this.resetInitialized()}isEnabled(t,e=!0){const n="string"==typeof t&&t.startsWith("ic")?this.instantConfig.get(t):this.getContextVariablesValue(t);return e?n&&k.get("options.trackingOptIn")&&!k.get("options.optOutSale")&&!Xi():n}setOptions(t){return this.options=t,this}setInitialized(){this.resolve()}resetInitialized(){this.initialized=new Promise((t=>{this.resolve=t}))}call(){}execute(){return s(this,void 0,void 0,(function*(){var t;this.initializationTimeout=this.getTimeoutPromise(),this.initializationTimeout.then((()=>{this.setInitialized(),this.initialized||Ui("base-service-setup","timeout reached")})),(null===(t=this.options)||void 0===t?void 0:t.dependencies)&&(yield Promise.all(this.options.dependencies)),yield this.call(),this.setInitialized()}))}getContextVariablesValue(t){return"string"==typeof t?k.get(t):t.map((t=>k.get(t))).reduce(((t,e)=>t&&e),!0)}getTimeoutPromise(){var t;return(null===(t=this.options)||void 0===t?void 0:t.timeout)?new Promise((t=>{setTimeout(t,this.options.timeout)})):new Vr((()=>!!this.globalTimeout)).until().then((()=>{var t,e,n;return null!==(n=null===(e=null===(t=this.globalTimeout)||void 0===t?void 0:t.get)||void 0===e?void 0:e.call(t,"partner-pipeline"))&&void 0!==n?n:Promise.resolve()}))}};function Zr(t,e){var n;const i=new URLSearchParams(null===window||void 0===window?void 0:window.location.search);return i.has(t)?null!==(n=i.get(t))&&void 0!==n?n:"":null!=e?e:""}Jr=r([Ci(),o("design:paramtypes",["function"==typeof(Yr=void 0!==$r&&$r)?Yr:Object,"function"==typeof(Xr=void 0!==Fi&&Fi)?Xr:Object])],Jr);const to=()=>f.get("exp_bucket")||"";function eo(){const t=function(){const t=Zr("pf_pathfinder_force_bucket");return void 0===t||0===(null==t?void 0:t.length)?"":t}();return void 0!==t&&(null==t?void 0:t.length)>0?t:to()||"100"}var no,io;(io=no||(no={})).Valid="Valid",io.Invalid="Invalid";const ro=/\d{1,2}/,oo=()=>"undefined"!=typeof window&&void 0!==window.document;function so(t=!1){return t||(oo(),!!(/^localhost/.test(window.location.hostname)||"127.0.0.1"===window.location.hostname||/fandom-dev\.(pl|us)$/.test(window.location.hostname)||window.location.search.includes("pf_debug")||window.location.search.includes("debug")))}const ao=Date.now();function co(){}const uo=(t,e,n=[])=>(i,...r)=>((t,e,n,i,...r)=>{const o=function(t){return"error"===t?console.error:"debug"===t?so()?console.debug:co:console.log}(t),s=`%c${e} | ${function(){var t;return((Date.now()-(oo()?null===(t=window.performance)||void 0===t?void 0:t.timeOrigin:ao))/1e3).toFixed(4)}()}s | ${i}`;r.length?o(s,n,...r):o(s,n)})(e,t,n.join(";"),i,...r);function lo(t){return["color: #fff","padding: 2px 4px","border-radius: 2px",`background-color: ${t}`]}function po(t){return{info:uo(`PathfinderLite | ${t}`,"info",lo("#334")),debug:uo(`PathfinderLite | ${t}`,"debug",lo("#550")),error:uo(`PathfinderLite | ${t}`,"error",lo("#800"))}}function ho(t,e){const n=po("getExperiment"),i=function(t){if(!(null==t?void 0:t.length))return[];const e={};for(const n of t)e[n]=(e[n]||0)+1;return t.filter((t=>e[t]>1))}(Object.assign([],t).map((t=>t.buckets)).flat()),r=t.map((t=>(t.buckets.some((t=>i.includes(t)))&&(t.disabled=!0),t))).filter((t=>!t.disabled)).filter((t=>((t,e)=>{const n=Date.now();let i=!0;return"number"==typeof t&&n<t&&i&&(i=!1),"number"==typeof e&&n>e&&i&&(i=!1),i})(t.startDate,t.endDate)));if(!r)return n.debug("There were no experiment available at this time, if this was not intentional please check your experiment configuration."),null;const o=("function"==typeof e?e:eo)();if(!o)return n.debug("Could not retrieve the current bucket based on the identifier provided. Cannot determine which experiment is suitable to the user."),null;const s=r.find((t=>t.buckets.includes(o)));return s?s||null:(n.debug(`There were no experiment available with the current bucket: ${o}. If this was not intentional please check your experiment configuration.`),null)}function fo({name:t,buckets:e,disabled:n,startDate:i,endDate:r}){const o=po(t);let s=!1;(null==e?void 0:e.length)||(o.debug(`No buckets found for experiment [${t}]. Experiment will not be active.`),s=!0);const a=function(t){return t.map((t=>!ro.test(t))).some(Boolean)?no.Invalid:no.Valid}(e);no.Invalid===a&&(o.debug(`The current bucket(s) [${e}] for experiment [${t}], are invalid. Experiment will not be active.`),s=!0);const c=Date.parse(Zr(`${t}-start-date`));console.debug(`startDateQueryParam: ${c}`);const u=Date.parse(Zr(`${t}-end-date`));return console.debug(`endDateQueryParam: ${u}`),i=isNaN(c)?i:c,console.debug(`startDate: ${i}`),r=isNaN(u)?r:u,console.debug(`endDate: ${r}`),{name:t,buckets:e,disabled:n||s,startDate:i,endDate:r,log:o}}function go(t){const e=sr.get("experiment_groups")||[];e.push(t),sr.set("experiment_groups",e)}uo("PathfinderLite","info",lo("#334")),uo("PathfinderLite","debug",lo("#550")),uo("PathfinderLite","error",lo("#800"));const mo="Peer39Experiment";class vo extends Jr{constructor(){super(...arguments),this.pathfinderExperimentVariantNames={control:"aden-14642-control",active:"aden-14642-variant-1"},this.pathfinderActiveExperimentVariant=ho([fo({name:this.pathfinderExperimentVariantNames.active,buckets:["53","54","55"]}),fo({name:this.pathfinderExperimentVariantNames.control,buckets:["50","51","52"]})]),this.SAFETY_IDS=["v9i3On","I4GWl6","Rm3SiT","bsr004","bsr003","pg0WhF","avbNf2","Z7rJBM","XtODT3","I4GWl7","381","6i4dB6","181","524","HxqYV1","j9PaO9","mm3UXx","8FD8nI"]}call(){this.configure()}configure(){var t;if(function(t,e="",n){return t.get("icExperiments",[]).includes(e)&&!!n}(this.instantConfig,"peer39",this.pathfinderActiveExperimentVariant))switch(Ui(mo,"Peer39 experiment enabled"),null===(t=this.pathfinderActiveExperimentVariant)||void 0===t?void 0:t.name){case this.pathfinderExperimentVariantNames.control:Ui(mo,"Control triggered"),go(this.pathfinderExperimentVariantNames.control),k.set("experiments.peer39",!1);break;case this.pathfinderExperimentVariantNames.active:Ui(mo,"Active triggered"),go(this.pathfinderExperimentVariantNames.active),k.set("experiments.peer39",!0),this.setupPeer39Ids();break;default:Ui(mo,"Nothing triggered. Outside of experiment"),k.set("experiments.peer39",!1)}else Ui(mo,"Peer39 experiment disabled")}setupPeer39Ids(){var t,e;const n=[...null!==(e=null===(t=null===window||void 0===window?void 0:window.fandomPageTagging)||void 0===t?void 0:t.iab_categories)&&void 0!==e?e:[]],{safetyIds:i,mappedIds:r}=this.splitOutSafetyAndMappedIds(n);k.set("peer39.safetyIds",i),i.length>0?Ui(mo,`Safety IDs found: ${i}`):Ui(mo,"No safety IDs found"),k.set("peer39.mappedIds",r),r.length>0?Ui(mo,`Mapped Ids: ${r}`):Ui(mo,"No mapped IDs found")}splitOutSafetyAndMappedIds(t){const e=[],n=[];return t.forEach((t=>{this.SAFETY_IDS.includes(t)?e.push(t):n.push(t)})),{safetyIds:[...new Set(e)],mappedIds:[...new Set(n)]}}}const yo={AD_ENG_LOAD_TIMES:{name:"AdEngLoadTimes",icbmName:"loadTimes",url:"https://beacon.wikia-services.com/__track/special/adengloadtimes",allowed:{sampling:!0,aggregation:!0,aggregationLimit:5}},AD_ENG_BIDDERS:{name:"AdEngBidders",icbmName:"bidders",url:"https://beacon.wikia-services.com/__track/special/adengbidders",allowed:{sampling:!1,aggregation:!1}},AD_ENG_VIEWABILITY:{name:"AdEngViewability",icbmName:"viewability",url:"https://beacon.wikia-services.com/__track/special/adengviewability",allowed:{sampling:!1,aggregation:!1}},AD_ENG_PLAYER_INFO:{name:"AdEngPlayerInfo",icbmName:"playerInfo",url:"https://beacon.wikia-services.com/__track/special/adengplayerinfo",allowed:{sampling:!1,aggregation:!1}},KEY_VALS:{name:"KeyVals",icbmName:"kvs",url:"https://beacon.wikia-services.com/__track/special/keyvals",allowed:{sampling:!1,aggregation:!1}},TOPICS:{name:"GoogleTopics",icbmName:"topics",url:"https://beacon.wikia-services.com/__track/special/topics",allowed:{sampling:!1,aggregation:!1}},AD_ENG_AD_SIZE_INFO:{name:"AdEngAdSizeInfo",icbmName:"adSizeInfo",url:"https://beacon.wikia-services.com/__track/special/adengadsizeinfo",allowed:{sampling:!1,aggregation:!1}},AD_ENG_LABRADOR_INFO:{name:"AdEngLabradorInfo",icbmName:"labrador",url:"https://beacon.wikia-services.com/__track/special/adenglabradorinfo",allowed:{sampling:!1,aggregation:!1}},AD_ENG_DEV_LABRADOR_INFO:{name:"AdEngDevLabradorInfo",icbmName:"labradorDev",url:"https://beacon.wikia-services.com/__track/special/adengdevlabradorinfo",allowed:{sampling:!1,aggregation:!1}},AD_ENG_AD_INFO:{name:"AdEngAdInfo",icbmName:"adInfo",url:"https://beacon.wikia-services.com/__track/special/adengadinfo",allowed:{sampling:!1,aggregation:!1}},IDENTITY_INFO:{name:"IdentityInfo",icbmName:"idInfo",url:"https://beacon.wikia-services.com/__track/special/identityinfo",allowed:{sampling:!1,aggregation:!1}},TRACKING_EVENT:{name:"TrackingEvent",icbmName:"trackingEvent",url:"https://beacon.wikia-services.com/__track/special/trackingevent",allowed:{sampling:!1,aggregation:!1}},VIDEO_PLAYER_EVENT:{name:"VideoPlayerEvent",icbmName:"videoPlayerEvent",url:"https://beacon.wikia-services.com/__track/special/videoplayerevent",allowed:{sampling:!1,aggregation:!1}}};var bo;let wo=class{constructor(t){this.instantConfig=t}execute(){return s(this,void 0,void 0,(function*(){var t,e;yield this.setTrackingParameters(),k.set("services.dw-tracker.compression",this.instantConfig.get("dwTrafficCompression",!1)),Object.values(yo).forEach((t=>{var e,n;const i=t.name.toLowerCase();t.allowed.sampling&&k.set(`services.dw-tracker-${i}.threshold`,null===(e=this.instantConfig.get("dwTrafficLimits",{})[t.icbmName])||void 0===e?void 0:e.sample),k.set(`services.dw-tracker-${i}.aggregate`,!!t.allowed.aggregation&&(null===(n=this.instantConfig.get("dwTrafficLimits",{})[t.icbmName])||void 0===n?void 0:n.agg))})),(null===(e=null===(t=window.ads)||void 0===t?void 0:t.version)||void 0===e?void 0:e.ae)&&sr.set("aeVer",window.ads.version.ae)}))}getTrackingParameters(){return s(this,void 0,void 0,(function*(){return yield new Vr((()=>{var t;return!!(null===(t=window.fandomContext)||void 0===t?void 0:t.tracking)}),10,100).until(),Object.assign({},window.fandomContext.tracking)}))}setTrackingParameters(){return s(this,void 0,void 0,(function*(){const t=yield this.getTrackingParameters();k.set("wiki",Object.assign(Object.assign({},k.get("wiki")),t))}))}};wo=r([Ci(),o("design:paramtypes",["function"==typeof(bo=void 0!==$r&&$r)?bo:Object])],wo);const _o=new class{constructor(t=!1){this.isActive=t}activate(){this.isActive=!0}sendToMeteringSystem(t){if(!this.isActive)return;const e=this.getEndpointInfoFromContext(),n=this.getEndpointUrlFor("time",e),i=[];Object.entries(t).forEach((([t,e])=>{i.push(`${t}=${encodeURIComponent(e)}`)})),(new ci).fetch(`${n}?app=${e.appName}&${i.join("&")}`,2e3,{mode:"no-cors"})}getEndpointInfoFromContext(){return{baseUrl:k.get("services.monitoring.endpoint"),service:k.get("services.monitoring.service"),appName:k.get("services.instantConfig.appName")}}getEndpointUrlFor(t,{baseUrl:e,service:n}){return[e,n,"api","adengine","meter",t].filter((t=>!!t)).join("/")}},So={stateMetric:["top_leaderboard"],timingMetric:["top_leaderboard"],reportedGamSlotRequests:[],reportedGamSlotRenders:[]};class Eo{constructor(t){this.sender=t,this.isActive=tr.isOutboundTrafficAllowed("monitoring-default")}initialise(){this.isActive&&(this.trackLibInitialization(),this.trackGptLibReady(),this.trackGamSlotRequest(),this.trackGamSlotRendered())}trackLibInitialization(){this.sender.sendToMeteringSystem({action:"init",duration:Math.round(Bi())})}trackGptLibReady(){dn.on(zr,(()=>{this.sender.sendToMeteringSystem({action:"gpt-ready",duration:Math.round(Bi())})}))}trackGamSlotRequest(){dn.onSlotEvent(hr.SLOT_REQUESTED_EVENT,(({slot:t})=>{So.reportedGamSlotRequests.includes(t.getSlotName())||(this.sendSlotInfoToMeteringSystem(t,"request"),So.reportedGamSlotRequests.push(t.getSlotName()))}))}trackGamSlotRendered(){dn.onSlotEvent(hr.SLOT_RENDERED_EVENT,(({slot:t})=>{So.reportedGamSlotRenders.includes(t.getSlotName())||(this.sendSlotInfoToMeteringSystem(t,"render"),So.reportedGamSlotRenders.push(t.getSlotName()))}))}sendSlotInfoToMeteringSystem(t,e){if(!So.stateMetric.includes(t.getSlotName()))return;this.sender.sendToMeteringSystem({action:`${e}_${t.getSlotName()}`,duration:Math.round(Bi())});const n=k.get("wiki").targeting.wikiDbName;["plpankleks","kiepscy","prisonbreak","harrypotter"].includes(n)&&this.sender.sendToMeteringSystem({action:`${n}_${e}_${t.getSlotName()}`,duration:Math.round(Bi())})}}var ko;let To=class{constructor(t){this.instantConfig=t}execute(){return s(this,void 0,void 0,(function*(){const t=or()||"";k.set("services.monitoring.endpoint",t.replace(/\/+$/,"")),k.set("services.monitoring.service","adeng");const e=this.instantConfig.get("icMonitorTrafficThreshold",{default:0}),n="number"==typeof e?{default:e}:e;Object.keys(n).forEach((t=>{k.set(`services.monitoring-${t}.threshold`,n[t])})),tr.isOutboundTrafficAllowed("monitoring-default")&&_o.activate(),new Eo(_o).initialise()}))}};To=r([Ci(),o("design:paramtypes",["function"==typeof(ko=void 0!==$r&&$r)?ko:Object])],To);const Io=new class{constructor(){this.defaultVersion=2}get exists(){return!!window.__tcfapi}getTCData(t){return new Promise((e=>{window.__tcfapi("addEventListener",t||this.defaultVersion,(t=>e(t)))}))}override(t){window.__tcfapi=t}},Oo=new class{get exists(){return!!window.__uspapi}getSignalData(t){return new Promise((e=>{window.__uspapi("getUSPData",t,(t=>e(t)))}))}override(t){window.__uspapi=t}},xo="universal-storage";class Co{constructor(){this.storage={}}clear(){this.storage={}}getItem(t){return this.storage[t]}removeItem(t){delete this.storage[t]}setItem(t,e){this.storage[t]=e}}class Ao{constructor(t=(()=>window.localStorage)){this.fallbackStorage=new Co;try{this.provider=t(),this.isAvailable()||(Ui(xo,"StorageProvider doesn't work, fallback to the InMemoryProvider"),this.provider=this.fallbackStorage)}catch(t){Ui(xo,"StorageProvider doesn't work, fallback to the InMemoryProvider"),this.provider=this.fallbackStorage}}isAvailable(){try{return this.provider.setItem("ae3-provider-storage-test","1"),this.provider.getItem("ae3-provider-storage-test"),this.provider.removeItem("ae3-provider-storage-test"),!0}catch(t){return!1}}getItem(t,e=!1){try{let n=this.provider.getItem(t);if(e)return n;try{n=JSON.parse(n)}catch(t){return n}return n}catch(e){return this.fallbackStorage.getItem(t)}}setItem(t,e,n){const i=e instanceof Object?JSON.stringify(e):e;try{this.provider.setItem(t,i,n)}catch(e){Ui(xo,`Item ${t} wasn't set in the storage`,e),this.fallbackStorage.setItem(t,i)}return!0}removeItem(t){try{return this.provider.removeItem(t)}catch(e){this.fallbackStorage.removeItem(t)}}clear(){try{this.provider.clear()}catch(t){this.fallbackStorage.clear()}}}const Lo=new class{constructor(){k.get("services.externalLogger.threshold")||k.set("services.externalLogger.threshold",1),this.isActive=tr.isOutboundTrafficAllowed("externalLogger")}log(t,e={}){if(!this.isActive)return;const n=k.get("services.externalLogger.endpoint");if(!n)return;const i=new FormData;i.set("message",t),Object.keys(e).forEach((t=>{i.set(t,e[t])}));const r=new XMLHttpRequest;r.open("POST",n,!0),r.send(i)}},Po="a9-apstag";class Do{static make(){return Do.instance||Do.reset(),Do.instance}static reset(){return Do.instance=new Do,Do.instance}constructor(){this.renderImpEndCallbacks=[],this.utils=t,this.tcf=Io,this.usp=Oo,this.storage=new Ao,this.insertScript(),this.configure(),this.addRenderImpHook()}insertScript(){this.script=lr.loadScriptWithStatus("//c.amazon-adsystem.com/aax2/apstag.js",Po,!0,"first")}hasRecord(){return!!this.storage.getItem("apstagRecord")}getRecord(){return this.storage.getItem("apstagRecord")}sendMediaWikiHEM(){const t=k.get("wiki.opts.userEmailHashes");if(!Array.isArray(t)||3!==(null==t?void 0:t.length))return;const e=t[2];this.sendHEM(e)}sendHEM(t,e){return s(this,void 0,void 0,(function*(){if(t){if(!k.get("bidders.a9.hem.cleanup")&&k.get("bidders.a9.hem.enabled"))try{yield this.script;const n=!Er.isOptedIn(null==e?void 0:e.gdprConsent)||Er.isOptOutSale(null==e?void 0:e.ccpaSignal),i=n?"1":"0",r=!!this.storage.getItem("apstagHEMsent",!0),o=r&&this.storage.getItem("apstagHEMsent",!0)<Date.now().toString(),s=this.storage.getItem("apstagHEMoptOut",!0)&&i!==this.storage.getItem("apstagHEMoptOut",!0),a=Er.isGdprConsentRequired()?{gdpr:{enabled:!0,consent:(yield this.tcf.getTCData()).tcString}}:{},c=Object.assign({hashedRecords:[{type:"email",record:t}],optOut:n},a);s?(Ui(Po,"Updating user consents",c,"optOut",n),window.apstag.upa(c)):r&&!o||(Ui(Po,"Sending HEM to apstag",c,"optOut",n),window.apstag.rpa(c)),this.storage.setItem("apstagRecord",t),this.storage.setItem("apstagHEMsent",(Date.now()+Do.AMAZON_TOKEN_TTL).toString()),this.storage.setItem("apstagHEMoptOut",i),dn.emit(fr)}catch(t){Ui(Po,"Error sending HEM to apstag",t)}}else Hi(Po,"Trying to send HEM without source record")}))}configure(){window.apstag=window.apstag||{_Q:[]},void 0===window.apstag.init&&(window.apstag.init=(...t)=>{this.configureCommand("i",t)}),void 0===window.apstag.fetchBids&&(window.apstag.fetchBids=(...t)=>{this.configureCommand("f",t)})}addRenderImpHook(){return s(this,void 0,void 0,(function*(){yield this.script;const t=window.apstag.renderImp;window.apstag.renderImp=(...e)=>{t(...e);const[n,i]=e;this.renderImpEndCallbacks.forEach((t=>t(n,i)))}}))}configureCommand(t,e){window.apstag._Q.push([t,e])}init(){return s(this,void 0,void 0,(function*(){let t=null;this.usp.exists&&(t=yield this.usp.getSignalData());const e=this.getApstagConfig(t);if(yield this.script,window.apstag.init(e),k.get("bidders.a9.hem.cleanup")){if(f.get("AMZN-Token")||this.storage.getItem("apstagRecord"))return Ui(Po,"Cleaning Amazon Token..."),window.apstag.dpa(),this.storage.removeItem("apstagRecord"),this.storage.removeItem("apstagHEMsent"),this.storage.removeItem("apstagHEMoptOut"),void f.remove("AMZN-Token",{path:"/"});Ui(Po,"Amazon Token already cleaned")}this.hasRecord()&&this.sendHEM(this.getRecord()),this.sendMediaWikiHEM()}))}fetchBids(t){return s(this,void 0,void 0,(function*(){return yield this.script,Er.isGdprConsentRequired()&&(yield this.tcf.getTCData()),new Promise((e=>{window.apstag.fetchBids(t,(t=>e(t)))}))}))}targetingKeys(){return s(this,void 0,void 0,(function*(){return yield this.script,window.apstag.targetingKeys()}))}enableDebug(){return s(this,void 0,void 0,(function*(){yield this.script,window.apstag.debug("enable")}))}disableDebug(){return s(this,void 0,void 0,(function*(){yield this.script,window.apstag.debug("disable")}))}onRenderImpEnd(t){return s(this,void 0,void 0,(function*(){if("function"!=typeof t)throw new Error("onRenderImpEnd used with callback not being a function");this.renderImpEndCallbacks.push(t)}))}getApstagConfig(t){var e;const n=k.get("bidders.a9.amazonId"),i=null!==(e=sr.get("openrtb2","openrtb2"))&&void 0!==e?e:{};return Lo.log("openrtb2 signals",{signals:JSON.stringify(i)}),Object.assign(Object.assign({pubID:n,videoAdServer:"DFP",deals:!0,gdpr:{cmpTimeout:2e3}},Do.getCcpaIfApplicable(t)),{signals:{ortb2:i}})}static getCcpaIfApplicable(t){return t&&t.uspString?{params:{us_privacy:t.uspString}}:{}}}var Ro;Do.AMAZON_TOKEN_TTL=12096e5;let No=class{constructor(t){this.globalTimeout=t,this.steps=[],this.globalTimeout.set("partner-pipeline",k.get("options.maxDelayTimeout"))}add(...t){return this.steps=t,this}execute(t=[]){return this.steps.forEach((e=>{if("function"==typeof e){const n=e({});n.execute(),t.push(n.initialized)}else e.execute(),t.push(e.initialized)})),Promise.all(t)}};No=r([Ci({scope:"Transient"}),o("design:paramtypes",["function"==typeof(Ro=void 0!==Fi&&Fi)?Ro:Object])],No);const jo="ATS";class Mo extends Jr{constructor(){super(...arguments),this.isLoaded=!1,this.launchpadScriptUrl="https://launchpad-wrapper.privacymanager.io/2f928425-1fbe-4680-b67a-c5f5ad831378/launchpad-liveramp.js",this.launchpadBundleScriptUrl="https://launchpad.privacymanager.io/latest/launchpad.bundle.js"}call(){if(!this.isEnabled("bidders.liveRampATS.enabled"))return void Ui(jo,"disabled");if(Ui(jo,"enabled"),dn.emit(hn,{status:"ats_started"}),this.isLoaded)return void Ui(jo,"not loaded");const t=k.get("wiki.opts.userEmailHashes");if(!Array.isArray(t)||3!==(null==t?void 0:t.length))return void Ui(jo,"no hashes");const[e,n,i]=t,r=rr.loadScript(this.launchpadScriptUrl),o=rr.loadScript(this.launchpadBundleScriptUrl);return Promise.all([r,o]).then((()=>s(this,void 0,void 0,(function*(){const t=k.get("options.geoRequiresConsent")?"gdpr":"ccpa",r="gdpr"===t?(yield Io.getTCData()).tcString:(yield Oo.getSignalData()).uspString;window.ats.setAdditionalData({consentType:t,consentString:r,type:"emailHashes",id:[n,i,e]}),Ui(jo,"additional data set"),this.isLoaded=!0,dn.emit(hn,{status:"ats_loaded"})}))))}}const Vo="audigent",$o=()=>void 0!==window.au_seg;window.au=window.au||[];class Bo extends Jr{constructor(){super(...arguments),this.isLoaded=!1}static loadSegmentLibrary(){Bo.segmentsScriptLoader=rr.loadScript("https://seg.ad.gt/api/v1/s/158",!0,"first").then((()=>{dn.emit(hn,{status:"audigent_segment_library_loaded"})}))}loadMatchesLibrary(){this.matchesTagScriptLoader=rr.loadScript("https://a.ad.gt/api/v1/u/matches/158",!0,"first").then((()=>{dn.emit(hn,{status:"audigent_matches_library_loaded"})}))}call(){return s(this,void 0,void 0,(function*(){this.isEnabled("icAudigent")?(sr.set("AU_SEG","-1"),Bo.sampling=this.instantConfig.get("icAudigentTrackingSampling"),Bo.segmentLimit=this.instantConfig.get("icAudigentSegmentLimit"),!Bo.segmentsScriptLoader&&Bo.loadSegmentLibrary(),!this.matchesTagScriptLoader&&this.loadMatchesLibrary(),this.setupSegmentsListener(),this.isLoaded||(Ui(Vo,"loading..."),this.matchesTagScriptLoader.then((()=>{Ui(Vo,"audience tag script loaded")})),Bo.segmentsScriptLoader.then((()=>{Ui(Vo,"segment tag script loaded"),this.setup()})),this.isLoaded=!0),yield this.waitForAuSegGlobalSet().then((t=>{Ui(Vo,"Audigent global variable set",t,window.au_seg),this.setup()}))):Ui(Vo,"disabled")}))}setup(){$o()&&Bo.sliceAndSetSegmentsInTargeting()}setupSegmentsListener(){Ui(Vo,"setting up auSegReady event listener"),document.addEventListener("auSegReady",(function(t){Ui(Vo,"auSegReady event received",t),dn.emit(hn,{status:"audigent_segments_ready"}),Bo.sliceAndSetSegmentsInTargeting()}))}static sliceAndSetSegmentsInTargeting(){const t=Bo.sliceSegments();Bo.trackWithExternalLoggerIfEnabled(t),Bo.setSegmentsInTargeting(t)}resetLoadedState(){this.isLoaded=!1,this.matchesTagScriptLoader=null,Bo.segmentsScriptLoader=null}static sliceSegments(){const t=window.au_seg.segments||[],e=Bo.segmentLimit||0;let n=t.length?t:"no_segments";return Bo.canSliceSegments(n,e)&&(n=n.slice(0,e)),Ui(Vo,"Sliced segments",n,e,t),n}static setSegmentsInTargeting(t){Ui(Vo,"Setting segments in the targeting",t),sr.set("AU_SEG",t)}static canSliceSegments(t,e){return e>0&&"string"!=typeof t}static trackWithExternalLoggerIfEnabled(t){const e=100*Math.random(),n=Bo.sampling||0;n>0&&e<=n&&"string"!=typeof t&&Lo.log("Audigent segments",{segmentsNo:t.length,segments:t})}waitForAuSegGlobalSet(t=5){const e=k.get("services.audigent.numberOfTries")||t;return new Vr($o,e,250).until()}}class Go{constructor(t,e,n){this.tasksList=t,this.batchSize=e,this.delay=n,this.batchedTasks=[],this.batchTasks()}batchTasks(){this.batchedTasks=[...this.tasksList].reduce(((t,e,n)=>{const i=Math.floor(n/this.batchSize);return t[i]||(t[i]=[]),t[i].push(e),t}),[])}dispatchEventsWithTimeout(t){const e=setInterval((()=>{this.batchedTasks.length<=0?clearInterval(e):this.batchedTasks.shift().forEach((e=>t(e)))}),this.delay)}}class Uo{constructor(){this.contentEncoding="gzip"}compressionSupported(){return void 0!==this.browserSupportsCompression||(this.browserSupportsCompression="function"==typeof wi("CompressionStream")&&"function"==typeof wi("TextEncoder"),this.browserSupportsCompression||Ui("dw_gzip_compressor_debug","DwAggregatedDataGzipCompressor","Compression API not supported")),this.browserSupportsCompression}compress(t){return s(this,void 0,void 0,(function*(){try{if(!this.compressionSupported())return{compressed:t};const e=this.buildStream(t),n=this.gzipStream(e),i=yield this.readStream(n);return Ui("dw_gzip_compressor_debug","DwAggregatedDataGzipCompressor",{uncompressedStringLen:t.length,compressedBytesLen:i.byteLength}),{compressed:i,contentEncoding:this.contentEncoding}}catch(e){return Ui("dw_gzip_compressor_debug","DwAggregatedDataGzipCompressor","Error while compressing data, returning uncompressed data instead.",{error:e}),{compressed:t}}}))}buildStream(t){const e=(new TextEncoder).encode(t);return new ReadableStream({start(t){t.enqueue(e),t.close()}})}gzipStream(t){return t.pipeThrough(new CompressionStream("gzip"))}readStream(t){return s(this,void 0,void 0,(function*(){const e=[],n=t.getReader();let i;for(;!i;){const{done:t,value:r}=yield n.read();t||e.push(r),i=t}const r=new Uint8Array(e.reduce(((t,e)=>t+e.byteLength),0));let o=0;for(const t of e)r.set(new Uint8Array(t.buffer),o),o+=t.byteLength;return r}))}}const Ho="dw-track-sender";class Fo{constructor(t=new Uo){this.dataCompressor=t}sendTrackData(t,e){const n=`${t}_v2`;this.isCompressionEnabled()?this.dataCompressor.compress(JSON.stringify(e)).then((t=>{this.sendRequest(n+t.contentEncoding||"",t.compressed)})):this.sendRequest(n,JSON.stringify(e))}isCompressionEnabled(){return k.get("services.dw-tracker.compression")&&this.dataCompressor.compressionSupported()}sendRequest(t,e){fetch(t,{method:"POST",body:e}).then((e=>{200===e.status?Ui(Ho,{status:"success",url:t}):Ui(Ho,{status:"failed",url:t})}))}}const zo=new class{constructor(){this.AGGREGATION_SECONDS_OFF=5,this.SEND_DATA_INTERVAL=1e3,this.AGGREGATION_LIMIT_PER_TRACK=5,this.sender=new Fo,this.tracksQueues={},this.enabled=!0,this.count=0,this.start()}isAggregatorActive(){return this.enabled}push(t,e){this.tracksQueues[t.name]||(this.tracksQueues[t.name]={track:t,params:[]}),this.tracksQueues[t.name].params.push(e),this.tracksQueues[t.name].params.length>=this.getAggregationLimit(t)&&this.fireAggregatedQueueByTrack(t)}getAggregationLimit(t){var e;return null!==(e=t.allowed.aggregationLimit)&&void 0!==e?e:this.AGGREGATION_LIMIT_PER_TRACK}fireAggregatedQueue(){Object.keys(this.tracksQueues).forEach((t=>{this.fireAggregatedQueueByTrack(this.tracksQueues[t].track)}))}fireAggregatedQueueByTrack(t){var e,n;const i=[];null===(n=null===(e=this.tracksQueues[t.name])||void 0===e?void 0:e.params)||void 0===n||n.forEach((t=>i.push(t))),0!==i.length&&(this.sender.sendTrackData(this.tracksQueues[t.name].track.url,i),this.tracksQueues[t.name]={track:t,params:[]})}start(){const t=setInterval((()=>{this.fireAggregatedQueue(),this.count++,this.count>=this.AGGREGATION_SECONDS_OFF&&(this.enabled=!1,clearInterval(t))}),this.SEND_DATA_INTERVAL);window.addEventListener("visibilitychange",(()=>{document.hidden&&this.fireAggregatedQueue()}))}},Wo=yo.TRACKING_EVENT.url,Ko=yo.VIDEO_PLAYER_EVENT.url,qo="opted-out";let Qo=class{constructor(){this.eventsArray=[],this.init()}init(){k.get("options.delayEvents.enabled")&&document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&this.dispatchAndEmptyEventArray()}))}track(t,e){if(e&&!tr.isOutboundTrafficAllowed(`dw-tracker-${e.name.toLowerCase()}`))return;const n=Object.assign(Object.assign({},this.getDataWarehouseParams()),t);e?this.sendCustomEvent(n,e):this.sendTrackEvent(n)}getDataWarehouseParams(){const t=(t,e)=>Er.isOptedIn()?t():e;return{session_id:t((()=>k.get("wiki.sessionId")||"unknown"),qo),pv_number:k.get("wiki.pvNumber"),pv_number_global:k.get("wiki.pvNumberGlobal"),pv_unique_id:k.get("wiki.pvUID"),beacon:t((()=>k.get("wiki.beaconId")||"unknown"),qo),c:k.get("wiki.wgCityId")||"unknown",ck:k.get("wiki.dsSiteKey")||"unknown",lc:k.get("wiki.wgUserLanguage")||"unknown",s:sr.get("skin")||"unknown",ua:window.navigator.userAgent,u:t((()=>k.get("options.userId")||0),-1),a:parseInt(sr.get("artid")||-1),x:k.get("wiki.wgDBname")||"unknown",n:k.get("wiki.wgNamespaceNumber")||-1}}sendCustomEvent(t,e){const n=Object.assign(Object.assign({},t),this.getTimeBasedParams());k.get(`services.dw-tracker-${e.name.toLowerCase()}.aggregate`)&&zo.isAggregatorActive()&&zo.push(e,n);const i=this.buildDataWarehouseUrl(n,e.url);this.handleDwEvent(i,n)}sendTrackEvent(t,e="Event"){const n=Object.assign(Object.assign({},t),this.getTimeBasedParams());n.ga_category=n.category||"",n.ga_label=n.label||"",n.ga_action=n.action||"",n.ga_value=n.value||"",delete n.category,delete n.label,delete n.action,delete n.value;let i=this.buildDataWarehouseUrl(n,Wo);this.handleDwEvent(i,n,e),"videoplayerevent"===n.eventName&&(i=this.buildDataWarehouseUrl(n,Ko),this.handleDwEvent(i,n,e))}dispatchAndEmptyEventArray(){const{batchSize:t,delay:e}=k.get("options.delayEvents");new Go(this.eventsArray,t,e).dispatchEventsWithTimeout(this.sendRequest),this.eventsArray=[]}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(t,e){if(!e){const t="Error building DW tracking URL";throw Ui("data-warehouse-trackingParams",t),new Error(t)}return`${e}?${p.stringify(t)}`}handleDwEvent(t,e,n="Event"){const i={url:t,params:e,type:n};k.get("options.delayEvents.enabled")?this.afterDocumentCompleted().then((()=>{this.sendRequest(i)})).catch((()=>{this.eventsArray.push(i)})):this.sendRequest(i)}sendRequest({url:t,params:e,type:n="Event"}){const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="json",i.addEventListener("load",(()=>Ui(`DW - Track ${n} Success`,{url:t,params:e}))),i.addEventListener("error",(i=>Ui(`DW - Track ${n} Failed`,{url:t,params:e,err:i}))),i.send()}afterDocumentCompleted(){return s(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{"complete"===document.readyState?t():e()}))}))}};Qo=r([Ci(),o("design:paramtypes",[])],Qo);let Yo=class{constructor(){this.reasons=[]}isAdsMode(){return!this.reasons.length}getReasons(){return[...this.reasons]}addReason(t){this.reasons.unshift(t)}addReasons(t){t&&this.reasons.push(...t)}reset(){this.reasons=[]}};var Xo,Jo,Zo,ts,es;Yo=r([Ci()],Yo);let ns=class{constructor(t,e,n,i,r){this.pipeline=t,this.noAdsDetector=e,this.ats=n,this.audigent=i,this.dwTracker=r}execute(){var t,e,n,i,r,o,s;this.removeAdSlotsPlaceholders(),this.noAdsDetector.addReasons(null!==(n=null===(e=null===(t=window.ads.context)||void 0===t?void 0:t.opts)||void 0===e?void 0:e.noAdsReasons)&&void 0!==n?n:[]);const a=this.noAdsDetector.getReasons(),c=null===(r=null===(i=window.mw)||void 0===i?void 0:i.config)||void 0===r?void 0:r.get("wgCityId"),u=null===(s=null===(o=window.mw)||void 0===o?void 0:o.config)||void 0===s?void 0:s.get("wgArticleId");if(a.length&&this.dwTracker.track({event_type:"no_ads",label:a.join(","),category:"no_ads",c,a:u}),a.includes("blacklisted_word")&&this.dwTracker.track({event_type:"blacklisted_word",label:"blacklisted_word",category:"blacklisted_word",c,a:u}),k.get("state.isLogged")){const t=Do.make();t.init().then((()=>dn.on(Fr,(e=>t.sendHEM(t.getRecord(),e)),!1)))}this.pipeline.add(this.ats).add(this.audigent).execute().then((()=>{dn.emit(Wr),dn.emit(Kr)}))}removeAdSlotsPlaceholders(){document.querySelectorAll(".top-ads-container, .ad-slot-placeholder, .bottom-ads-container").forEach((t=>{t.remove()}))}};ns=r([Ci(),o("design:paramtypes",["function"==typeof(Xo=void 0!==No&&No)?Xo:Object,"function"==typeof(Jo=void 0!==Yo&&Yo)?Jo:Object,"function"==typeof(Zo=void 0!==Mo&&Mo)?Zo:Object,"function"==typeof(ts=void 0!==Bo&&Bo)?ts:Object,"function"==typeof(es=void 0!==Qo&&Qo)?es:Object])],ns);const is="brand-metrics";class rs extends Jr{call(){this.instantConfig.get("icBrandMetrics")?dn.on(an,this.loadScript,!0):Ui(is,"disabled")}loadScript(){const t="//cdn.brandmetrics.com/tag/9097a5369e204e6eac53b45c7dde13c5/fandom.com_au.js";Ui(is,"loading",t),lr.loadScriptWithStatus(t,is).then((()=>{Ui(is,"ready")}))}}const os="captify";class ss extends Jr{constructor(){super(...arguments),this.propertyId=12974}call(){return s(this,void 0,void 0,(function*(){return this.isEnabled("icCaptify")?(this.overwritePropertyIdIfPresent(),this.createCaptifyWindowObject(),this.createAndInsertScript(),Promise.resolve()):(Ui(os,"disabled"),Promise.resolve())}))}overwritePropertyIdIfPresent(){const t=k.get("services.captify.propertyId");this.propertyId=t||this.propertyId}createCaptifyWindowObject(){window[`captify_kw_query_${this.propertyId}`]=""}createAndInsertScript(){const t=`https://p.cpx.to/p/${this.propertyId}/px.js`,e=document.getElementsByTagName("script")[0],n=rr.createScript(t,!1,e);dn.emit(hn,{status:"captify_started"}),n.onload=()=>{dn.emit(hn,{status:"captify_loaded"}),Ui(os,"loaded")}}}const as="experian";class cs extends Jr{constructor(){super(...arguments),this.PARTNER_ID=3442,this.PARTNER_URL_CORE="https://services.fandom.com/identity-storage/external/experian/receiveid",this.EXPERIAN_URL="https://pixel.tapad.com/idsync/ex/receive"}call(){this.isEnabled("icExperian")?this.insertExperianPixel():Ui(as,"disabled")}getExperianPixelUrl(){const t=sr.get("ppid"),e=k.get("wiki.pvUID"),n=`${this.PARTNER_URL_CORE}/${e}?id=\${TA_DEVICE_ID}\n\t\t\t&partner=TAPAD`;return`${this.EXPERIAN_URL}?partner_id=${this.PARTNER_ID}\n\t\t&partner_device_id=${t}&partner_url=${n}`}insertExperianPixel(){dn.emit(hn,{status:"experian_started"}),_n.loadPixel(this.getExperianPixelUrl(),as)}}class us extends Jr{constructor(){super(...arguments),this.PIXEL_ID=712315,this.logGroup="liveramp_pixel",this.PIXEL_URL=`https://idsync.rlcdn.com/${this.PIXEL_ID}.gif?partner_uid=`}insertLiveRampPixel(t){dn.emit(hn,{status:this.logGroup+"_started"});const e=this.PIXEL_URL+t;_n.loadPixel(e,this.logGroup)}call(){return s(this,void 0,void 0,(function*(){this.isEnabled("icLiveRampPixel")?dn.on(pn,(t=>{"Google"===t.payload.partnerName&&this.insertLiveRampPixel(t.payload.partnerIdentityId)})):Ui(this.logGroup,"pixel disabled")}))}}const ls="nielsen-dcr",ds={};class ps extends Jr{constructor(){super(...arguments),this.nlsnInstance=null}call(){const t=sr.dump(),e=k.get("services.nielsen.customSection")||t.s0v,n=t.post_id||t.artid;if(!this.isEnabled("icNielsen",!1))return Ui(ls,"disabled"),null;this.nlsnInstance||(this.nlsnInstance=function(t){var e,n;return Ui(ls,"loading"),(e=window)[n="NOLBUNDLE"]=e[n]||{nlsQ:function(t,i,r,o,s,a){return(o=(s=e.document).createElement("script")).defer=1,o.src=("http:"===e.location.protocol?"http:":"https:")+"//cdn-gl.imrworldwide.com/conf/"+t+".js#name="+i+"&ns="+n,(a=s.getElementsByTagName("script")[0]).parentNode.insertBefore(o,a),e[n][i]=e[n][i]||{g:r||{},ggPM:function(t,r,o,s,a){(e[n][i].q=e[n][i].q||[]).push([t,r,o,s,a])}},e[n][i]}},"1"===p.get("nielsen-dcr-debug")&&(ds.nol_sdkDebug="debug"),window.NOLBUNDLE.nlsQ(t,"nlsnInstance",ds)}("P26086A07-C7FB-4124-A679-8AC404198BA7")),Ui(ls,"ready");const i={type:"static",assetid:`fandom.com/${e}/${t.s1}/${n}`,section:`FANDOM ${e.replaceAll("_"," ").toUpperCase()} NETWORK`};return this.nlsnInstance.ggPM("static",i),Ui(ls,"called",i),this.nlsnInstance}}const hs=["gnre","media","pform","pub","theme","tv"];class fs extends Jr{constructor(){super(...arguments),this.CLIENT_ID=17364,this.logGroup="Lotame",this.PIXEL_URL=`https://tags.crwdcntrl.net/lt/c/${this.CLIENT_ID}/lt.min.js`}call(){return s(this,void 0,void 0,(function*(){var t,e;if(!this.isEnabled("icLotame"))return void Ui(this.logGroup,"pixel disabled");const n={data:{behaviors:{med:function(t={}){return Object.entries(t).filter((([t])=>hs.includes(t))).flatMap((([t,e])=>e.map((e=>`${t}: ${e}`))))}(null===(e=null===(t=window.fandomContext)||void 0===t?void 0:t.site)||void 0===e?void 0:e.tags)}},config:{clientId:this.CLIENT_ID,onTagReady:()=>dn.emit(hn,{status:"lotame_ready"})}},i=n.config||{},r=window["lotame_"+this.CLIENT_ID]={};r.config=i,r.data=n.data||{},r.cmd=r.cmd||[],Ui(this.logGroup,"pixel enabled"),dn.emit(hn,{status:"lotame_started"}),yield rr.loadScript(this.PIXEL_URL),dn.emit(hn,{status:"lotame_loaded"})}))}}const gs=new class{constructor(){this.storage=new Ao}isAvailable(){return this.storage.isAvailable()}getItem(t){const e=this.storage.getItem(t);return!(!e||"string"==typeof e)&&(this.isExpired(e)?(this.delete(t),!1):e.data)}setItem(t,e,n){if(!this.isStorable(e))return!1;const i={data:e,expires:n?1e3*n+Date.now():void 0};return this.storage.setItem(t,i),!0}delete(t){this.storage.removeItem(t)}isStorable(t){const e=!["function","number","undefined"].some((e=>typeof t===e)),n=!("number"==typeof t&&isNaN(t));return e&&n}isExpired(t){return!!t.expires&&t.expires&&Date.now()>=t.expires}},ms="liveConnect",vs=ms,ys=[{id:"unifiedId",name:`${ms}-unifiedId`},{id:"sha2",name:ms},{id:"md5",name:`${ms}-md5`},{id:"sha1",name:`${ms}-sha1`}];class bs extends Jr{constructor(){super(...arguments),this.fallbackQf="0.3"}call(){this.isEnabled("icLiveConnect")&&this.isEnabled("icLiveConnectCachingStrategy")&&!this.isEnabled("icIdentityPartners",!1)?(this.setupStorage(),this.shouldLoadScript()?(Ui(vs,"loading"),dn.emit(gn),rr.loadScript("https://b-code.liadm.com/a-07ev.min.js",!0,"first").then((()=>{Ui(vs,"loaded"),this.resolveAndTrackIds(),dn.emit(yn)}))):(dn.emit(mn),Ui(vs,`already loaded and available in ${this.storageConfig.type}Storage`),this.emitHemReadyEvent())):Ui(vs,"disabled")}resolveAndTrackIds(){var t;if(!window.liQ)return void Hi(vs,"window.liQ not available for tracking");const e=null===(t=this.instantConfig.get("icLiveConnectQf"))||void 0===t?void 0:t.toString();window.liQ.resolve((t=>{this.trackIds(t),this.emitHemReadyEvent()}),(t=>{console.error(t)}),{qf:e||this.fallbackQf,resolve:ys.map((t=>t.id))})}trackIds(t){Ui(vs,"resolve response:",t),Object.keys(t).forEach((e=>{const n=this.getTrackingKeyName(e);if(this.isAvailableInStorage(n))return;"unifiedId"===e&&dn.emit(vn);const i=t[e];Ui(vs,`${e}: ${i}`),i&&(this.storage.setItem(n,i,this.storageConfig.ttl),dn.emit(pn,{partnerName:n,partnerIdentityId:i}))}))}getTrackingKeyName(t){var e;return null===(e=ys.find((e=>e.id===t)))||void 0===e?void 0:e.name}setupStorage(){this.storageConfig=this.instantConfig.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=gs:this.storage=new Ao((()=>window.sessionStorage))}shouldLoadScript(){var t;if(!this.storageConfig)return!0;let e=!1;for(const n of this.storageConfig.mandatoryParams){const i=null===(t=ys.find((t=>t.id===n)))||void 0===t?void 0:t.name;if(!this.isAvailableInStorage(i)){e=!0;break}}return e}isAvailableInStorage(t){return!!this.storage.getItem(t)}emitHemReadyEvent(){const t=this.getTrackingKeyName("sha2");t&&this.isAvailableInStorage(t)&&(dn.emit(bn,{hem:this.storage.getItem(t)}),Ui(vs,"Event LIVE_CONNECT_HEM_READY emitted"))}}var ws,_s,Ss,Es,ks,Ts,Is,Os;let xs=class{constructor(t,e,n,i,r,o,s,a){this.pipeline=t,this.brandMetrics=e,this.captify=n,this.experian=i,this.liveRampPixel=r,this.nielsen=o,this.lotame=s,this.liveConnect=a}execute(){Ui("post-ad-stack-partners","starting"),this.pipeline.add(this.lotame,this.liveConnect,this.liveRampPixel,this.brandMetrics,this.experian,this.captify,this.nielsen).execute().then((()=>{Ui("post-ad-stack-partners","finished")}))}};xs=r([Ci(),o("design:paramtypes",["function"==typeof(ws=void 0!==No&&No)?ws:Object,"function"==typeof(_s=void 0!==rs&&rs)?_s:Object,"function"==typeof(Ss=void 0!==ss&&ss)?Ss:Object,"function"==typeof(Es=void 0!==cs&&cs)?Es:Object,"function"==typeof(ks=void 0!==us&&us)?ks:Object,"function"==typeof(Ts=void 0!==ps&&ps)?Ts:Object,"function"==typeof(Is=void 0!==fs&&fs)?Is:Object,"function"==typeof(Os=void 0!==bs&&bs)?Os:Object])],xs);class Cs{constructor(t){this.adapter=t,this.steps=[]}add(...t){return this.steps.push(...t),this}execute(t,e){const n=this.createFinalNext(e);return this.createExecutor(n)(t)}createFinalNext(t){return t?e=>this.adapter.execute(t,e):t=>s(this,void 0,void 0,(function*(){return t}))}createExecutor(t){return this.steps.reduceRight(((t,e)=>n=>this.adapter.execute(e,n,t)),t)}}var As,Ls;let Ps=class{constructor(t){this.container=t}execute(t,e,n){return s(this,void 0,void 0,(function*(){if(this.isCompoundProcessStep(t)){const e=this.container.get(t.process);return yield e.execute(t.payload),n()}if(this.isDiProcess(t)){const e=this.container.get(t);return yield e.execute(),n()}return yield t(),n()}))}isCompoundProcessStep(t){return"object"==typeof t&&"process"in t&&"function"==typeof t.process.prototype.execute}isDiProcess(t){var e;return"function"==typeof(null===(e=t.prototype)||void 0===e?void 0:e.execute)}};Ps=r([Ci({scope:"Transient"}),o("design:paramtypes",["function"==typeof(As=void 0!==Ni&&Ni)?As:Object])],Ps);let Ds=class extends Cs{constructor(t){super(t.get(Ps))}};var Rs;Ds=r([Ci({scope:"Transient"}),o("design:paramtypes",["function"==typeof(Ls=void 0!==Ni&&Ni)?Ls:Object])],Ds);let Ns=class{constructor(t){this.container=t}execute(t){return Promise.all(t.map((t=>this.container.get(Ds).add(t).execute()))).then()}};var js,Ms;Ns=r([Ci({scope:"Transient"}),o("design:paramtypes",["function"==typeof(Rs=void 0!==Ni&&Ni)?Rs:Object])],Ns),function(t){t.ONE_TRUST="1t",t.TRACKING_OPT_IN="toi"}(js||(js={}));class Vs{constructor(){this.logGroup="identity-setup"}execute(){return s(this,void 0,void 0,(function*(){return Ui(this.logGroup,"initialized"),yield this.identityEngineReady(),this.setupOver18Targeting(),Promise.resolve()}))}identityEngineReady(){return s(this,void 0,void 0,(function*(){return new Promise((t=>{dn.on(wn,(()=>{const e=Yi.getValue("tracking","ppid");e&&sr.set("ppid",e);const n=Yi.getValue("tracking","pvUID");n&&sr.set("pvuid",n),sr.set("browser",Yi.getValue(Qi.targeting,"browser")),sr.set("cl",Yi.getValue(Qi.tracking,"chromeLabel"));const i=Yi.getValue(Qi.targeting,"adGroup");if(sr.set("adGroup",(null==i?void 0:i.split(","))||[]),k.get("services.identityPartners")){const t=Yi.getValue(Qi.targeting,"AU_SEG");sr.set("AU_SEG",t)}Yi.getValue(Qi.site,"directedAtChildren")&&sr.set("monetization",Xi()?"restricted":"regular");const r="browsingTopics"in document&&"featurePolicy"in document&&document.featurePolicy.allowsFeature("browsing-topics")?1:0;sr.set("topics_available",r.toString());const o="joinAdInterestGroup"in navigator&&document.featurePolicy.allowsFeature("join-ad-interest-group")&&document.featurePolicy.allowsFeature("run-ad-auction")?1:0;sr.set("pa_available",o.toString()),sr.set("cmp",this.getCmp()),Ui(this.logGroup,"ready"),t()}))}))}))}setupOver18Targeting(){dn.on(pn,(()=>{const t=window.fandomContext.tracking.over_18;t&&sr.set("over_18",t)}))}getCmp(){return void 0!==window.OneTrust?js.ONE_TRUST:js.TRACKING_OPT_IN}}let $s=class{constructor(t){this.instantConfig=t}execute(){this.setBaseState(),this.setOptionsContext(),function(){const t=Er.isOptedIn()?0:1;sr.set("npa",t.toString())}(),function(){const t=Er.isOptOutSale()?1:0;sr.set("rdp",t.toString())}()}setBaseState(){k.set("state.deviceType",zn.getDeviceType()),k.set("state.isLogged",!!k.get("wiki.wgUserId"))}setOptionsContext(){k.set("options.delayEvents",this.instantConfig.get("icDelayEvents"))}};$s=r([Ci(),o("design:paramtypes",["function"==typeof(Ms=void 0!==$r&&$r)?Ms:Object])],$s);class Bs{execute(){const t=window.ads.context&&window.ads.context.opts.platformName?window.ads.context.opts.platformName:"";"fandomdesktop"===t?sr.set("skin","ucp_desktop"):"fandommobile"===t?sr.set("skin","ucp_mobile"):sr.set("skin","no_ads")}}var Gs;let Us=class{constructor(t){this.dwTracker=t}track(t){var e,n;const i=new Date,r="dev"===(null===(n=null===(e=null===window||void 0===window?void 0:window.ads)||void 0===e?void 0:e.context)||void 0===n?void 0:n.env)?yo.AD_ENG_DEV_LABRADOR_INFO:yo.AD_ENG_LABRADOR_INFO;this.dwTracker.track({prop_value:t,timestamp:i.getTime(),tz_offset:i.getTimezoneOffset(),country:(mi()||"").toUpperCase()},r)}};var Hs,Fs,zs;Us=r([Ci(),o("design:paramtypes",["function"==typeof(Gs=void 0!==Qo&&Qo)?Gs:Object])],Us);let Ws=class{constructor(t,e,n=null){this.labradorTracker=t,this.dwTracker=e,this.instantConfig=n}execute(){this.experimentGroupsTracker(),this.keyValsTracker(),this.googleTopicsTracker()}experimentGroupsTracker(){var t,e;const n=[...null!==(e=null===(t=this.instantConfig)||void 0===t?void 0:t.getActiveKeyValues())&&void 0!==e?e:[],...sr.get("experiment_groups")||[]].join(";");n&&this.labradorTracker.track(n),dn.on(fn,(({abTestGroup:t})=>{this.labradorTracker.track(`intentIQ_${t}`)}))}keyValsTracker(){const t=Object.assign({},sr.dump());delete t.AU_SEG,this.dwTracker.track({keyvals:JSON.stringify(t)},yo.KEY_VALS)}googleTopicsTracker(){return s(this,void 0,void 0,(function*(){if("1"!==sr.get("topics_available"))return;const t=yield document.browsingTopics({skipObservation:!0});this.dwTracker.track({ppid:sr.get("ppid"),topic:JSON.stringify(t)},yo.TOPICS)}))}};var Ks,qs,Qs;Ws=r([Ci(),o("design:paramtypes",["function"==typeof(Hs=void 0!==Us&&Us)?Hs:Object,"function"==typeof(Fs=void 0!==Qo&&Qo)?Fs:Object,"function"==typeof(zs=void 0!==$r&&$r)?zs:Object])],Ws);let Ys=class extends Ws{constructor(t,e,n){super(t,e,n),this.labradorTracker=t,this.dwTracker=e,this.instantConfig=n}execute(){super.execute()}};var Xs;Ys=r([Ci(),o("design:paramtypes",["function"==typeof(Ks=void 0!==Us&&Us)?Ks:Object,"function"==typeof(qs=void 0!==Qo&&Qo)?qs:Object,"function"==typeof(Qs=void 0!==$r&&$r)?Qs:Object])],Ys);let Js=class{constructor(t){this.pipeline=t}execute(){!function(){var t;Ui("ad-engine",null===(t=window.ads.version)||void 0===t?void 0:t.ae)}(),this.pipeline.add(Bs,T,(()=>s(this,void 0,void 0,(function*(){return yield function(){return s(this,void 0,void 0,(function*(){var t;if(void 0!==(null===(t=window.ads)||void 0===t?void 0:t.geo))return void I(window.ads.geo);const e=new g,n=e.getItem("Geo");if(n)try{return void I(JSON.parse(decodeURIComponent(n))||{})}catch(t){throw new Error("Invalid JSON in the cookie")}try{return function(){return s(this,void 0,void 0,(function*(){const t=yield fetch("https://services.fandom.com/geoip/location",{method:"GET",credentials:"include"}),e=yield t.json();return{continent:e.continent_code,country:e.country_code,region:e.region}}))}().then((t=>{e.setItem("Geo",encodeURIComponent(JSON.stringify(t))),I(t)}))}catch(t){}}))}()}))),function(...t){return{process:Ns,payload:t}}(Ur,Qr),vo,wo,To,$s,Vs,Ys,ns,xs),this.pipeline.execute()}};Js=r([Ci(),o("design:paramtypes",["function"==typeof(Xs=void 0!==Ds&&Ds)?Xs:Object])],Js);const Zs=Symbol("Window");window.RLQ=window.RLQ||[],window.RLQ.push((()=>s(void 0,void 0,void 0,(function*(){(function(){const t=new Ni;return t.bind(Zs).value(window),t})().get(Js).execute()}))))})()})();
//# sourceMappingURL=main.bundle.js.map