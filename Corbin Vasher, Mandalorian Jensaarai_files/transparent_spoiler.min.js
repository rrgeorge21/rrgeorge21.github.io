var SV=window.SV||{};
(function(d,e,f,g){SV.TransparentAsSpoiler=XF.Element.newHandler({options:{svShowIcon:null,svHideIcon:null,storageContainer:"toggleTransparencyToSpoiler",storageKey:"toggle"},colorSpans:null,initSpoiler:!1,init:function(){var a=this.$target;this.colorSpans=this.findSpans(this.findMessageBody(a));if(this.colorSpans.length){var b=XF.ToggleStorageData.get(this.options.storageContainer,this.options.storageKey);a.prepend(d("<span />",{class:(b?this.options.svHideIcon:this.options.svShowIcon)+" sv-transparent-as-spoiler"}).on("click",
XF.proxy(this,"click")));b&&this.showSpoiler()}},findMessageBody:function(a){return a.closest(".message-main").find(".message-userContent .message-body")},findSpans:function(a){var b=a.css("background-color");return a.find(".fixed-color").filter(function(){var c=this.style.color;return"transparent"===c||c==b?!0:!1})},showSpoiler:function(){this.colorSpans.addClass("bbc-spoiler").addClass("bbc-spoiler-instant").data("class","bbc-spoiler").data("xfClick","toggle-class").attr("tabindex","0").attr("data-xf-click",
"toggle-class")},hideSpoiler:function(){this.colorSpans.removeClass("bbc-spoiler").removeClass("bbc-spoiler-instant").data("class","").data("xfClick","").removeAttr("tabindex").removeAttr("data-xf-click")},click:function(a){if(this.colorSpans){a=d(a.target);var b=this.options.svShowIcon,c=this.options.svHideIcon;a.hasClass(b)?(a.removeClass(b),a.addClass(c),XF.ToggleStorageData.set(this.options.storageContainer,this.options.storageKey,1,2592E3),this.showSpoiler()):(a.removeClass(c),a.addClass(b),
XF.ToggleStorageData.remove(this.options.storageContainer,this.options.storageKey),this.hideSpoiler())}}});XF.Element.register("sv-transparent-as-spoiler","SV.TransparentAsSpoiler")})(jQuery,window,document);
